(this.webpackJsonpgcode_preview=this.webpackJsonpgcode_preview||[]).push([[0],{240:function(e,t,n){"use strict";(function(e){var a=n(390),r=n(2),i=n(3),o=n(5),s=n(6),c=n(0),l=n.n(c),u=n(27),d=n(369),h=n.n(d),p=n(55),m=n.n(p),f=n(370),g=n.n(f),v=n(127),b=n(147),O=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return Math.min(Math.max(e,t),n)};function x(e,t,n,a){return e.addEventListener(t,n,a),{remove:function(){e.removeEventListener(t,n,a)}}}function S(e,t,n){return(n-t)*e/100+t}function y(t,n,a,r){var i=t.getBoundingClientRect(),o=i.width,s=i.height,c=function(t){var n=e,a=n.scrollY,r=n.scrollX,i=t.getBoundingClientRect(),o=i.left;return{top:i.top+a,left:o+r}}(t),l=c.top,u=c.left,d=function(e){return e.changedTouches&&e.changedTouches[0]?{x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY}:{x:e.pageX,y:e.pageY}}(n),h=d.x,p=d.y,m=a?p-l:h-u,f=(a?s:o)/100;return r?100-O(m/f):O(m/f)}function M(e){e.preventDefault()}var j=function(e){Object(o.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={currentState:"initial"},e.handleKeyDown=function(t){var n,a=e.props,r=a.min,i=a.max,o=a.value,s=Math.abs((i-r)/100),c=e.props.step||s;switch(h()(t)){case"home":n=r;break;case"end":n=i;break;case"page up":n=o+10*s;break;case"page down":n=o-10*s;break;case"right":case"up":n=o+c;break;case"left":case"down":n=o-c;break;default:return}t.preventDefault(),n=O(n,r,i),e.emitChange(t,n)},e.handleFocus=function(){e.setState({currentState:"focused"})},e.handleBlur=function(){e.setState({currentState:"normal"})},e.handleClick=function(t){var n=e.props,a=n.min,r=n.max,i=n.vertical,o=n.reverse,s=S(y(e.container,t,i,o),a,r);e.emitChange(t,s,(function(){e.playJumpAnimation()}))},e.handleTouchStart=function(t){e.setState({currentState:"activated"}),e.globalMouseUpListener=x(document,"touchend",e.handleMouseUp),"function"===typeof e.props.onDragStart&&e.props.onDragStart(t)},e.handleMouseDown=function(t){e.setState({currentState:"activated"}),e.globalMouseUpListener=x(document,"mouseup",e.handleMouseUp),e.globalMouseMoveListener=x(document,"mousemove",e.handleMouseMove),"function"===typeof e.props.onDragEnd&&e.props.onDragEnd(t)},e.handleMouseUp=function(t){e.setState({currentState:"normal"}),e.globalMouseUpListener&&e.globalMouseUpListener.remove(),e.globalMouseMoveListener&&e.globalMouseMoveListener.remove(),"function"===typeof e.props.onDragEnd&&e.props.onDragEnd(t)},e.handleMouseMove=function(t){var n=e.props,a=n.min,r=n.max,i=n.vertical,o=n.reverse,s=S(y(e.container,t,i,o),a,r);e.emitChange(t,s)},e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.container&&this.container.addEventListener("touchstart",M,{passive:!1})}},{key:"componentWillUnmount",value:function(){this.container.removeEventListener("touchstart",M,{passive:!1})}},{key:"emitChange",value:function(e,t,n){var a=this.props,r=a.step,i=a.trackValue,o=a.value,s=a.onChange,c=t;c=r?function(e,t){return Math.round(e/t)*t}(t,r):Number(t.toFixed(3)),"function"===typeof s&&c!==o&&(s(e,Math.min(c,i)),"function"===typeof n&&n())}},{key:"calculateTrackAfterStyles",value:function(e){switch(this.state.currentState){case"activated":return"calc(100% - ".concat(0===e?7:5,"px)");case"disabled":return"calc(".concat(100-e,"% - 6px)");default:return"calc(100% - 5px)"}}},{key:"calculateTrackBeforeStyles",value:function(e){switch(this.state.currentState){case"disabled":return"calc(".concat(e,"% - 6px)");default:return"".concat(e,"%")}}},{key:"playJumpAnimation",value:function(){var e=this;this.setState({currentState:"jumped"},(function(){setTimeout((function(){e.setState({currentState:"normal"})}),e.props.theme.transitions.duration.complex)}))}},{key:"render",value:function(){var e=this,t=this.state.currentState,n=this.props,r=n.component,i=n.classes,o=n.value,s=n.trackValue,c=n.min,d=n.max,h=n.vertical,p=n.reverse,f=n.disabled,g=Object(a.a)(n,["component","classes","value","trackValue","min","max","vertical","reverse","disabled"]),b=O(100*(o-c)/(d-c)),x=O(100*(s-c)/(d-c)),S={[i.disabled]:f,[i.jumped]:!f&&"jumped"===t,[i.focused]:!f&&"focused"===t,[i.activated]:!f&&"activated"===t},y=m()(i.container,{[i.vertical]:h,[i.reverse]:p,[i.disabled]:f}),M=m()(i.track,i.trackBefore,S,{[i.vertical]:h}),j=m()(i.track,i.trackAfter,S,{[i.vertical]:h}),w=m()(i.thumb,S,{[i.zero]:0===b}),E=h?"height":"width",T=h?"top":"left",P={[E]:this.calculateTrackBeforeStyles(x)},A={[E]:this.calculateTrackAfterStyles(x)},k={[T]:"".concat(b,"%")};return l.a.createElement(r,Object.assign({role:"slider",className:y,"aria-valuenow":o,"aria-valuemin":c,"aria-valuemax":d,"aria-orientation":h?"vertical":"horizontal",onClick:this.handleClick,ref:function(t){e.container=Object(u.findDOMNode)(t)}},g),l.a.createElement("div",{className:M,style:P}),l.a.createElement(v.a,{className:w,disableRipple:!0,style:k,onBlur:this.handleBlur,onKeyDown:this.handleKeyDown,onMouseDown:this.handleMouseDown,onTouchStartCapture:this.handleTouchStart,onTouchMove:this.handleMouseMove,onFocusVisible:this.handleFocus}),l.a.createElement("div",{className:j,style:A}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.disabled?{currentState:"disabled"}:e.disabled||"disabled"!==t.currentState?null:{currentState:"normal"}}}]),n}(l.a.Component);j.defaultProps={min:0,max:100,value:50,component:"div"},t.a=g()((function(e){var t={duration:e.transitions.duration.short,easing:e.transitions.easing.easeOut},n=e.transitions.create(["width","height","box-shadow","left","top"],t),a={loaded:"#999999",loading:"#777777",handle:"#dddddd",primary:e.palette.primary.main,secondary:e.palette.grey[400],focused:e.palette.grey[500],disabled:e.palette.grey[400]};return{container:{position:"relative",width:"100%",margin:"10px 0",padding:"6px 0",cursor:"pointer",WebkitTapHighlightColor:"transparent","&$disabled":{cursor:"no-drop"},"&$vertical":{height:"100%",margin:"0 10px",padding:"0 6px"},"&$reverse":{transform:"scaleX(-1)"},"&$vertical$reverse":{transform:"scaleY(-1)"}},track:{position:"absolute",transform:"translate(0, -50%)",top:"50%",height:2,"&$focused, &$activated":{transition:"none"},"&$disabled":{backgroundColor:a.secondary},"&$vertical":{transform:"translate(-50%, 0)",left:"50%",top:"initial",width:2},"&$jumped":{}},trackBefore:{zIndex:1,left:0,backgroundColor:a.loaded,transition:n,"&$focused, &$activated, &$jumped":{backgroundColor:a.loaded}},trackAfter:{right:0,backgroundColor:a.loading,transition:n,"&$vertical":{bottom:0}},thumb:{position:"absolute",zIndex:2,transform:"translate(-50%, -50%)",width:12,height:12,borderRadius:"50%",transition:n,backgroundColor:a.handle,"&$focused":{boxShadow:"0px 0px 0px 9px ".concat(Object(b.fade)(a.handle,.16))},"&$activated":{width:17,height:17,transition:"none"},"&$disabled":{cursor:"no-drop",width:9,height:9,backgroundColor:a.disabled},"&$zero":{border:"2px solid ".concat(a.disabled),backgroundColor:"transparent"},"&$focused$zero":{border:"2px solid ".concat(a.focused),backgroundColor:Object(b.fade)(a.focused,.34),boxShadow:"0px 0px 0px 9px ".concat(Object(b.fade)(a.focused,.34))},"&$activated$zero":{border:"2px solid ".concat(a.focused)},"&$jumped":{width:17,height:17}},focused:{},activated:{},disabled:{},zero:{},vertical:{},reverse:{},jumped:{}}}),{name:"MuiSlider",withTheme:!0})(j)}).call(this,n(33))},412:function(e,t,n){},436:function(e,t){},438:function(e,t){},449:function(e,t){},451:function(e,t){},476:function(e,t){},478:function(e,t){},479:function(e,t){},485:function(e,t){},487:function(e,t){},506:function(e,t){},518:function(e,t){},521:function(e,t){},526:function(e,t){},528:function(e,t){},549:function(e,t){},656:function(e,t){ace.define("ace/mode/gcode_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],(function(e,t,n){var a=e("../lib/oop"),r=e("./text_highlight_rules").TextHighlightRules,i=function(){var e=this.createKeywordMapper({"support.function":"ATAN|ABS|ACOS|ASIN|SIN|COS|EXP|FIX|FUP|ROUND|LN|TAN",keyword:"IF|DO|WHILE|ENDWHILE|CALL|ENDIF|SUB|ENDSUB|GOTO|REPEAT|ENDREPEAT|CALL","constant.language":"PI"},"identifier",!0);this.$rules={start:[{token:"comment",regex:"\\(.*\\)"},{token:"blockNumber",regex:"([N])([0-9]+)"},{token:"string",regex:"([G])([0-9]+\\.?[0-9]?)"},{token:"string",regex:"([M])([0-9]+\\.?[0-9]?)"},{token:"constant.numeric",regex:"([-+]?([0-9]*\\.?[0-9]+\\.?))|(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)"},{token:e,regex:"[A-Z]"},{token:"keyword.operator",regex:"EQ|LT|GT|NE|GE|LE|OR|XOR"},{token:"paren.lparen",regex:"[\\[]"},{token:"paren.rparen",regex:"[\\]]"},{token:"text",regex:"\\s+"}]}};a.inherits(i,r),t.GcodeHighlightRules=i})),ace.define("ace/mode/gcode",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/gcode_highlight_rules","ace/range"],(function(e,t,n){var a=e("../lib/oop"),r=e("./text").Mode,i=e("./gcode_highlight_rules").GcodeHighlightRules,o=function(){this.HighlightRules=i,this.$behaviour=this.$defaultBehaviour};a.inherits(o,r),function(){this.$id="ace/mode/gcode"}.call(o.prototype),t.Mode=o}))},659:function(e,t,n){},713:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"BASE",(function(){return xe})),n.d(a,"B_AXIS",(function(){return Se})),n.d(a,"A_AXIS",(function(){return ye})),n.d(a,"Y_AXIS",(function(){return Me})),n.d(a,"TOOL",(function(){return je})),n.d(a,"DENTAL_FIXTURE",(function(){return we}));var r={};n.r(r),n.d(r,"ABSOLUTE",(function(){return Pe})),n.d(r,"INCREMENTAL",(function(){return Ae})),n.d(r,"ABSOLUTE_ARC",(function(){return ke})),n.d(r,"INCREMENTAL_ARC",(function(){return Ce}));var i={};n.r(i),n.d(i,"INVERSE_TIME",(function(){return Ge})),n.d(i,"UNITS_PER_MINUTE",(function(){return Le})),n.d(i,"UNITS_PER_REVOLUTION",(function(){return Re}));var o={};n.r(o),n.d(o,"FIVE_AXIS",(function(){return Ie})),n.d(o,"TRIVIAL",(function(){return Ne}));var s={};n.r(s),n.d(s,"XY",(function(){return _e})),n.d(s,"ZX",(function(){return De})),n.d(s,"YZ",(function(){return Fe})),n.d(s,"UV",(function(){return ze})),n.d(s,"WU",(function(){return Ze})),n.d(s,"VW",(function(){return Be}));var c={};n.r(c),n.d(c,"IN",(function(){return Ve})),n.d(c,"MM",(function(){return Ue}));var l={};n.r(l),n.d(l,"OFF",(function(){return He}));var u={};n.r(u),n.d(u,"LOAD_MODEL",(function(){return Xe})),n.d(u,"POSITION_MODEL",(function(){return Ye})),n.d(u,"EDIT_PATH",(function(){return We})),n.d(u,"PREVIEW_PATH",(function(){return Ke})),n.d(u,"CUT_PATH",(function(){return Je})),n.d(u,"FIXTURE_HEIGHT",(function(){return qe}));var d={};n.r(d),n.d(d,"computeDynamicWorkOffsets",(function(){return Ct})),n.d(d,"toolOrientation",(function(){return Gt})),n.d(d,"workPieceSpace",(function(){return Lt})),n.d(d,"forwardFiveAxis",(function(){return Rt})),n.d(d,"inverseFiveAxis",(function(){return It})),n.d(d,"kinematics",(function(){return Nt})),n.d(d,"limits",(function(){return _t})),n.d(d,"jointLabels",(function(){return Dt})),n.d(d,"getLimitErrors",(function(){return Ft}));var h={};n.r(h),n.d(h,"computeDynamicWorkOffsets",(function(){return zt})),n.d(h,"toolOrientation",(function(){return Zt})),n.d(h,"workPieceSpace",(function(){return Bt})),n.d(h,"forwardFiveAxis",(function(){return Vt})),n.d(h,"inverseFiveAxis",(function(){return Ut})),n.d(h,"kinematics",(function(){return Ht})),n.d(h,"limits",(function(){return Xt})),n.d(h,"jointLabels",(function(){return Yt})),n.d(h,"getLimitErrors",(function(){return Wt}));var p={};n.r(p),n.d(p,"messages",(function(){return la})),n.d(p,"annotations",(function(){return ua})),n.d(p,"maxLimitMessage",(function(){return da})),n.d(p,"minLimitMessage",(function(){return ha})),n.d(p,"unimplementedMessages",(function(){return pa})),n.d(p,"nonSummarizedErrors",(function(){return ma})),n.d(p,"nonSummarizedWarnings",(function(){return fa})),n.d(p,"setUnitsMessages",(function(){return ga})),n.d(p,"lastSetUnitsMessage",(function(){return va})),n.d(p,"setToolLengthOffsetMessages",(function(){return ba})),n.d(p,"setWorkCoordinateSystemMessages",(function(){return Oa})),n.d(p,"wcsChangedMessages",(function(){return xa}));var m=n(0),f=n.n(m),g=n(27),v=n.n(g),b=(n(412),n(31)),O=n(11),x=n(764),S=Object(x.a)({MACHINE_STATE:{DISTANCE_MODE:{SET_ABSOLUTE:void 0,SET_INCREMENTAL:void 0,SET_ABSOLUTE_ARC:void 0,SET_INCREMENTAL_ARC:void 0}}}),y=Object(x.a)({MACHINE_STATE:{FEED_RATE_MODE:{SET_INVERSE_TIME:void 0,SET_UNITS_PER_MINUTE:void 0,SET_UNITS_PER_REVOLUTION:void 0}}}),M=Object(x.a)({MACHINE_STATE:{FEED_RATE:{SET:function(e){return e}}}}),j=Object(x.a)({MACHINE_STATE:{UNITS:{SET_IN:void 0,SET_MM:void 0}}}),w=Object(x.a)({MACHINE_STATE:{KINEMATICS_MODE:{SET_FIVE_AXIS:void 0,SET_TRIVIAL:void 0}}}),E=Object(x.a)({MACHINE_STATE:{CUTTER_COMPENSATION:{OFF:void 0}}}),T=Object(x.a)({MACHINE_STATE:{MOTION:{OFF:void 0,RAPID:void 0,LINEAR:void 0,ARC_C_W:void 0,ARC_C_C_W:void 0,SET_POSITION:void 0,NON_MOTION_COMMAND:void 0,G5X:{ENABLE_G54:void 0,ENABLE_G55:void 0,ENABLE_G56:void 0,ENABLE_G57:void 0,ENABLE_G58:void 0,ENABLE_G59:void 0,ENABLE_G59_1:void 0,ENABLE_G59_2:void 0,ENABLE_G59_3:void 0,COMPUTE_DYNAMIC_WORK_OFFSETS:void 0,SET_G5X_WORK_OFFSET:void 0}}}}),P=Object(x.a)({MACHINE_STATE:{PLANE_SELECT:{SET_X_Y:void 0,SET_Z_X:void 0,SET_Y_Z:void 0,SET_U_V:void 0,SET_W_U:void 0,SET_V_W:void 0}}}),A=Object(x.a)({MACHINE_STATE:{SPINDLE_CONTROL:{OFF:void 0,CW:void 0,CCW:void 0}}}),k=Object(x.a)({MACHINE_STATE:{SPINDLE_SPEED:{SET:void 0}}}),C=Object(x.a)({MACHINE_STATE:{TOOL:{SET:void 0,CHANGE:void 0,SET_TOOL_LENGTH_OFFSET:void 0,CLEAR_TOOL_LENGTH_OFFSET:void 0,TABLE:{SET_TOOL:void 0}}}}),G=Object(x.a)({MACHINE_STATE:{MACHINE:{SET:void 0}}}),L={machineState:Object(O.a)(Object(O.a)(Object(O.a)(Object(O.a)(Object(O.a)(Object(O.a)(Object(O.a)(Object(O.a)(Object(O.a)(Object(O.a)(Object(O.a)(Object(O.a)({},S.machineState),y.machineState),M.machineState),w.machineState),P.machineState),j.machineState),E.machineState),T.machineState),A.machineState),k.machineState),C.machineState),G.machineState)},R=Object(x.a)({INTERPRETER:{SET_FILE_NAME:void 0,START_LOADING:void 0,END_LOADING:void 0,SET_LOADING_PROGRESS:void 0,SET_LINES:function(e,t){return{lines:e,preview:t}},START_PROCESSING:void 0,END_PROCESSING:void 0,SET_PROCESSING_PROGRESS:void 0,SET_INITIAL_STATE:void 0,APPEND_INDICES:void 0,APPEND_TIMES:void 0,APPEND_MESSAGES:void 0,INCREMENT_TIME:void 0,SET_CURRENT_LINE_WITH_PERCENTAGE:void 0,SET_CURRENT_LINE_WITH_TIME:void 0,SET_CURRENT_LINE:void 0,NEXT_LINE:void 0,PREVIOUS_LINE:void 0,PAUSE:void 0,UNPAUSE:void 0,RUN:void 0,STOP:void 0,SET_TIME_MULTIPLIER:void 0}}),I=Object(x.a)({UI:{GCODE_PANE:{TOGGLE_PANE:void 0,SET_WIDTH:void 0,SET_SELECTED:void 0,SET_LINE_OFFSET:void 0,SET_SHOW_LINES:void 0,SCROLL:void 0,SET_TAB:void 0}}}),N=Object(x.a)({UI:{CONTROLS_OVERLAY:{SET_VISIBLE:void 0,TOGGLE_PANE:void 0,PLAY:void 0,PREVIOUS:void 0,NEXT:void 0,HOME:void 0,SHUFFLE:void 0}}}),_={ui:Object(O.a)(Object(O.a)({},I.ui),N.ui)},D=Object(x.a)({IFRAME:{INITIALIZE:void 0,ROCKHOPPER:void 0,TO_ROCKHOPPER:void 0,EMBED_GCODE:void 0}}),F=Object(x.a)({VIEWER3D:{PARENT_CAMERA:void 0,SHOW_MODEL:void 0,HIDE_MODEL:void 0,LOAD_MODEL:void 0,SET_PERSPECTIVE:void 0,SET_ORTHOGRAPHIC:void 0,SET_DIMENSIONS:function(e,t){return{width:e,height:t}},CAMERA_ZOOM:void 0,CAMERA_START_ROTATING:void 0,CAMERA_ROTATE:function(e,t){return{dx:e,dy:t}},CAMERA_STOP_ROTATING:void 0,CAMERA_SET_DIRECTION:function(e,t,n){return{x:e,y:t,z:n}},CAMERA_SET_RADIUS:void 0,CAMERA_SET_ORTHOGRAPHIC_ZOOM:void 0,CAMERA_SET_PHI:void 0,CAMERA_SET_THETA:void 0}}),z=Object(x.a)({ALIGNER_STATE:{SET_RFID:void 0,SET_STEP:void 0,MODEL_LOADED:void 0,MODEL_UPLOADED:void 0,FINISHED_PROCESSING:void 0,FINALIZE_MODEL:void 0,FINALIZE_MODEL_CLICK:void 0,CLEAR_FINALIZE_MODEL_CLICK:void 0,UPLOAD_MODEL:void 0,LOADING:function(e,t,n,a){return{id:e,label:t,variant:n,progress:a}},LOADING_PROGRESS:function(e,t){return{id:e,progress:t}},STOP_LOADING:function(e){return{id:e}},ALIGNER_STATUS_RESPONSE:void 0,DOWNLOAD_PROCESSED_MODEL:void 0,DOWNLOAD_G_CODE:void 0,SET_JOINTS:void 0,RESET_TO_DEFAULTS:void 0,SHOW_GHOST_SPHERE:void 0,HIDE_GHOST_SPHERE:void 0,SET_GHOST_SPHERE_OPACITY:void 0,SET_GHOST_SPHERE_POSITION:function(e,t,n){return{x:e,y:t,z:n}},ADD_POINT:function(e,t,n,a,r,i){return{posx:e,posy:t,posz:n,dirx:a,diry:r,dirz:i}},UPDATE_POINT_POSITION:function(e,t,n){return{posx:e,posy:t,posz:n}},DELETE_POINT:void 0,CLOSE_PATH:void 0,SET_ACTIVE_POINT:void 0,NEXT_POINT:void 0,PREV_POINT:void 0,INCREMENT_TIME:void 0,PLAY:void 0,PAUSE:void 0,SET_TIME_MULTIPLIER:void 0,SET_TIME_WITH_PERCENTAGE:void 0,SET_HIGHLIGHTED_POINT:void 0,START_ROTATING_MACHINE:function(e,t){return{x:e,y:t}},ROTATE_MACHINE:function(e,t){return{x:e,y:t}},STOP_ROTATING_MACHINE:void 0,SET_DIMENSIONS:function(e,t){return{width:e,height:t}},SAVE_TRANSFORM:void 0,TRANSFORM_SAVED:void 0,SAVE_POINTS:void 0,POINTS_SAVED:void 0,RESET_STATE:void 0,SET_HIGHLIGHT_MODEL:void 0,SET_DRAG_MODEL_START_POINT:function(e,t){return{x:e,z:t}},DRAG_MODEL:function(e,t){return{x:e,z:t}},SET_MODEL_ORIENTATION:function(e,t,n){return{x:e,y:t,z:n}},SET_MODEL_POSITION:function(e,t,n){return{x:e,y:t,z:n}},ROTATE_C_W:void 0,ROTATE_C_C_W:void 0,SET_MACHINE:void 0,IMPORT_TRANSFORM_AND_POINTS:void 0,CANCEL_IMPORT_TRANSFORM_AND_POINTS:void 0,IMPORTED_TRANSFORM_AND_POINTS:void 0,SET_TIMES:void 0}}),Z=Object(x.a)({RFID:{RECEIVED_RFID_SCAN_MESSAGE:void 0,RECEIVED_ERROR_MESSAGE:void 0,RECEIVED_INCOMPLETE_MESSAGE:void 0,CONNECTED_SCANNER:void 0,DISCONNECTED_SCANNER:void 0}}),B=Object(O.a)(Object(O.a)(Object(O.a)(Object(O.a)(Object(O.a)(Object(O.a)(Object(O.a)({},L),R),_),D),F),z),Z),V=n(2),U=n(3),H=n(5),X=n(6),Y=n(54),W=n(32),K=n.n(W),J=n(235),q=n.n(J),$=n(356),Q=n.n($),ee=function(){function e(){Object(V.a)(this,e),this.callback=function(e){e&&console.error("Error while issuing analytics request",e)};var t=window.sessionStorage,n=t.getItem("uuid");n||(n=q()(),t.setItem("uuid",n)),this.visitor=Q()("UA-129057873-1",n),this.originalVisitor=this.visitor}return Object(U.a)(e,[{key:"pageview",value:function(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return this.visitor=(e=this.visitor).pageview.apply(e,n),this}},{key:"send",value:function(){return this.visitor.send(),this.visitor=this.originalVisitor,this}},{key:"event",value:function(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return this.visitor=(e=this.visitor).event.apply(e,n),this}},{key:"exception",value:function(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return this.visitor=(e=this.visitor).exception.apply(e,n),this}},{key:"timing",value:function(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return this.visitor=(e=this.visitor).timing.apply(e,n),this}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}().getInstance,te=n(15),ne=n(358),ae=n(357),re=te;re.STLLoader=ae.a,re.OBJLoader=ne.a;var ie=re,oe=new Float32Array([0,0,.5]),se=new Float32Array([1,1,1]),ce=(new Float32Array([1,.5,0]),new Float32Array([0,0,1]),function(){function e(t,n){Object(V.a)(this,e);var a="object"===typeof t;if(this.capacity=a?2*t.capacity:t,this.numPoints=0,this.geometry=new ie.BufferGeometry,this.vertices=new Float32Array(3*this.capacity),this.colors=new Float32Array(3*this.capacity),this.normals=new Float32Array(3*this.capacity),this.lines=new Float32Array(this.capacity),this.times=new Float32Array(this.capacity),a){var r=t;this.vertices.set(r.vertices),this.colors.set(r.colors),this.normals.set(r.normals),this.lines.set(r.lines),this.times.set(r.times),this.geometry.setDrawRange(r.geometry.drawRange.start,r.geometry.drawRange.count),this.numPoints=r.numPoints}this.geometry.setAttribute("position",new ie.BufferAttribute(this.vertices,3)),this.geometry.setAttribute("color",new ie.BufferAttribute(this.colors,3)),this.geometry.setAttribute("normal",new ie.BufferAttribute(this.normals,3)),this.geometry.setAttribute("line",new ie.BufferAttribute(this.lines,1)),this.geometry.setAttribute("time",new ie.BufferAttribute(this.times,1)),a&&(this.geometry.attributes.position.updateRange.offset=0,this.geometry.attributes.color.updateRange.offset=0,this.geometry.attributes.normal.updateRange.offset=0,this.geometry.attributes.line.updateRange.offset=0,this.geometry.attributes.time.updateRange.offset=0,this.geometry.attributes.position.updateRange.count=3*this.numPoints,this.geometry.attributes.color.updateRange.count=3*this.numPoints,this.geometry.attributes.normal.updateRange.count=3*this.numPoints,this.geometry.attributes.line.updateRange.count=this.numPoints,this.geometry.attributes.time.updateRange.count=this.numPoints,this.geometry.attributes.position.needsUpdate=!0,this.geometry.attributes.color.needsUpdate=!0,this.geometry.attributes.normal.needsUpdate=!0,this.geometry.attributes.line.needsUpdate=!0,this.geometry.attributes.time.needsUpdate=!0),this.geometry.attributes.position.setUsage(ie.DynamicDrawUsage),this.geometry.attributes.color.setUsage(ie.DynamicDrawUsage),this.geometry.attributes.normal.setUsage(ie.DynamicDrawUsage),this.geometry.attributes.line.setUsage(ie.DynamicDrawUsage),this.geometry.attributes.time.setUsage(ie.DynamicDrawUsage),this.geometry.setDrawRange(0,0),this.object=new ie.Line(this.geometry,n),this.object.frustumCulled=!1}return Object(U.a)(e,[{key:"clear",value:function(){this.numPoints=0,this.updateDrawRange()}},{key:"updateDrawRange",value:function(){this.geometry.setDrawRange(0,this.numPoints)}},{key:"updateAttribute",value:function(e,t,n){var a=this.geometry.attributes[e];a.updateRange.count>-1?(a.updateRange.count+=n,a.needsUpdate=!0):(a.updateRange.offset=t,a.updateRange.count=n,a.needsUpdate=!0)}},{key:"addPoint",value:function(e){var t=3*this.numPoints;this.vertices[t]=e.position[0],this.vertices[t+1]=e.position[1],this.vertices[t+2]=e.position[2],this.colors[t]=e.color[0],this.colors[t+1]=e.color[1],this.colors[t+2]=e.color[2],this.normals[t]=e.normal[0],this.normals[t+1]=e.normal[1],this.normals[t+2]=e.normal[2],this.lines[this.numPoints]=e.line,this.times[this.numPoints]=e.time,this.updateAttribute("position",t,3),this.updateAttribute("color",t,3),this.updateAttribute("normal",t,3),this.updateAttribute("line",this.numPoints,1),this.updateAttribute("time",this.numPoints,1),this.numPoints++,this.updateDrawRange()}}]),e}()),le=function(){function e(){Object(V.a)(this,e),this.material=new ie.ShaderMaterial({uniforms:{offset:{value:.004},minTime:{value:0},maxTime:{value:9999999999},minLine:{value:0},maxLine:{value:9999999999},maxY:{value:99999999},maxXZ:{value:99999999}},vertexColors:ie.VertexColors,vertexShader:"\nuniform float minTime;\nuniform float maxTime;\nuniform float minLine;\nuniform float maxLine;\nuniform float offset;\nuniform float maxXZ;\nuniform float maxY;\n\nattribute float line;\nattribute float time;\nattribute float speed;\nvarying vec3 vPos;\nvarying vec3 vColor;\nvarying float vLine;\nvarying float vTime;\nvoid main() {\n  vPos = position + offset*normal;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( vPos, 1.0 );\n  vColor = color;\n  vLine = line;\n  vTime = time;\n}\n",fragmentShader:"\nuniform float minTime;\nuniform float maxTime;\nuniform float minLine;\nuniform float maxLine;\nuniform float maxXZ;\nuniform float maxY;\n\nvarying vec3 vColor;\nvarying vec3 vPos;\nvarying float vLine;\nvarying float vTime;\nvoid main()\t{\n  if(length(vPos.xz) > maxXZ || \n     abs(vPos.y) > maxY ||\n     vTime < minTime || vTime > maxTime ||\n     vLine < minLine || vLine > maxLine) {\n\n    discard;\n  }\n  gl_FragColor = vec4(vColor, 1.);\n}\n"}),this.object=new ie.Group,this.lineObject=new ce(1e5,this.material),this.object.frustumCulled=!1,this.object.add(this.lineObject.object)}return Object(U.a)(e,[{key:"clear",value:function(){this.lineObject.clear()}},{key:"setMaxXZ",value:function(e){this.material.uniforms.maxXZ.value=e}},{key:"setMaxY",value:function(e){this.material.uniforms.maxY.value=e}},{key:"setOffset",value:function(e){this.material.uniforms.offset.value=e}},{key:"setMinLine",value:function(e){this.material.uniforms.minLine.value=e}},{key:"setMaxLine",value:function(e){this.material.uniforms.maxLine.value=e}},{key:"setMinTime",value:function(e){this.material.uniforms.minTime.value=e}},{key:"setMaxTime",value:function(e){this.material.uniforms.maxTime.value=e}},{key:"addPoints",value:function(e){var t=this;e.forEach((function(e){t.lineObject.numPoints===t.lineObject.capacity&&(t.object.remove(t.lineObject.object),t.lineObject=new ce(t.lineObject,t.material),t.object.add(t.lineObject.object)),t.lineObject.addPoint(e)}))}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new e),this.instance}}]),e}(),ue=(new Float32Array([0,0,.5]),new Float32Array([1,1,1]),new Float32Array([1,.5,0]),new Float32Array([0,0,1]),function(){function e(t,n){Object(V.a)(this,e);var a="object"===typeof t;if(this.capacity=a?2*t.capacity:t,this.numPoints=0,this.geometry=new ie.BufferGeometry,this.vertices=new Float32Array(3*this.capacity),this.colors=new Float32Array(3*this.capacity),this.normals=new Float32Array(3*this.capacity),this.lines=new Float32Array(this.capacity),this.times=new Float32Array(this.capacity),a){var r=t;this.vertices.set(r.vertices),this.colors.set(r.colors),this.normals.set(r.normals),this.lines.set(r.lines),this.times.set(r.times),this.geometry.setDrawRange(r.geometry.drawRange.start,r.geometry.drawRange.count),this.numPoints=r.numPoints}this.geometry.setAttribute("position",new ie.BufferAttribute(this.vertices,3)),this.geometry.setAttribute("normal",new ie.BufferAttribute(this.normals,3)),a&&(this.geometry.attributes.position.updateRange.offset=0,this.geometry.attributes.normal.updateRange.offset=0,this.geometry.attributes.position.updateRange.count=3*this.numPoints,this.geometry.attributes.normal.updateRange.count=3*this.numPoints,this.geometry.attributes.position.needsUpdate=!0,this.geometry.attributes.normal.needsUpdate=!0),this.geometry.attributes.position.setUsage(ie.DynamicDrawUsage),this.geometry.attributes.normal.setUsage(ie.DynamicDrawUsage),this.geometry.setDrawRange(0,0),this.object=new ie.Mesh(this.geometry,n),this.object.frustumCulled=!1}return Object(U.a)(e,[{key:"clear",value:function(){this.numPoints=0,this.updateDrawRange()}},{key:"updateDrawRange",value:function(){this.geometry.setDrawRange(0,this.numPoints)}},{key:"updateAttribute",value:function(e,t,n){var a=this.geometry.attributes[e];a.updateRange.count>-1?(a.updateRange.count+=n,a.needsUpdate=!0):(a.updateRange.offset=t,a.updateRange.count=n,a.needsUpdate=!0)}},{key:"addPoint",value:function(e){var t=3*this.numPoints;this.vertices[t]=e.position[0],this.vertices[t+1]=e.position[1],this.vertices[t+2]=e.position[2],this.colors[t]=e.color[0],this.colors[t+1]=e.color[1],this.colors[t+2]=e.color[2],this.normals[t]=e.normal[0],this.normals[t+1]=e.normal[1],this.normals[t+2]=e.normal[2],this.lines[this.numPoints]=e.line,this.times[this.numPoints]=e.time,this.updateAttribute("position",t,3),this.updateAttribute("normal",t,3),this.numPoints++,this.updateDrawRange()}}]),e}()),de=function(){function e(){Object(V.a)(this,e),this.material=new ie.MeshBasicMaterial({color:16777215,opacity:.5,transparent:!0}),this.object=new ie.Group,this.stripObject=new ue(1e5,this.material),this.object.frustumCulled=!1,this.object.add(this.stripObject.object)}return Object(U.a)(e,[{key:"clear",value:function(){this.stripObject.clear()}},{key:"setMaxXZ",value:function(e){this.material.uniforms.maxXZ.value=e}},{key:"setMaxY",value:function(e){this.material.uniforms.maxY.value=e}},{key:"setOffset",value:function(e){this.material.uniforms.offset.value=e}},{key:"setMinLine",value:function(e){this.material.uniforms.minLine.value=e}},{key:"setMaxLine",value:function(e){this.material.uniforms.maxLine.value=e}},{key:"setMinTime",value:function(e){this.material.uniforms.minTime.value=e}},{key:"setMaxTime",value:function(e){this.material.uniforms.maxTime.value=e}},{key:"addPoints",value:function(e){var t=this;e.forEach((function(e){t.stripObject.numPoints===t.stripObject.capacity&&(t.object.remove(t.stripObject.object),t.stripObject=new ue(t.stripObject,t.material),t.object.add(t.stripObject.object)),t.stripObject.addPoint(e)}))}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new e),this.instance}}]),e}(),he=function(){return new ie.ShaderMaterial({uniforms:{hitNormal:{value:new ie.Vector3},myTexture:{type:"t"},opacity:{value:.25}},vertexColors:ie.VertexColors,vertexShader:"\n      varying vec3 vNormal;\n      varying vec2 vUV;\n      void main() {\n        vNormal = normal;\n        vUV = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n      }\n    ",fragmentShader:"\n      uniform sampler2D myTexture;\n      uniform vec3 hitNormal;\n      uniform float opacity;\n\n      varying vec3 vNormal;\n      varying vec2 vUV;\n      void main() {\n        vec3 multColor = vec3(1,1,1);\n        if(dot(vNormal, hitNormal) > .99) {\n          multColor = vec3(.3,.7, .9);\n        }\n        gl_FragColor = vec4(texture2D(myTexture, vUV).xyz*multColor, opacity);\n      }\n    "})},pe=function(){function e(t,n,a,r,i){var o=this;Object(V.a)(this,e),this.callbacks={click:[],mouseover:[]},this.left=n,this.top=a,this.width=r,this.height=i,this.opacity=.25,this.scene=new ie.Scene;var s=this.height/this.width;this.camera=new ie.OrthographicCamera(-2.5,2.5,2.5*s,-2.5*s,-2.5,2.5),this.scene.add(this.camera),this.raycaster=new ie.Raycaster,this.material=new he;var c=new ie.OBJLoader,l=new ie.TextureLoader;c.load("models/rhombicuboctahedron.obj",(function(e){o.object=e,e.traverse((function(e){e instanceof ie.Mesh&&(e.material=o.material)})),o.scene.add(e),o.loadedModel=!0,o.loaded=o.loadedModel&&o.loadedTexture}),(function(e){}),(function(e){console.error(e)})),this.material.uniforms.myTexture.value=l.load("textures/viewCube.png",(function(e){o.material.uniforms.myTexture.value=e,o.loadedTexture=!0,o.loaded=o.loadedModel&&o.loadedTexture}),void 0,(function(e){console.error(e)})),t.addEventListener("click",(function(e){var t=e.offsetX-o.left,n=e.offsetY,a=t/o.width*2-1,r=-n/o.height*2+1;if(o.loaded&&a>-1&&a<1&&r>-1&&r<1){o.raycaster.set(new ie.Vector3(2.5*a,2.5*r,10).applyQuaternion(o.camera.quaternion),new ie.Vector3(0,0,-1).applyQuaternion(o.camera.quaternion));var i=o.raycaster.intersectObject(o.object,!0);if(i.length>0){var s=i[0];o.doCallback("click",s.face.normal)}}})),t.addEventListener("mousemove",(function(e){var t=e.offsetX-o.left,n=e.offsetY,a=t/o.width*2-1,r=-n/o.height*2+1;if(o.loaded)if(a>-1&&a<1&&r>-1&&r<1){o.raycaster.set(new ie.Vector3(2.5*a,2.5*r,10).applyQuaternion(o.camera.quaternion),new ie.Vector3(0,0,-1).applyQuaternion(o.camera.quaternion));var i=o.raycaster.intersectObject(o.object,!0);if(i.length>0){var s=i[0];o.doCallback("mouseover",s.face.normal),o.material.uniforms.hitNormal.value.copy(s.face.normal),o.opacity=1}else o.material.uniforms.hitNormal.value.set(0,0,0),o.opacity=.25}else o.material.uniforms.hitNormal.value.set(0,0,0),o.opacity=.25}))}return Object(U.a)(e,[{key:"doCallback",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];this.callbacks[e].forEach((function(e){return e.apply(void 0,n)}))}},{key:"addEventListener",value:function(e,t){this.callbacks[e].push(t)}},{key:"removeEventListener",value:function(e,t){this.callbacks[e].splice(this.callbacks[e].indexOf(t),1)}},{key:"setOrientation",value:function(e){this.camera.quaternion.copy(e)}},{key:"setPosition",value:function(e,t){this.left=e,this.top=t}},{key:"setDimensions",value:function(e,t){this.width=e,this.height=t}},{key:"step",value:function(e){this.material.uniforms.opacity.value=.9*this.material.uniforms.opacity.value+.1*this.opacity,this.material.uniforms.opacity.value<1?this.material.transparent=!0:this.material.transparent=!1}},{key:"render",value:function(e){this.loaded&&(e.setViewport(this.left,this.top,this.width,this.height),e.setScissor(this.left,this.top,this.width,this.height),e.setScissorTest(!0),e.clearDepth(),e.render(this.scene,this.camera))}}]),e}(),me=function(){function e(t,n){Object(V.a)(this,e),this.width=n.width,this.height=n.height,this.spherical=new ie.Spherical(10,Math.PI/4,-Math.PI/2),this.spherical.makeSafe(),this.currentSpherical=new ie.Spherical(10,Math.PI/4,-Math.PI/2),this.currentSpherical.makeSafe(),this.Y=new ie.Vector3(0,1,0),this.X=new ie.Vector3(1,0,0),this.rotatedX=new ie.Vector3(1,0,0),this.focus=new ie.Vector3(0,0,0),this.parent=new ie.Object3D,this.parentPosition=new ie.Vector3,this.parentOrientation=new ie.Quaternion,this.worldPosition=new ie.Vector3(-10,0,0),this.worldOrientation=new ie.Quaternion,this.localOrientation=new ie.Quaternion,this.phiOrientation=new ie.Quaternion,this.thetaOrientation=new ie.Quaternion,this.localOrientation.setFromAxisAngle(new ie.Vector3(0,1,0),-Math.PI/2),this.worldOrientation.copy(this.localOrientation),this.startRotate=new ie.Vector2,this.dRotate=new ie.Vector2,this.transitionFilter=.1,this.transitionSphericalFilter=.4,this.rotateFilter=.4,this.rotateSphericalFilter=.8,this.lockedFilter=1,this.lockedSphericalFilter=1,this.filter=1,this.sphericalFilter=1,this.scene=t;var a=this.width/this.height,r=this.height/this.width;this.perspectiveCamera=new ie.PerspectiveCamera(60,a,.1,1e3),this.orthographicCamera=new ie.OrthographicCamera(-10,10,10*r,-10*r,-100,100),this.camera=this.perspectiveCamera,this.camera.position.x=-3,this.scene.add(this.camera),this.canvas=n}return Object(U.a)(e,[{key:"updateCanvasDimensions",value:function(e,t){this.width=e,this.height=t;var n=this.width/this.height,a=this.height/this.width;this.perspectiveCamera.aspect=n,this.perspectiveCamera.updateProjectionMatrix(),this.orthographicCamera.top=10*a,this.orthographicCamera.bottom=-10*a,this.orthographicCamera.updateProjectionMatrix()}},{key:"setPerspective",value:function(){this.camera=this.perspectiveCamera}},{key:"setOrthographic",value:function(){this.camera=this.orthographicCamera}},{key:"update",value:function(){var e=this.rotating?this.rotateFilter:this.transitionFilter,t=this.rotating?this.rotateFilter:this.transitionSphericalFilter;this.currentSpherical.radius=(1-t)*this.currentSpherical.radius+t*this.spherical.radius,this.currentSpherical.phi=(1-t)*this.currentSpherical.phi+t*this.spherical.phi,this.currentSpherical.theta-this.spherical.theta>Math.PI?this.currentSpherical.theta-=2*Math.PI:this.spherical.theta-this.currentSpherical.theta>Math.PI&&(this.currentSpherical.theta+=2*Math.PI),this.currentSpherical.theta=(1-t)*this.currentSpherical.theta+t*this.spherical.theta,this.currentSpherical.makeSafe(),this.worldPosition.setFromSpherical(this.currentSpherical),this.parent.getWorldQuaternion(this.parentOrientation),this.parent.getWorldPosition(this.parentPosition),this.worldPosition.applyQuaternion(this.parentOrientation),this.worldPosition.add(this.parentPosition),this.thetaOrientation.setFromAxisAngle(this.Y,this.currentSpherical.theta),this.phiOrientation.setFromAxisAngle(this.rotatedX.copy(this.X).applyQuaternion(this.thetaOrientation),-Math.PI/2+this.currentSpherical.phi),this.localOrientation.copy(this.thetaOrientation),this.localOrientation.premultiply(this.phiOrientation),this.worldOrientation.copy(this.localOrientation),this.worldOrientation.premultiply(this.parentOrientation),this.perspectiveCamera.quaternion.slerp(this.worldOrientation,e),this.perspectiveCamera.position.lerp(this.worldPosition,e),this.orthographicCamera.quaternion.slerp(this.worldOrientation,e),this.orthographicCamera.position.lerp(this.worldPosition,e)}},{key:"setParent",value:function(e){e&&this.parent!==e&&(this.parent=e,this.filter=this.transitionFilter,this.sphericalFilter=this.transitionSphericalFilter)}}]),e}(),fe="LONG",ge="SHORT",ve="NONE",be="V2",Oe="V2_50",xe="BASE",Se="B_AXIS",ye="A_AXIS",Me="Y_AXIS",je="TOOL",we="DENTAL_FIXTURE",Ee="PERSPECTIVE",Te="ORTHOGRAPHIC",Pe="ABSOLUTE",Ae="INCREMENTAL",ke="ABSOLUTE_ARC",Ce="INCREMENTAL_ARC",Ge="INVERSE_TIME",Le="UNITS_PER_MINUTE",Re="UNITS_PER_REVOLUTION",Ie="FIVE_AXIS",Ne="TRIVIAL",_e="XY",De="ZX",Fe="YZ",ze="UV",Ze="WU",Be="VW",Ve="IN",Ue="MM",He="OFF",Xe=0,Ye=1,We=2,Ke=3,Je=4,qe=28.775,$e=1e-6,Qe=ee(),et=function(e){var t;if(e instanceof ie.Mesh)t=e;else for(var n=[e];n.length>0;)for(var a=n.shift(),r=0;r<a.children.length;r++){var i=a.children[r];if(i instanceof ie.Mesh)return i;n.push(i)}return t},tt=function(){function e(t,n){var a=this;Object(V.a)(this,e),this.wheelEventListener=function(e){var t=a.props,n=t.onCameraZoom,r=t.respondToCameraGestures;e.preventDefault(),e.stopPropagation(),r&&n&&n(e.deltaY)},this.keyDownListener=function(e){var t=a.props.onDeleteActiveSphere;"Backspace"===e.key&&t&&t()},this.getViewDirection=function(){return new ie.Vector3(0,0,-1).applyMatrix4(a.cameraTransitions.camera.matrixWorld).normalize()},this.getCameraRay=function(e,t){return a.mouse.x=e/a.width*2-1,a.mouse.y=-t/a.height*2+1,a.raycaster.setFromCamera(a.mouse,a.cameraTransitions.camera),a.raycaster.ray.clone()},this.mouseDownListener=function(e){var t=a.props,n=t.onCameraStartRotating,r=t.respondToModelGestures,i=t.respondToCameraGestures,o=t.onModelPointerDown,s=t.onSpherePointerDown,c=t.onMouseDown;if(e.preventDefault(),r){var l=!1;if(a.parts.model&&(a.mouse.x=e.offsetX/a.width*2-1,a.mouse.y=-e.offsetY/a.height*2+1,a.hits.length=0,a.raycaster.setFromCamera(a.mouse,a.cameraTransitions.camera),a.raycaster.intersectObject(a.parts.model.object,!0,a.hits),a.hits.length>0&&(a.hits[0].object===a.parts.model.object?(a.modelPointerDown=!0,o&&(o(a.hits[0],e,a),l=!0)):s&&(a.spherePointerDown=a.hits[0],s(a.hits[0],e,a),l=!0),l)))return}if(i&&n&&e.button===ie.MOUSE.LEFT)return a.startRotatingX=e.offsetX,a.startRotatingY=e.offsetY,void n();c&&c(e,a)},this.mouseUpListener=function(e){e.preventDefault();var t=a.props,n=t.rotating,r=t.machineRotating,i=t.respondToCameraGestures,o=t.respondToModelGestures,s=t.onCameraStopRotating,c=t.onModelPointerUp,l=t.onSpherePointerUp,u=t.onSphereExit,d=t.onMouseUp;if(!n&&!r&&o){var h=!1;if(a.parts.model)if(a.mouse.x=e.offsetX/a.width*2-1,a.mouse.y=-e.offsetY/a.height*2+1,a.hits.length=0,a.raycaster.setFromCamera(a.mouse,a.cameraTransitions.camera),a.raycaster.intersectObject(a.parts.model.object,!0,a.hits),a.hits.length>0){if(a.hits[0].object===a.parts.model.object?(a.spherePointerDown&&l&&(l(void 0,e,a),h=!0),a.spherePointerDown=!1,c&&a.modelPointerDown&&(c(a.hits[0],e,a),h=!0),a.modelPointerDown=!1):(a.modelPointerDown&&c&&(c(void 0,e,a),h=!0),a.modelPointerDown=!1,a.spherePointerDown&&(a.hits[0].object===a.spherePointerDown.object?(l(a.hits[0],e,a),h=!0):(l(void 0,e,a),h=!0)),a.spherePointerDown=!1),h)return}else if(a.modelPointerDown&&(c&&(c(void 0,e,a),h=!0),a.modelPointerDown=!1),a.spherePointerDown&&(l&&(l(void 0,e,a),h=!0),u&&(u(a.spherePointerDown,e,a),h=!0),a.spherePointerDown=!1),h)return}i?s&&e.button===ie.MOUSE.LEFT&&s():d&&d(e,a)},this.mouseMoveListener=function(e){var t=a.props,n=t.rotating,r=t.onCameraRotate,i=t.respondToModelGestures,o=t.respondToCameraGestures,s=t.onModelEnter,c=t.onModelExit,l=t.onModelHover,u=t.onModelDrag,d=t.onSphereHover,h=t.onSphereEnter,p=t.onSphereDrag,m=t.onSphereExit,f=t.onMouseMove,g=t.machineRotating;if(!n&&!g&&i){var v=!1;if(a.parts.model)if(a.mouse.x=e.offsetX/a.width*2-1,a.mouse.y=-e.offsetY/a.height*2+1,a.hits.length=0,a.raycaster.setFromCamera(a.mouse,a.cameraTransitions.camera),a.raycaster.intersectObject(a.parts.model.object,!0,a.hits),a.hits.length>0){if(a.hits[0].object===a.parts.model.object)a.lastHitSphere&&!a.spherePointerDown&&m&&(m(a.lastHitSphere,e,a),a.lastHitSphere=!1,v=!0),a.lastHitWasModel||a.spherePointerDown||(s&&(s(a.hits[0],e,a),v=!0),a.lastHitWasModel=a.hits[0]),a.modelPointerDown?u&&(u(a.hits[0],e,a),v=!0):a.spherePointerDown?p&&(a.spherePointerDown.point.x=a.hits[0].point.x,a.spherePointerDown.point.y=a.hits[0].point.y,a.spherePointerDown.point.z=a.hits[0].point.z,a.spherePointerDown.model=a.parts.model.object,p(a.spherePointerDown,e,a),v=!0):l&&(l(a.hits[0],e,a),v=!0);else if(a.lastHitWasModel&&!a.modelPointerDown&&c&&(c(a.lastHitWasModel,e,a),v=!0),a.lastHitWasModel=!1,(!a.lastHitSphere||a.lastHitSphere&&a.hits[0].object!==a.lastHitSphere.object&&!a.spherePointerDown)&&(a.lastHitSphere&&m&&(m(a.lastHitSphere,e,a),v=!0),h&&(h(a.hits[0],e,a),v=!0),a.lastHitSphere=a.hits[0]),a.lastHitSphere&&a.spherePointerDown&&a.lastHitSphere.object===a.spherePointerDown.object){if(p)for(var b=0;b<a.hits.length;b++)if(a.parts.model.object===a.hits[b].object){a.hits[0].point.x=a.hits[b].point.x,a.hits[0].point.y=a.hits[b].point.y,a.hits[0].point.z=a.hits[b].point.z,a.hits[0].model=a.parts.model.object,p(a.hits[0],e,a),v=!0;break}}else d&&(d(a.hits[0],e,a),v=!0);if(v)return}else if(a.modelPointerDown?u&&(u(void 0,e,a),v=!0):(a.lastHitWasModel&&c&&(c(a.lastHitWasModel,e,a),v=!0),a.lastHitWasModel=!1),a.lastHitSphere&&!a.spherePointerDown&&(m&&(m(a.lastHitSphere,e,a),v=!0),a.lastHitSphere=!1),v)return}o?r&&n&&(r(e.offsetX-a.startRotatingX,e.offsetY-a.startRotatingY),a.startRotatingX=e.offsetX,a.startRotatingY=e.offsetY):f&&f(e,a)},this.touchStartListener=function(e){var t=a.props,n=t.respondToCameraGestures,r=t.onCameraStartRotating,i=t.onCameraStopRotating,o=t.rotating;if(n)switch(e.touches.length){case 1:r&&(a.startRotateX=e.touches[0].pageX,a.startRotateY=e.touches[0].pageY,r());break;case 2:i&&o&&i();var s=e.touches[0].pageX-e.touches[1].pageX,c=e.touches[0].pageY-e.touches[1].pageY;a.touchZoomStart=Math.sqrt(s*s+c*c)}},this.touchEndListener=function(e){var t=a.props,n=t.respondToCameraGestures,r=t.onCameraStartRotating,i=t.onCameraStopRotating,o=t.rotating;if(n)switch(e.touches.length){case 0:i&&o&&i();break;case 1:r&&(a.startRotateX=e.touches[0].pageX,a.startRotateY=e.touches[0].pageY,r());break;case 2:i&&o&&i()}},this.touchMoveListener=function(e){e.preventDefault(),e.stopPropagation();var t=a.props,n=t.respondToCameraGestures,r=t.onCameraRotate,i=t.onCameraStopRotating,o=t.onCameraZoom,s=t.rotating;if(n)switch(e.touches.length){case 1:r&&s&&(r(e.touches[0].pageX-a.startRotateX,e.touches[0].pageY-a.startRotateY),a.startRotateX=e.touches[0].pageX,a.startRotateY=e.touches[0].pageY);break;case 2:if(i&&s&&i(),o){var c=e.touches[0].pageX-e.touches[1].pageX,l=e.touches[0].pageY-e.touches[1].pageY,u=Math.sqrt(c*c+l*l);o(-(u-a.touchZoomStart)),a.touchZoomStart=u}}},this.addGestureListeners=function(){a.canvas.addEventListener("wheel",a.wheelEventListener,!1),a.canvas.addEventListener("mousedown",a.mouseDownListener,!1),document.addEventListener("mouseup",a.mouseUpListener,!1),a.canvas.addEventListener("mousemove",a.mouseMoveListener),a.canvas.addEventListener("touchstart",a.touchStartListener),document.addEventListener("touchend",a.touchEndListener),a.canvas.addEventListener("touchmove",a.touchMoveListener),document.addEventListener("keydown",a.keyDownListener)},this.showDentalFixture=function(){if(a.parts.dentalFixture)a.parts.dentalFixture.object.visible=!0;else if(a.parts.bAxis){var e={id:"dentalFixture",path:"models/dental_fixture.obj",material:a.toolMaterial};a.objLoader.load(e.path,(function(t){t.traverse((function(t){t instanceof ie.Mesh&&(t.material=e.material)})),e.object=t,a.parts.dentalFixture=e;var n=et(a.parts.dentalFixture.object);n.geometry.computeBoundingBox(),a.parts.dentalFixture.boundingBox=n.geometry.boundingBox.clone(),a.parts.bAxis.object.add(a.parts.dentalFixture.object)}),(function(e){}),(function(e){console.error(e)}))}},this.hideDentalFixture=function(){a.parts.dentalFixture&&(a.parts.dentalFixture.object.visible=!1)},this.showModel=function(){a.parts.model&&(a.parts.model.object.visible=!0)},this.hideModel=function(){a.parts.model&&(a.parts.model.object.visible=!1)},this.computePlaneWithLargestArea=function(){var e=a.props.onModelComputePlaneWithLargestArea;e&&e(function(e){var t={},n={},a=.05,r=function(e,r,i,o,s,c,l,u,d){var h=o-e,p=s-r,m=c-i,f=l-e,g=u-r,v=d-i,b=p*v-m*g,O=m*f-h*v,x=h*g-p*f,S=Math.sqrt(b*b+O*O+x*x),y=1/S,M=y*b,j=y*O,w=y*x,E=-(e*M+r*j+i*w);M<a&&M>-.05?M=0:Math.abs(1-M)<a?M=1:Math.abs(-1-M)<a&&(M=-1),j<a&&j>-.05?j=0:Math.abs(1-j)<a?j=1:Math.abs(-1-j)<a&&(j=-1),w<a&&w>-.05?w=0:Math.abs(1-w)<a?w=1:Math.abs(-1-w)<a&&(w=-1);var T=Math.round(M/a),P=Math.round(j/a),A=Math.round(w/a),k=Math.round(E/.1),C="".concat(T,",").concat(P,",").concat(A,",").concat(k),G=.5*S;t[C]||(t[C]=0,n[C]={nx:M,ny:j,nz:w,dist:E}),t[C]+=G},i=e.geometry.getAttribute("position");if(null===e.geometry.getIndex()){for(var o=0;o<i.count;o+=9)r(i.array[o],i.array[o+1],i.array[o+2],i.array[o+3],i.array[o+4],i.array[o+5],i.array[o+6],i.array[o+7],i.array[o+8]);var s,c=Object.entries(t);c.sort((function(e,t){return t[1]-e[1]}));for(var l=0;l<c.length;l++){for(var u=n[c[l][0]],d=u.nx,h=u.ny,p=u.nz,m=u.dist,f=!1,g=0;g<i.count&&!f;g+=3)i.array[g]*d+i.array[g+1]*h+i.array[g+2]*p+m>a+$e&&(f=!0);if(!f){s=n[c[l][0]];break}}return new ie.Plane(new ie.Vector3(s.nx,s.ny,s.nz),s.dist)}}(et(a.parts.model.object)),a)},this.loadSTLModel=function(e){var t=a.props.smoothModelTransition,n=a.stlLoader.parse(e),r=new ie.Mesh(n,a.modelMaterial);if(r.scale.x=1/25.4,r.scale.y=1/25.4,r.scale.z=1/25.4,a.parts.model)if(a.parts.smoothModel){var i=a.parts.smoothModel.object;a.leavingModel=i,setTimeout((function(){a.parts.bAxis.object.remove(i)}),1e3)}else a.parts.bAxis.object.remove(a.parts.model.object);else a.parts.model={id:"model",material:a.modelMaterial};a.parts.model.object=r,r.traverse((function(e){e instanceof ie.Mesh&&(e.material=a.parts.model.material)})),t?(a.parts.smoothModel={id:"smoothModel",object:new ie.Object3D},a.parts.smoothModel.object.position.y=a.modelTransitionStartY,a.parts.bAxis.object.add(a.parts.smoothModel.object),a.parts.smoothModel.object.add(a.parts.model.object)):a.parts.bAxis.object.add(a.parts.model.object)},this.loadObjModel=function(e){var t=a.props.smoothModelTransition,n=a.objLoader.parse(e);if(n.scale.x=1/25.4,n.scale.y=1/25.4,n.scale.z=1/25.4,a.parts.model)if(a.parts.smoothModel){var r=a.parts.smoothModel.object;a.leavingModel=r,setTimeout((function(){a.parts.bAxis.object.remove(r)}),1e3)}else a.parts.bAxis.object.remove(a.parts.model.object);else a.parts.model={id:"model",material:a.modelMaterial};a.parts.model.object=n,n.traverse((function(e){e instanceof ie.Mesh&&(e.material=a.parts.model.material)})),t?(a.parts.smoothModel={id:"smoothModel",object:new ie.Object3D},a.parts.smoothModel.object.position.y=a.modelTransitionStartY,a.parts.bAxis.object.add(a.parts.smoothModel.object),a.parts.smoothModel.object.add(a.parts.model.object)):a.parts.bAxis.object.add(a.parts.model.object)},this.parentCameraToTool=function(){a.ready&&a.cameraTransitions.setParent(a.parts.tool.object)},this.parentCameraToDentalFixture=function(){a.ready&&a.cameraTransitions.setParent(a.parts.dentalFixtureFocusPoint.object)},this.parentCameraToB=function(){a.ready&&a.cameraTransitions.setParent(a.parts.bAxis.object)},this.parentCameraToA=function(){a.ready&&a.cameraTransitions.setParent(a.parts.aAxis.object)},this.parentCameraToY=function(){a.ready&&a.cameraTransitions.setParent(a.parts.yAxis.object)},this.parentCameraToBase=function(){a.ready&&a.cameraTransitions.setParent(a.parts.base.object)},this.update=function(e){a.props=e;var t=a.props,n=t.cameraParent,r=t.cameraMode,i=t.showModel,o=t.showDentalFixture,s=t.rotating,c=t.phi,l=t.theta,u=t.radius,d=t.orthographicZoom,h=t.showGhostSphere,p=t.ghostSpherePosition,m=t.ghostSphereOpacity,f=t.points,g=t.activePoint,v=t.highlightedPoint,b=t.hideTool,O=t.highlightModel,x=t.modelRX,S=t.modelRY,y=t.modelRZ,M=t.modelTX,j=t.modelTY,w=t.modelTZ,E=t.machine;if(a.ready)switch(E){case Oe:a.parts.v250ToolHolder.object.visible=!0,a.parts.toolHolder.object.visible=!1,a.parts.toolHolderShort.object.visible=!1,a.parts.v250Spindle.object.visible=!0,a.parts.v210Spindle.object.visible=!1;break;case be:a.parts.v250ToolHolder.object.visible=!1,a.parts.v250Spindle.object.visible=!1,a.parts.v210Spindle.object.visible=!0}a.parts.model&&(et(a.parts.model.object).material=O?a.highlightedModelMaterial:a.modelMaterial,"undefined"!==typeof M&&(a.parts.model.object.position.x=M),"undefined"!==typeof j&&(a.parts.model.object.position.y=j),"undefined"!==typeof w&&(a.parts.model.object.position.z=w),"undefined"!==typeof x&&(a.parts.model.object.rotation.x=x),"undefined"!==typeof S&&(a.parts.model.object.rotation.y=S),"undefined"!==typeof y&&(a.parts.model.object.rotation.z=y),a.parts.model.object.updateMatrix(),a.parts.model.object.updateMatrixWorld()),a.parts.tool&&(a.parts.tool.object.visible=!b),a.ghostSphere.visible=h,p&&(a.ghostSphere.position.x=p.x,a.ghostSphere.position.y=p.y,a.ghostSphere.position.z=p.z);var T=m||0;if(a.ghostSphere.material.opacity=T,a.ghostSphere.material.transparent=!(T>=1),f&&a.parts.model){if(a.spheres.length<f.length)for(var P=f.length-a.spheres.length,A=0;A<P;A++){var k=new ie.Mesh(a.sphereGeometry,a.sphereMaterial);k.userData.index=a.spheres.length,a.parts.model.object.add(k),a.spheres.push(k)}for(var C=0;C<a.spheres.length;C++)a.spheres[C].parent!==a.parts.model.object&&a.parts.model.object.add(a.spheres[C]),a.spheres[C].material=C===g?C===v?a.highlightedActiveSphereMaterial:a.activeSphereMaterial:C===v?a.highlightedSphereMaterial:a.sphereMaterial,C<f.length?(a.spheres[C].visible=!0,a.spheres[C].position.x=f[C][0],a.spheres[C].position.y=f[C][1],a.spheres[C].position.z=f[C][2]):a.spheres[C].visible=!1}switch(a.cameraTransitions.rotating=s,a.cameraTransitions.spherical.phi=c,a.cameraTransitions.spherical.theta=l,a.cameraTransitions.spherical.radius=u,a.cameraTransitions.orthographicCamera.zoom=d,a.cameraTransitions.orthographicCamera.updateProjectionMatrix(),n){case xe:a.parentCameraToBase();break;case Me:a.parentCameraToY();break;case Se:a.parentCameraToB();break;case ye:a.parentCameraToA();break;case je:a.parentCameraToTool();break;case we:a.parentCameraToDentalFixture()}switch(r){case Ee:a.cameraTransitions.setPerspective();break;case Te:a.cameraTransitions.setOrthographic()}i?a.showModel():a.hideModel(),o?a.showDentalFixture():a.hideDentalFixture()},this.updateDimensions=function(e,t){a.width=e,a.height=t,a.renderer.setSize(a.width,a.height),a.cameraTransitions.updateCanvasDimensions(e,t),a.viewCube.setPosition(e-150,a.height-100)},this.updateMachine=function(){var e=a.props,t=e.smoothJointTransitions,n=e.smoothModelTransition;if(a.ready){if(a.checkLimits(),a.cameraTransitions.update(),t){for(var r=0;r<a.smoothJoints.length;r++){if(4===r){var i=((a.props.joints[r]-a.smoothJoints[r])%360+360)%360;i>180&&(i-=360),a.smoothJoints[r]=a.props.joints[r]-i}a.smoothJoints[r]=a.smoothJoints[r]*a.smoothJointsFilter+a.props.joints[r]*(1-a.smoothJointsFilter)}a.parts.bAxis.object.rotation.y=a.smoothJoints[4]*Math.PI/180,a.parts.aAxis.object.rotation.x=a.smoothJoints[3]*Math.PI/180,a.parts.yAxis.object.position.y=-a.smoothJoints[1],a.parts.zAxis.object.position.z=6.26+a.smoothJoints[2],a.parts.xAxis.object.position.x=a.smoothJoints[0]}else a.parts.bAxis.object.rotation.y=a.props.joints[4]*Math.PI/180,a.parts.aAxis.object.rotation.x=a.props.joints[3]*Math.PI/180,a.parts.yAxis.object.position.y=-a.props.joints[1],a.parts.zAxis.object.position.z=6.26+a.props.joints[2],a.parts.xAxis.object.position.x=a.props.joints[0];a.parts.model&&n&&(a.parts.smoothModel.object.position.y=a.parts.smoothModel.object.position.y*a.modelTransitionFilter),a.leavingModel&&n&&(a.leavingModel.position.y=a.leavingModel.position.y*a.modelTransitionFilter+a.modelTransitionStartY*(1-a.modelTransitionFilter)),a.parts.tool&&(a.parts.tool.object.position.z=-a.props.toolLength,a.parts.tool.object.scale.x=a.props.toolDiameter,a.parts.tool.object.scale.y=a.props.toolDiameter,a.parts.toolHolder.object.rotation.z=a.props.spindleAngle,a.parts.toolHolderShort.object.rotation.z=a.props.spindleAngle,a.props.machine===be&&(a.props.toolHolder===ge?(a.parts.toolHolderShort.object.visible=!0,a.parts.toolHolder.object.visible=!1):a.props.toolHolder===fe?(a.parts.toolHolderShort.object.visible=!1,a.parts.toolHolder.object.visible=!0):(a.parts.toolHolderShort.object.visible=!1,a.parts.toolHolder.object.visible=!1)))}},this.render=function(){var e=a.props.showViewCube;a.renderer.clear(),a.renderer.setViewport(0,0,a.width,a.height),a.renderer.setScissorTest(!1),a.renderer.render(a.scene,a.cameraTransitions.camera),e&&(a.viewCube.setOrientation(a.cameraTransitions.localOrientation),a.viewCube.render(a.renderer))},this.checkLimits=function(){for(var e={0:a.parts.xAxis,1:a.parts.yAxis,2:a.props.machine===be?a.parts.v210Spindle:a.parts.v250Spindle,3:a.parts.aAxis,4:a.parts.bAxis},t=0;t<a.props.joints.length;t++)a.props.joints[t]<a.props.limits.min[t]-$e||a.props.joints[t]>a.props.limits.max[t]+$e?(e[t].material&&(e[t].material.color=new ie.Color(1,0,0),e[t].material.emissive=new ie.Color(.3,0,0)),a.totalTime=0):e[t].material&&(e[t].material.color=new ie.Color(1,1,1),e[t].material.emissive=new ie.Color(0,0,0))},this.createLights=function(){var e=new ie.DirectionalLight(16777215,.15);e.position.set(-30,30,30),e.lookAt(0,0,0);var t=new ie.DirectionalLight(16777215,.15);t.position.set(-30,30,-30),t.lookAt(0,0,0);var n=new ie.DirectionalLight(16777215,.07);n.position.set(30,30,30),n.lookAt(0,0,0);var r=new ie.DirectionalLight(16777215,.07);r.position.set(30,30,-30),r.lookAt(0,0,0);var i=new ie.DirectionalLight(16777215,.07);i.position.set(30,-30,-30),i.lookAt(0,0,0),a.scene.add(i),a.scene.add(e),a.scene.add(t),a.scene.add(n),a.scene.add(r)},this.findTime=function(e){if(e>=a.times[a.times.length-1])return a.times.length-1;for(var t=0,n=a.times.length-1,r=Math.floor(a.times.length/2);!(a.times[r]<e&&a.times[r+1]>=e);)a.times[r]>=e?n=r:t=r,r=Math.floor(.5*(t+n));return r},this.step=function(e){a.viewCube.step(e)},this.props=n,this.canvas=t,this.startTime=K()(),this.smoothJoints=Object(Y.a)(n.joints),this.smoothJointsFilter=.6,this.modelTransitionFilter=.85,this.modelTransitionStartY=10,this.raycaster=new ie.Raycaster,this.hits=[],this.mouse=new ie.Vector2,this.backplot=le.getInstance(),this.backplotStrip=de.getInstance(),this.scene=new ie.Scene,this.scene.background=new ie.Color(13421772),this.renderer=new ie.WebGLRenderer({canvas:t}),this.renderer.autoClear=!1,this.renderer.setPixelRatio(window.devicePixelRatio),this.width=window.innerWidth,this.height=window.innerHeight,this.viewCube=new pe(t,this.width-150,this.height-100,100,100);this.viewCube.addEventListener("click",(function(e){var t=a.props.onCameraSetDirection;t&&t(e.x,e.y,e.z);var n=Math.max(Math.abs(e.x),Math.abs(e.y),Math.abs(e.z)),r=e.x/n,i=e.y/n,o=e.z/n;Qe.event("ViewCube","clicked face ("+(r<$e&&r>-$e?0:r)+", "+(i<$e&&i>-$e?0:i)+", "+(o<$e&&o>-$e?0:o)+")").send()})),this.renderer.setSize(this.width,this.height),this.renderer.setClearColor(16777215,1),this.cameraTransitions=new me(this.scene,t),this.createLights();var r=new ie.OBJLoader;this.stlLoader=new ie.STLLoader,this.objLoader=r;var i=new ie.TextureLoader;this.textureLoader=i;var o="textures/cube/",s=[o+"px.jpg",o+"nx.jpg",o+"py.jpg",o+"ny.jpg",o+"pz.jpg",o+"nz.jpg"];this.envMap=(new ie.CubeTextureLoader).load(s),this.envMap.format=ie.RGBFormat,this.envMap.mapping=ie.CubeReflectionMapping;var c=new ie.MeshStandardMaterial({color:4539717,metalness:1,roughness:.5,envMap:this.envMap,envMapIntensity:1.5});this.toolMaterial=new ie.MeshStandardMaterial({color:16777215,metalness:1,roughness:.3,envMap:this.envMap});var l=this.toolMaterial,u=new ie.MeshStandardMaterial({color:1118481,metalness:.5,roughness:.6,envMap:this.envMap,emissive:14483456}),d=new ie.MeshStandardMaterial({color:16777215,metalness:.2,roughness:.6,envMap:this.envMap,emissive:4473929});this.sphereGeometry=new ie.SphereGeometry(.5,32,32),this.ghostSphereGeometry=new ie.SphereGeometry(.01968,32,32),this.ghostMaterial=new ie.MeshStandardMaterial({color:2616319,metalness:.7,roughness:.7,envMap:this.envMap,envMapIntensity:3,opacity:.5,transparent:!0}),this.sphereMaterial=new ie.MeshStandardMaterial({color:2616319,metalness:.7,roughness:.7,envMap:this.envMap,envMapIntensity:3}),this.highlightedSphereMaterial=new ie.MeshStandardMaterial({color:2616319,metalness:.7,roughness:.7,envMap:this.envMap,envMapIntensity:4}),this.activeSphereMaterial=new ie.MeshStandardMaterial({color:13434641,metalness:.7,roughness:.7,envMap:this.envMap,envMapIntensity:3}),this.highlightedActiveSphereMaterial=new ie.MeshStandardMaterial({color:13434641,metalness:.7,roughness:.7,envMap:this.envMap,envMapIntensity:4}),this.ghostSphere=new ie.Mesh(this.ghostSphereGeometry,this.ghostMaterial),this.ghostSphere.visible=this.props.showGhostSphere,this.scene.add(this.ghostSphere),this.spheres=[],this.modelMaterial=new ie.MeshStandardMaterial({color:16777215,metalness:.5,roughness:.6,envMap:this.envMap,emissive:2236962}),this.highlightedModelMaterial=new ie.MeshStandardMaterial({color:2616319,metalness:.5,roughness:.6,envMap:this.envMap,envMapIntensity:1.5,opacity:.75,transparent:!0,emissive:738892});var h=[{id:"aAxis",path:"models/v2/aAxis.obj",map:"textures/v2/aAxisMap.png"},{id:"bAxis",path:"models/v2/bAxis.obj",map:"textures/v2/bAxisMap.png"},{id:"xAxis",path:"models/v2/xAxis.obj",map:"textures/v2/xAxisMap.png"},{id:"yAxis",path:"models/v2/yAxis.obj",map:"textures/v2/yAxisMap.png"},{id:"v250Spindle",path:"models/v2/zAxisV250.obj",map:"textures/v2/zAxisV250Map.png"},{id:"v210Spindle",path:"models/v2/zAxis.obj",map:"textures/v2/zAxisMap.png"},{id:"base",path:"models/v2/base.obj",map:"textures/v2/baseMap.png"},{id:"baseButtons",path:"models/v2/base_buttons.obj",material:l},{id:"estopRing",path:"models/v2/estop_ring.obj",material:u},{id:"startStopRing",path:"models/v2/start_stop_ring.obj",material:d},{id:"v250ToolHolder",path:"models/v2/v250ToolHolder.obj",map:"textures/v2/v250ToolHolderAO.png",shiny:!0},{id:"toolHolder",path:"models/long_tool_holder.obj",material:l},{id:"toolHolderShort",path:"models/short_tool_holder.obj",material:l},{id:"toolColletHolder",path:"models/long_tool_collet_holder.obj",material:c},{id:"toolColletHolderShort",path:"models/short_tool_collet_holder.obj",material:c}];this.props.showDentalFixture&&h.push({id:"dentalFixture",path:"models/dental_fixture.obj",material:this.toolMaterial}),this.parts={},h.forEach((function(e){r.load(e.path,(function(t){e.material&&t.traverse((function(t){t instanceof ie.Mesh&&(t.material=e.material)})),e.object=t,Qe.timing("Viewer3D","Loaded Model "+e.id,Math.round(K()()-a.startTime)).send()}),(function(e){}),(function(e){console.error(e)})),e.map?i.load(e.map,(function(t){e.shiny?e.material=new ie.MeshStandardMaterial({map:t,metalness:1,roughness:.3,envMap:a.envMap}):e.material=new ie.MeshStandardMaterial({map:t,metalness:1,roughness:.4,envMapIntensity:1.25,envMap:a.envMap}),e.object&&e.object.traverse((function(t){t instanceof ie.Mesh&&(t.material=e.material)})),Qe.timing("Viewer3D","Loaded Texture "+e.id,Math.round(K()()-a.startTime)).send()}),void 0,(function(e){console.error(e)})):e.object&&e.object.traverse((function(t){t instanceof ie.Mesh&&(t.material=e.material)}))}));this.time=0,function e(){var t=!0;if(h.forEach((function(e){e.object&&e.material||(t=!1)})),t){h.forEach((function(e){a.parts[e.id]=e}));var n=new ie.CylinderGeometry(.5,.5,6,32),r=new ie.SphereGeometry(.5,32,32),i=new ie.Mesh(n,l),o=new ie.Mesh(r,l),s=new ie.Group;if(i.position.z=3,i.rotation.x=Math.PI/2,o.position.z=.03125,s.add(i),a.parts.tool={object:s,material:l},a.parts.zAxis={object:new ie.Group},a.parts.zAxis.object.add(a.parts.v250Spindle.object),a.parts.zAxis.object.add(a.parts.v210Spindle.object),a.props.machine===Oe?a.parts.v210Spindle.object.visible=!1:(a.parts.v250Spindle.object.visible=!1,a.parts.v250ToolHolder.object.visible=!1),a.parts.zAxis.object.position.z=3,a.parts.aAxis.object.rotation.x=0,a.parts.xAxis.object.add(a.parts.zAxis.object),a.parts.yAxis.object.add(a.parts.aAxis.object),a.parts.zAxis.object.add(a.parts.tool.object),a.parts.zAxis.object.add(a.parts.toolHolder.object),a.parts.zAxis.object.add(a.parts.v250ToolHolder.object),a.parts.toolHolder.object.add(a.parts.toolColletHolder.object),a.parts.toolHolder.object.visible=!1,a.parts.zAxis.object.add(a.parts.toolHolderShort.object),a.parts.toolHolderShort.object.add(a.parts.toolColletHolderShort.object),a.parts.aAxis.object.add(a.parts.bAxis.object),a.parts.bAxis.object.add(a.backplot.object),a.parts.bAxis.object.add(a.backplotStrip.object),a.parts.base.object.add(a.parts.yAxis.object),a.parts.base.object.add(a.parts.xAxis.object),a.parts.base.object.add(a.parts.baseButtons.object),a.parts.base.object.add(a.parts.estopRing.object),a.parts.base.object.add(a.parts.startStopRing.object),a.props.showDentalFixture){a.parts.bAxis.object.add(a.parts.dentalFixture.object);var c=et(a.parts.dentalFixture.object);c.geometry.computeBoundingBox(),a.parts.dentalFixture.boundingBox=c.geometry.boundingBox.clone(),a.parts.dentalFixtureFocusPoint={id:"dentalFixtureFocusPoint",object:new ie.Object3D},a.parts.dentalFixtureFocusPoint.object.position.y=(3+qe)/25.4,a.parts.bAxis.object.add(a.parts.dentalFixtureFocusPoint.object)}a.scene.add(a.parts.base.object),a.props.showDentalFixture?a.cameraTransitions.setParent(a.parts.dentalFixtureFocusPoint.object):a.cameraTransitions.setParent(a.parts.yAxis.object),a.ready=!0,Qe.timing("Viewer3D","Ready",Math.round(K()()-a.startTime)).send()}else window.setTimeout(e,500)}(),this.addGestureListeners()}return Object(U.a)(e,null,[{key:"getInstance",value:function(){return e.instance}},{key:"createInstance",value:function(t,n){return e.instance=new e(t,n),e.instance}}]),e}(),nt=n(12),at=function(e){Object(H.a)(n,e);var t=Object(X.a)(n);function n(){var e;Object(V.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).updateDimensions=function(){var t=e.props,n=t.hideTitleBar,a=t.onUpdateDimensions,r=window.innerWidth,i=window.innerHeight-(n?0:64);e.viewer.updateDimensions(r,i),a&&a(r,i)},e}return Object(U.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.hideTitleBar,a=t.onUpdateDimensions;window.addEventListener("resize",this.updateDimensions),this.viewer=tt.createInstance(this.canvas,this.props);var r=window.innerWidth,i=window.innerHeight-(n?0:64);this.viewer.updateDimensions(r,i),a&&a(r,i);!function t(){e.animationRequestID=window.requestAnimationFrame(t),e.viewer.step(.01667),e.viewer.updateMachine(),e.viewer.render()}()}},{key:"componentWillUnmount",value:function(){this.animationRequestID&&window.cancelAnimationFrame(this.animationRequestID),this.viewer=null,window.removeEventListener("resize",this.updateDimensions)}},{key:"componentDidUpdate",value:function(){this.viewer.update(this.props)}},{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=t.hideTitleBar;return f.a.createElement("div",{className:a?"":n.container},f.a.createElement("canvas",{ref:function(t){return e.canvas=t}}))}}]),n}(m.Component),rt=Object(nt.a)({container:{paddingTop:64,overflow:"hidden"}})(at),it={G4:!0,G5:!0,"G5.1":!0,"G5.2":!0,"G5.3":!0,G7:!0,G8:!0,G10:!0,"G17.1":!0,"G18.1":!0,"G19.1":!0,G28:!0,"G28.1":!0,G30:!0,"G30.1":!0,G33:!0,"G33.1":!0,"G38.2":!0,"G38.3":!0,"G38.4":!0,"G38.5":!0,G41:!0,G42:!0,"G41.1":!0,"G42.1":!0,"G43.1":!0,"G43.2":!0,G61:!0,"G61.1":!0,G64:!0,G73:!0,G76:!0,G80:!0,G81:!0,G82:!0,G83:!0,G84:!0,G85:!0,G86:!0,G87:!0,G88:!0,G89:!0,G92:!0,"G92.1":!0,"G92.2":!0,"G92.3":!0,G95:!0,G96:!0,G97:!0,G98:!0,G99:!0,M0:!0,M1:!0,M2:!0,M30:!0,M7:!0,M8:!0,M9:!0,M19:!0,M48:!0,M49:!0,M50:!0,M51:!0,M52:!0,M53:!0,M61:!0,M62:!0,M63:!0,M64:!0,M65:!0,M66:!0,M67:!0,M68:!0,M70:!0,M71:!0,M72:!0,M73:!0},ot={G0:"Move at machine's maximum speed.",G1:"Move at the current feed rate.",G2:"Make a clockwise arc move.",G3:"Make a counter-clockwise arc move.",G4:"Dwell in place.",G5:"Make a cubic spline move.","G5.1":"Make a quadratic spline move.","G5.2":"Make a NURBS move.","G5.3":"Make a NURBS move.",G80:"Cancel canned cycle.",G17:"Select XY plane.",G18:"Select XZ plane.",G19:"Select YZ plane.",G40:"Turn off cutter compensation.",G43:"Enable tool length offset.",G49:"Disable tool length offset.",G90:"Set absolute distance mode.",G91:"Set incremental distance mode.","G90.1":"Set absolute arc distance mode.","G91.1":"Set incremental arc distance mode.",G93:"Set inverse time feed rate mode.",G94:"Set units per minute feed rate mode.",G7:"Enable lathe diameter mode.",G8:"Enable lathe radius mode.",G10:"Set tool table and coordinate system.","G17.1":"Select UV plane.","G18.1":"Select WU plane.","G19.1":"Select VW plane.",G28:"Go to predefined absolute position stored in parameters 5161-5166.","G28.1":"Store current position in parameters 5161-5166",G30:"Go to predefined absolute position stored in parameters 5181-5186.","G30.1":"Store current position in parameters 5181-5186.",G33:"Spindle synchronized motion.","G33.1":"Rigid tapping.","G38.2":"Probe toward workpiece, stop on contact, signal error if failure. Implemented to behave like G1.","G38.3":"Probe toward workpiece, stop on contact. Implemented to behave like G1.","G38.4":"Probe away from workpiece, stop on loss of contact, signal error if failure. Implemented to behave like G1.","G38.5":"Probe away from workpiece, stop on loss of contact. Implemented to behave like G1.",G41:"Enable cutter compensation left of programmed path.",G42:"Enable cutter compensation right of programmed path.","G41.1":"Enable cutter compensation left of programmed path with tool diameter.","G42.1":"Enable cutter compensation right of programmed path with tool diameter.","G43.1":"Dynamic tool length offset.","G43.2":"Apply additional tool length offset.",G54:"Select coordinate system 1 (the default).",G55:"Select coordinate system 2.",G56:"Select coordinate system 3.",G57:"Select coordinate system 4.",G58:"Select coordinate system 5.",G59:"Select coordinate system 6.","G59.1":"Select coordinate system 7.","G59.2":"Select coordinate system 8.","G59.3":"Select coordinate system 9.",G61:"Enable exact path mode.","G61.1":"Enable exact path mode.",G64:"Set path blending parameters.",G73:"Drilling cycle with chip breaking.",G76:"Threading cycle.",G81:"Drilling cycle.",G82:"Drilling cycle, dwell.",G83:"Peck drilling cycle.",G84:"Right-hand tapping cycle.",G85:"Boring cycle, feed out.",G86:"Boring cycle, spindle stop, rapid move out.",G87:"Back boring cycle.",G88:"Boring cycle, spindle stop, manual out.",G89:"Boring cycle, dwell, feed out.",G92:"Offsets the coordinate system by setting the current point to the axis numbers you want and stores the offsets in parameters 5211-5219.","G92.1":"Reset G92 offsets to zero and sets parameters 5211-5219 to zero.","G92.2":"Reset G92 offsets to zero.","G92.3":"Set the G92 offsets to the values saved in parameters 5211-5219.",G95:"Set units per revolution feed rate mode.",G96:"Spindle control mode, constant surface speed.",G97:"Spindle control mode, RPM mode.",G98:"Retract to the position that axis was in just before this series of one or more contiguous canned cycles was started.",G99:"Retract to the position specified by the R word of the canned cycle.",M3:"Turn on spindle going clockwise.",M4:"Turn on spindle going counter-clockwise.",M5:"Turn off spindle.",M6:"Change tool.",M0:"Pause program.",M1:"Pause program if optional stop switch is on.",M2:"End the program. Pressing cycle start will start the program at the beginning of the file.",M30:"End the program. Pressing cycle start will start the program at the beginning of the file.",M7:"Turn mist coolant on.",M8:"Turn flood coolant on.",M9:"Turn both mist and flood coolant off.",M19:"Orient spindle.",M48:"Enable speed and feed rate override controls.",M49:"Disable spindle speed and feed rate override controls.",M50:"Feed override control.",M51:"Spindle speed override control.",M52:"Use adaptive feed.",M53:"Enable feed stop switch.",M61:"Change the current tool number while in MDI or Manual mode.",M62:"Turn on digital output synchronized with motion.",M63:"Turn on digital output synchronized with motion.",M64:"Turn on digital output immediately.",M65:"Turn on digital output immediately.",M66:"Wait on digital input.",M67:"Set an analog output synchronized with motion.",M68:"Set an analog output immediately.",M70:"Save modal state.",M71:"Invalidate saved modal state.",M72:"Restore modal state.",M73:"Save modal state with a subroutine and restore state on subroutine endsub or any return path.",M254:"Rotate the current work offset by the current tilt angle and store the results in the specified work offsets.",M428:"Enable TCPC.",M429:"Disable TCPC."},st={G0:L.machineState.motion.rapid,G1:L.machineState.motion.linear,G2:L.machineState.motion.arcCW,G3:L.machineState.motion.arcCCW,"G38.2":L.machineState.motion.linear,"G38.3":L.machineState.motion.linear,"G38.4":L.machineState.motion.linear,"G38.5":L.machineState.motion.linear,G17:L.machineState.planeSelect.setXY,G18:L.machineState.planeSelect.setZX,G19:L.machineState.planeSelect.setYZ,G40:L.machineState.cutterCompensation.off,G43:L.machineState.tool.setToolLengthOffset,G49:L.machineState.tool.clearToolLengthOffset,G54:L.machineState.motion.g5x.enableG54,G55:L.machineState.motion.g5x.enableG55,G56:L.machineState.motion.g5x.enableG56,G57:L.machineState.motion.g5x.enableG57,G58:L.machineState.motion.g5x.enableG58,G59:L.machineState.motion.g5x.enableG59,"G59.1":L.machineState.motion.g5x.enableG591,"G59.2":L.machineState.motion.g5x.enableG592,"G59.3":L.machineState.motion.g5x.enableG593,G90:L.machineState.distanceMode.setAbsolute,G91:L.machineState.distanceMode.setIncremental,"G90.1":L.machineState.distanceMode.setAbsoluteArc,"G91.1":L.machineState.distanceMode.setIncrementalArc,G93:L.machineState.feedRateMode.setInverseTime,G94:L.machineState.feedRateMode.setUnitsPerMinute,M3:L.machineState.spindleControl.cw,M4:L.machineState.spindleControl.ccw,M5:L.machineState.spindleControl.off,M6:L.machineState.tool.change,M254:L.machineState.motion.g5x.computeDynamicWorkOffsets,M428:L.machineState.kinematicsMode.setFiveAxis,M429:L.machineState.kinematicsMode.setTrivial},ct={G20:L.machineState.units.setIn,G21:L.machineState.units.setMm},lt={T:L.machineState.tool.set,S:L.machineState.spindleSpeed.set,F:L.machineState.feedRate.set},ut={G53:!0},dt={G54:!0,G55:!0,G56:!0,G57:!0,G58:!0,G59:!0,"G59.1":!0,"G59.2":!0,"G59.3":!0},ht=L.machineState.motion.setPosition,pt="error",mt="warning",ft="info",gt="UNIMPLEMENTED",vt="MINIMUM_LIMIT",bt="MAXIMUM_LIMIT",Ot="SET_TOOL_LENGTH_OFFSET",xt="SET_WORK_COORDINATE_SYSTEM",St="COMPUTED_DYNAMIC_WORK_OFFSETS",yt="SET_UNITS";function Mt(e){return{message:"Can't set tool number to non integer value: "+e,type:"NON_INTEGER_TOOL_NUMBER",severity:pt}}function jt(e,t){return{message:"Can't run multiple commands in the same modal group on the same line. Codes "+e.slice(0,e.length-1).join(", ")+" and "+e[e.length-1]+" are in modal group "+t+".",codes:e,group:t,type:"MULTIPLE_COMMANDS_IN_MODAL_GROUP",severity:pt}}function wt(e,t){return{message:e+" axis exceeded maximum limit by "+t.toFixed(4)+".",axis:e,amount:t,type:bt,severity:pt}}function Et(e){var t=function(e){return ot[e]}(e);return{message:"Ignoring "+e+" as it is currently unimplemented in the simulator. Intended usage: "+t,description:t,severity:mt,type:gt,code:e}}function Tt(){return{message:"Feed rate must be greater than 0 for linear or arc moves.",severity:pt,type:"ZERO_FEED_RATE"}}var Pt={1:"G54",2:"G55",3:"G56",4:"G57",5:"G58",6:"G59",7:"G59.1",8:"G59.2",9:"G59.3"};var At={G20:"inches",G21:"millimeters"};function kt(e,t){return Object(O.a)(Object(O.a)({},e),{},{line:t})}var Ct=function(e,t){var n=It(e,0),a=It({X:n[0],Y:n[1],Z:n[2],A:t.A,B:t.B},0);return{X:a[0],Y:a[1],Z:a[2],A:0,B:0}},Gt=function(e){var t=e[3],n=e[4],a=t*Math.PI/180,r=n*Math.PI/180,i=Math.cos(a),o=Math.sin(a),s=Math.cos(r);return{X:-Math.sin(r)*i,Y:o,Z:s*i}},Lt=function(e,t){return Rt(e,t)},Rt=function(e,t){var n=e[3],a=e[4],r=n*Math.PI/180,i=a*Math.PI/180,o=Math.cos(r),s=Math.sin(r),c=Math.cos(i),l=Math.sin(i),u=t,d=e[0],h=e[1],p=e[2];return{X:d*c+h*l*s-(p-u)*l*o,Y:h*o+(p-u)*s,Z:d*l-h*c*s+(p-u)*c*o,A:n,B:a}},It=function(e,t){var n=e.A,a=e.B,r=n*Math.PI/180,i=a*Math.PI/180,o=Math.cos(r),s=Math.sin(r),c=Math.cos(i),l=Math.sin(i),u=t,d=e.X,h=e.Y,p=e.Z;return[d*c+p*l,d*l*s+h*o-p*c*s,-d*l*o+h*s+p*c*o+u,n,a]},Nt={inverseKinematics:function(e,t){var n=e.kinematicsMode,a=0;t||(a=e.tool.toolLengthOffset.Z);var r=e.motion.position;return n===Ie?It(r,a):[r.X,r.Y,r.Z+a,r.A,r.B]},forwardKinematics:function(e,t){var n=e.kinematicsMode,a=t?0:e.tool.toolLengthOffset.Z,r=e.joints;return n===Ie?Rt(r,a):{X:r[0],Y:r[1],Z:r[2]-a,A:r[3],B:r[4]}}},_t={extents:{max:[2.55,2.55,.1,135,9999],min:[-2,-2.5,-3.45,-25,-9999]},velocities:[1,1,1,37.5,37.5],accelerations:[10,10,10,300,300]},Dt=["X","Y","Z","A","B"],Ft=function(e,t){for(var n,a,r=[],i=0;i<e.length;i++){var o=e[i];o<t.extents.min[i]-$e?r.push((n=Dt[i],a=Math.abs(o-t.extents.min[i]),{message:n+" axis exceeded minimum limit by "+a.toFixed(4)+".",axis:n,amount:a,type:vt,severity:pt})):o>t.extents.max[i]+$e&&r.push(wt(Dt[i],Math.abs(o-t.extents.max[i])))}return r.length>0?r:[]},zt=Ct,Zt=Gt,Bt=Lt,Vt=Rt,Ut=It,Ht=Nt,Xt={extents:{max:[2.55,2.55,0,135,9999],min:[-2,-2.5,-3.54,-25,-9999]},velocities:[1,1,1,37.5,37.5],accelerations:[10,10,10,300,300]},Yt=Dt,Wt=Ft,Kt={[be]:d,[Oe]:h},Jt="OFF",qt=Object(b.b)((function(e,t){var n=e.machineState,a=n.tool.loaded,r=0,i=.125,o=ve;if(a>=0){var s=n.tool.table[a];r=6.26+s.Z,i=2*s.R,o=s.holder}var c=n.tool.toolLengthOffset.Z,l=e.interpreter.currentTime,u=0;n.spindleControl!==Jt&&(u=2*l*Math.PI*n.spindleSpeed,"CCW"===n.spindleControl&&(u*=-1));var d=n.joints,h=Kt[n.machine].limits.extents;return{machine:n.machine,responseToCameraGestures:!0,toolLength:r,toolDiameter:i,toolHolder:o,spindleAngle:u,toolOffsetZ:c,joints:d,limits:h,axes:"XYZAB",currentTime:e.interpreter.currentTime,currentLine:e.interpreter.currentLine,hideTitleBar:!e.ui.titleBar.visible,cameraParent:e.viewer3d.cameraParent,showModel:e.viewer3d.showModel,dentalAlignerMode:e.viewer3d.dentalAlignerMode,cameraMode:e.viewer3d.cameraMode,rotating:e.viewer3d.rotating,radius:e.viewer3d.radius,orthographicZoom:e.viewer3d.orthographicZoom,phi:e.viewer3d.phi,theta:e.viewer3d.theta,showViewCube:!0,smoothJointTransitions:!1,smoothModelTransition:!0,respondToCameraGestures:!0}}),(function(e,t){return{onUpdateDimensions:function(t,n){return e(B.viewer3d.setDimensions(t,n))},onCameraZoom:function(t){return e(B.viewer3d.cameraZoom(t))},onCameraStartRotating:function(){return e(B.viewer3d.cameraStartRotating())},onCameraStopRotating:function(){return e(B.viewer3d.cameraStopRotating())},onCameraRotate:function(t,n){return e(B.viewer3d.cameraRotate(t,n))},onCameraSetDirection:function(t,n,a){return e(B.viewer3d.cameraSetDirection(t,n,a))}}}))(rt),$t=n(77),Qt=n(752),en=n(753),tn=n(186),nn=n(748),an=function(e){Object(H.a)(n,e);var t=Object(X.a)(n);function n(){var e;Object(V.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleFileSelect=function(t){var n=e.props,a=n.onFileSelect,r=n.onRead;1===t.target.files.length&&(a&&a(t.target.files[0]),r&&e.readFile(t.target.files[0]),e.fileInput.value="")},e.handleFileOpen=function(t){e.fileInput.click()},e.readFile=function(t){var n=e.props,a=n.onRead,r=n.onFinished,i=n.onError,o=n.chunkSize,s=n.stopReading,c=n.binary,l=t.size,u=o||65536,d=0,h=null,p=function(e){null===e.target.error?(c?(a(e.target.result,Math.min(u,e.target.result.byteLength),l),d+=e.target.result.byteLength):(a(e.target.result,Math.min(u,e.target.result.length),l),d+=e.target.result.length),d>=l||s&&s()?r&&r():h(d,u)):i&&i(e.target.error)};(h=function(e,n){var a=new FileReader,r=t.slice(e,n+e);a.onload=p,c?a.readAsArrayBuffer(r):a.readAsText(r)})(d,u)},e}return Object(U.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=t.children,r=t.color,i=t.component,o=t.disabled,s=t.disableFocusRipple,c=t.disableRipple,l=t.fullWidth,u=t.href,d=t.mini,h=t.size,p=t.variant,m=t.buttonClasses,g=t.accept;return f.a.createElement("span",null,f.a.createElement(nn.a,{onClick:this.handleFileOpen,classes:m,component:i,color:r,disabled:o,disableFocusRipple:s,disableRipple:c,fullWidth:l,href:u,mini:d,size:h,variant:p},a),f.a.createElement("input",{onChange:this.handleFileSelect,ref:function(t){return e.fileInput=t},type:"file",accept:g,className:n.fileSelect}))}}]),n}(m.Component),rn=Object(nt.a)((function(e){return{fileSelect:{display:"none"}}}))(an),on=n(180),sn=n.n(on),cn=ee(),ln=function(e){Object(H.a)(n,e);var t=Object(X.a)(n);function n(){var e;Object(V.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleFileSelect=function(t){var n=e.props,a=n.onLoading,r=n.onSetFileName;e.fileSize=t.size,e.fileName=t.name,e.read=0,e.lines=[],e.buffer="",r&&r(t.name),cn.event("GCodeLoader","GCode File Size","GCode File Size",e.fileSize).send(),e.startTime=K()(),a&&a()},e.handleFinished=function(){var t=e.props.onFinished;e.stopReadingFile=!1,t&&t(),cn.timing("GCodeLoader","loaded gcode file",Math.round(K()()-e.startTime)).send()},e.handleRead=function(t,n){var a,r=e.props,i=r.onProgress,o=r.onLines,s=r.onError;e.read+=n;var c=Math.min(e.read/e.fileSize*100,100),l=(e.buffer+t).split("\n");e.buffer=l.pop(),(a=e.lines).push.apply(a,Object(Y.a)(l.map((function(e){return e.replace(/\r/,"")})))),s&&e.lines.length>2e6&&(e.stopReadingFile=!0,o(e.lines),s(new Error("GCode program exceeds 2 million lines. Program truncated to "+e.lines.length+" lines."))),i&&i(c),o&&(e.read===n?o(e.lines.slice(),!0):e.read>=e.fileSize&&(o(e.lines),cn.event("GCodeLoader","Lines In GCode Program","Lines In GCode Program",e.lines.length).send()))},e.stopReading=function(){return e.stopReadingFile},e}return Object(U.a)(n,[{key:"render",value:function(){return f.a.createElement(rn,{onFileSelect:this.handleFileSelect,onFinished:this.handleFinished,onRead:this.handleRead,stopReading:this.stopReading,chunkSize:65536,size:"small",accept:".ngc, .nc",color:"inherit"},f.a.createElement(sn.a,null)," GCode")}}]),n}(m.Component),un=Object(b.b)((function(e,t){return{machineState:e.machineState}}),(function(e,t){return{onSetFileName:function(t){return e(R.interpreter.setFileName(t))},onLoading:function(){return e(R.interpreter.startLoading())},onFinished:function(){return e(R.interpreter.endLoading())},onProgress:function(t){return e(R.interpreter.setLoadingProgress(t))},onLines:function(t,n){return e(R.interpreter.setLines(t,n))}}}))(ln),dn=function(e){Object(H.a)(n,e);var t=Object(X.a)(n);function n(){var e;Object(V.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleFileSelect=function(t){var n=e.props,a=n.binary,r=n.onLoading;e.fileSize=t.size,e.fileName=t.name,a?(e.read=0,e.buffer=""):(e.data=void 0,e.buffer=void 0,e.offset=0),r&&r()},e.handleFinished=function(){var t=e.props.onLoadModel;e.stopReadingFile=!1,t(e.buffer,e.fileName)},e.handleRead=function(t,n,a){var r=e.props,i=r.onProgress,o=r.onError;e.data||(e.buffer=new ArrayBuffer(a),e.data=new Uint8Array(e.buffer),e.offset=0);try{e.data.set(new Uint8Array(t),e.offset)}catch(c){o&&o(new Error("Error reading data chunk: "+c.message+", "+e.offset))}e.offset+=n;var s=Math.min(e.offset/e.fileSize*100,100);i&&i(s)},e.stopReading=function(){return e.stopReadingFile},e}return Object(U.a)(n,[{key:"render",value:function(){var e=this.props,t=e.iconOnly,n=e.labelOnly,a=e.variant,r=e.size,i=e.color,o=e.label,s=void 0===o?"Model":o;return f.a.createElement(rn,{onFileSelect:this.handleFileSelect,onFinished:this.handleFinished,onRead:this.handleRead,stopReading:this.stopReading,chunkSize:65536,binary:!0,size:r,color:i,accept:".obj,.stl",variant:a},n?null:f.a.createElement(sn.a,null)," ",t?null:s)}}]),n}(m.Component),hn=ee(),pn=Object(b.b)((function(e,t){return{}}),(function(e,t){return{onLoadModel:function(t,n){var a=tt.getInstance();if(n.toLowerCase().endsWith(".obj"))if(a){var r=K()(),i=new TextDecoder("utf-8");a.loadObjModel(i.decode(t));var o=K()();hn.timing("ModelLoader","load obj",Math.round(o-r)).send(),hn.event("ModelLoader","OBJ File Size","OBJ File Size",t.byteLength).send()}else console.error("viewer not loaded yet");else if(n.toLowerCase().endsWith(".stl"))if(a){var s=K()();a.loadSTLModel(t);var c=K()();hn.timing("ModelLoader","load stl",Math.round(c-s)).send(),hn.event("ModelLoader","STL File Size","STL File Size",t.byteLength).send()}else console.error("viewer not loaded yet");e(B.viewer3d.loadModel()),e(B.viewer3d.showModel())}}}))(dn),mn=n(751),fn=n(768);var gn,vn,bn,On,xn=function(e){var t=e.value,n=e.thickness;if(e.loading){var a=t.toFixed(2)+"%";return f.a.createElement(fn.a,{title:a},f.a.createElement(mn.a,{variant:"determinate",color:"inherit",value:t,thickness:n}))}return null},Sn=Object(b.b)((function(e,t){var n=0,a=3.6,r=!1;return e.interpreter.loading?(n=e.interpreter.loadingProgress,a=1,r=!0):e.interpreter.processing&&(n=e.interpreter.processingProgress,a=3.6,r=!0),{value:n,thickness:a,loading:r}}),(function(e,t){return{}}))(xn),yn=n.p+"static/media/pocketnc.de6b0d39.png",Mn=n(360),jn=n.n(Mn),wn=n(754),En=ee(),Tn=Object(nt.a)((function(e){return{videoPane:{width:900,height:500},appBar:{zIndex:e.zIndex.drawer+1,backgroundColor:"#333333"},title:{flex:1,color:"white",textDecoration:"none"},logo:{height:32,marginRight:10}}}))((function(e){var t=e.classes,n=e.hideButtons,a=e.title,r=Object(m.useState)(!1),i=Object($t.a)(r,2),o=i[0],s=i[1],c=Object(m.useCallback)((function(){return s(!0)}),[]),l=Object(m.useCallback)((function(){return s(!1)}),[]);return f.a.createElement(Qt.a,{className:t.appBar},f.a.createElement(en.a,null,f.a.createElement("a",{href:"https://www.pocketnc.com",target:"_blank",rel:"noopener noreferrer"},f.a.createElement("img",{src:yn,alt:"Pocket NC",className:t.logo,onClick:function(){return En.event("TitleBar","clicked link to pocketnc.com").send()}})),f.a.createElement(tn.a,{className:t.title},f.a.createElement("a",{href:"https://www.pocketnc.com",className:t.title,target:"_blank",rel:"noopener noreferrer",onClick:function(){return En.event("TitleBar","clicked link to pocketnc.com").send()}},a||"Pocket NC Simulator")),f.a.createElement(Sn,null),n?null:f.a.createElement(f.a.Fragment,null,f.a.createElement(un,{onError:function(e){return console.error(e)}}),f.a.createElement(pn,{size:"small",color:"inherit",onError:function(e){return console.error(e)}}),f.a.createElement(nn.a,{onClick:c,color:"inherit",size:"small"},f.a.createElement(jn.a,null)),f.a.createElement(wn.a,{open:o,onClose:l,maxWidth:"lg"},f.a.createElement("iframe",{title:"Pocket NC Simulator Tutorial",width:"800",height:"450",src:"https://www.youtube.com/embed/EQxXC_ySR7k",frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})))))})),Pn=n(770),An=n(765),kn=n(759),Cn=n(55),Gn=n.n(Cn),Ln=n(361),Rn=(n(656),n(657),n(658),n(763)),In=n(362),Nn=n.n(In),_n=(n(659),ee()),Dn=function(){var e=document.getElementsByClassName("ace_tooltip");if(e.length>0)for(var t=0;t<e.length;t++)document.body.appendChild(e[t])},Fn=function(e){Object(H.a)(n,e);var t=Object(X.a)(n);function n(){var e;Object(V.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleClick=function(t){var n=e.props.onSetCurrentLine,a=t.editor,r=a.getCursorPosition();a.getSelection().isEmpty()&&n(r.row)},e.handleChange=function(e){_n.event("Editor",e.action,e.action,e.lines.length).send()},e.handleDownload=function(){var t=e.props.fileName,n=e.editor.getValue(),a=document.createElement("a");a.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(n)),a.setAttribute("download",t),a.click()},e.handleFileNameChange=function(t){(0,e.props.onSetFileName)(t.target.value)},e.handleRef=function(t){e.container=t},e}return Object(U.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.gcode,a=t.annotations;this.editor=Ln.edit(this.container),this.editor.getSession().setMode("ace/mode/gcode"),this.editor.setTheme("ace/theme/chrome"),this.editor.$blockScrolling=1/0,this.editor.setShowPrintMargin(!1),this.editor.setOptions({readOnly:!0}),this.editor.session.on("changeScrollLeft",(function(t){0!==t&&e.editor.session.setScrollLeft(0)}));var r=this.editor.getSelection(),i=this.editor.getSession();r.on("changeCursor",(function(e,t,n){})),r.on("changeSelection",(function(e,t,n){}));var o=i.getDocument();o.setValue(""),o.insertFullLines(0,n),i.setAnnotations(a),o.on("change",this.handleChange),this.editor.on("guttermousemove",Dn),this.editor.on("click",this.handleClick)}},{key:"componentWillUnmount",value:function(){this.editor=null}},{key:"shouldComponentUpdate",value:function(e){var t=this.props,n=t.gcode,a=t.annotations,r=t.currentLine,i=t.currentTab,o=t.running,s=t.fileName,c=e.gcode,l=e.annotations,u=e.currentLine,d=e.currentTab,h=e.running;return s!==e.fileName||h!==o||d!==i||c!==n||r!==u||a!==l}},{key:"componentDidUpdate",value:function(e){var t=e.gcode,n=e.annotations,a=e.running,r=this.props,i=r.gcode,o=r.annotations,s=r.currentLine,c=r.running,l=r.setLines,u=this.editor.getSession(),d=u.getDocument();if(!a&&c&&i===t){for(var h=1;!u.getLine(u.getLength()-h);)h++;l(u.getLines(0,u.getLength()-h))}c?(this.editor.container.style.backgroundColor="#f3f3f3",this.editor.setOptions({readOnly:!0})):(this.editor.container.style.backgroundColor="#ffffff",this.editor.setOptions({readOnly:!1})),t!==i&&(d.off("change",this.handleChange),d.setValue(""),d.insertFullLines(0,i),d.on("change",this.handleChange)),n!==o&&u.setAnnotations(o),this.editor.gotoLine(s+1,1/0),this.editor.resize()}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.fileName,a=e.running;return f.a.createElement("div",{className:t.mainDiv},f.a.createElement("div",{ref:this.handleRef,className:t.container}),f.a.createElement("div",{className:t.gcodeTitleBar},f.a.createElement(Rn.a,{disabled:a,value:n,onChange:this.handleFileNameChange,style:{width:"calc(100% - 70px)"}})," ",f.a.createElement(nn.a,{size:"small",onClick:this.handleDownload},f.a.createElement(Nn.a,null))))}}]),n}(m.Component),zn=Object(nt.a)((function(e){return{mainDiv:{width:"100%",height:"100%"},container:{width:"100%",height:"calc(100% - 39px)"},gcodeTitleBar:{width:"100%",fontSize:"15px",borderTop:"1px solid #dddddd",color:"gray",paddingLeft:"5px"}}}))(Fn),Zn=n(149),Bn=n(755),Vn=n(718),Un=n(756),Hn=n(757),Xn=n(366),Yn=n.n(Xn),Wn=n(367),Kn=n.n(Wn),Jn=n(368),qn=n.n(Jn),$n=n(150),Qn=n(766),ea=function(e,t){return e*(t===Ue?25.4:1)},ta=function(e,t){return e*(t===Ue?1/25.4:1)},na=$n.a.div(gn||(gn=Object(Zn.a)(["\n  && {\n    padding-left: 8px\n  }\n"]))),aa=Object($n.a)(Yn.a)(vn||(vn=Object(Zn.a)(["\n  && {\n    color: #3f51b5;\n    width: 15px;\n  }"]))),ra=Object($n.a)(Kn.a)(bn||(bn=Object(Zn.a)(["\n  && {\n    color: #d4ba62;\n    width: 15px;\n  }"]))),ia=Object($n.a)(qn.a)(On||(On=Object(Zn.a)(["\n  && {\n    color: #ff0000;\n    width: 15px;\n  }"]))),oa=function(e){Object(H.a)(n,e);var t=Object(X.a)(n);function n(){var e;Object(V.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleSetToolLengthOffset=function(t,n,a){return function(r){var i=e.props.onSetTool;if("Enter"===r.key||"blur"===r.type){var o=ta(parseFloat(r.target.value),a);if(isNaN(o))r.target.value=n;else r.target.value=o,i({P:t,Z:o});r.target.blur(),r.preventDefault()}}},e.handleSetToolDiameter=function(t,n,a){return function(r){var i=e.props.onSetTool;if("Enter"===r.key||"blur"===r.type){var o=ta(parseFloat(r.target.value),a);if(isNaN(o))r.target.value=n;else r.target.value=o,i({P:t,R:.5*o});r.target.blur(),r.preventDefault()}}},e.handleSetToolHolder=function(t){return function(n){(0,e.props.onSetTool)({P:t,holder:n.target.value})}},e.handleSetG5xWorkOffset=function(t,n,a,r){return function(i){var o=e.props.onSetG5xWorkOffset;if("Enter"===i.key||"blur"===i.type){var s=ta(parseFloat(i.target.value),r);isNaN(s)?i.target.value=a:(i.target.value=s,o(t,n,s)),i.target.blur(),i.preventDefault()}}},e}return Object(U.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.lastSetUnitsMessage,a=t.initialUnits,r=t.numLines,i=t.approximateTime,o=t.maxLimitMessage,s=t.minLimitMessage,c=t.unimplementedMessages,l=t.nonSummarizedWarnings,u=t.nonSummarizedErrors,d=t.wcsChangedMessages,h=t.toolLengthOffsetMessages,p=t.running,m=t.classes,g=t.toolTable,v=a,b=[];if(n){var O="Encountered "+n.code+" on line "+(n.line+1)+". Setting units to "+("G20"===n.code?"inches":"millimeters")+".";v="G20"===n.code?Ve:Ue,b.push(f.a.createElement(Vn.a,{key:"lastSetUnitsMessage",className:m.li},f.a.createElement(Un.a,{className:m.liIcon},f.a.createElement(aa,null)),f.a.createElement(Hn.a,null,O)))}else{var x="No units set. Assuming "+(a===Ve?"inches":"millimeters")+".";b.push(f.a.createElement(Vn.a,{key:"noUnitsSet",className:m.li},f.a.createElement(Un.a,{className:m.liIcon},f.a.createElement(aa,null)),f.a.createElement(Hn.a,null,x)))}var S=[],y=[];for(var M in o){var j=o[M],w=M+" positive limit exceeded by maximum of "+j.amount.toFixed(4)+" on line "+(j.line+1)+".";"Z"===M&&(w+=" Try shortening your tool by at least "+j.amount.toFixed(4)+" inches."),S.push(f.a.createElement(Vn.a,{key:M+"maxlimit",className:m.li},f.a.createElement(Un.a,{className:m.liIcon},f.a.createElement(ia,null)),f.a.createElement(Hn.a,null,w)))}for(var E in s){var T=s[E],P=E+" negative limit exceeded by maximum of "+T.amount.toFixed(4)+" on line "+(T.line+1)+".";"Z"===E&&(P+=" Try extending your tool by at least "+T.amount.toFixed(4)+" inches."),S.push(f.a.createElement(Vn.a,{key:E+"minlimit",className:m.li},f.a.createElement(Un.a,{className:m.liIcon},f.a.createElement(ia,null)),f.a.createElement(Hn.a,null,P)))}var A=Math.floor(i/60/60),k=Math.floor(i/60)%60,C=Math.floor(i)%60,G=[];A>0&&G.push(A+" hour"+(1!==A?"s":"")),k>0&&G.push(k+" minute"+(1!==k?"s":"")),C>0&&G.push(C+" second"+(1!==C?"s":""));var L=null;if(c.length>0){var R={};c.forEach((function(e){R[e.code]=e.description}));var I=[];for(var N in R)I.push(f.a.createElement(Vn.a,{key:N,className:m.li},f.a.createElement(Un.a,{className:m.liIcon},f.a.createElement(ra,null)),f.a.createElement(Hn.a,null,N,"'s intended usage: ",R[N])));L=[f.a.createElement(Vn.a,{key:"unimplementedText",className:m.li},f.a.createElement(Un.a,{className:m.liIcon},f.a.createElement(ra,null)),f.a.createElement(Hn.a,null,"Found ",I.length," code",1!==I.length?"s":""," on ",c.length," line",1!==c.length?"s":""," that ",1!==I.length?"aren't":"isn't"," implemented in the simulator. A real Pocket NC's behavior may differ from what is shown. Check the intended usage of each code below.")),f.a.createElement(na,{key:"unimplementedCodes"},f.a.createElement(Bn.a,{dense:!0,disablePadding:!0,className:m.nested},I))]}var _=l.map((function(e,t){return f.a.createElement(Vn.a,{key:e.message+t,className:m.li},f.a.createElement(Un.a,{className:m.liIcon},f.a.createElement(ra,null)),f.a.createElement(Hn.a,null,"undefined"!==typeof e.line?"Warning on line "+(e.line+1)+": ":"",e.message))})),D=u.map((function(e,t){return f.a.createElement(Vn.a,{key:e.message+t,className:m.li},f.a.createElement(Un.a,{className:m.liIcon},f.a.createElement(ia,null)),f.a.createElement(Hn.a,null,"undefined"!==typeof e.line?"Error on line "+(e.line+1)+": ":"",e.message))})),F=[];if(h.length>0){var z={};for(var Z in h.forEach((function(e){z[e.toolNumber]={toolLengthOffset:e.toolLengthOffset,toolDiameter:e.toolDiameter,toolHolder:e.toolHolder}})),z){var B=parseInt(Z);F.push(f.a.createElement(Vn.a,{key:"usingTool"+Z,className:m.li},f.a.createElement(Un.a,{className:m.liIcon},f.a.createElement(aa,null)),f.a.createElement(Hn.a,null,"Using tool ",Z))),F.push(f.a.createElement(Vn.a,{key:"toolLengthOffset"+Z,className:m.li},f.a.createElement(Un.a,{className:m.liIcon},f.a.createElement(aa,null)),f.a.createElement(Hn.a,null,"Tool ",Z," Z offset ",f.a.createElement(Rn.a,{disabled:p||0===B,onBlur:this.handleSetToolLengthOffset(Z,z[Z].toolLengthOffset,v),onKeyPress:this.handleSetToolLengthOffset(Z,z[Z].toolLengthOffset,v),defaultValue:ea(z[Z].toolLengthOffset,v).toFixed(4)}),"."))),F.push(f.a.createElement(Vn.a,{key:"toolDiameter"+Z,className:m.li},f.a.createElement(Un.a,{className:m.liIcon},f.a.createElement(aa,null)),f.a.createElement(Hn.a,null,"Tool ",Z," Diameter ",f.a.createElement(Rn.a,{disabled:p||0===B,onBlur:this.handleSetToolDiameter(Z,z[Z].toolDiameter,v),onKeyPress:this.handleSetToolDiameter(Z,z[Z].toolDiameter,v),defaultValue:ea(z[Z].toolDiameter,v).toFixed(4)}),"."))),F.push(f.a.createElement(Vn.a,{key:"toolHolder"+Z,className:m.li},f.a.createElement(Un.a,{className:m.liIcon},f.a.createElement(aa,null)),f.a.createElement(Hn.a,null,"Tool ",Z," Holder",f.a.createElement(Qn.a,{disabled:p||0===B,checked:g[B].holder===ge,value:ge,name:"toolHolder"+Z,"aria-label":"Short Tool Holder",onChange:this.handleSetToolHolder(Z),color:"primary"})," Short",f.a.createElement(Qn.a,{disabled:p||0===B,checked:g[B].holder===fe,value:fe,name:"toolHolder"+Z,"aria-label":"Long Tool Holder",onChange:this.handleSetToolHolder(Z),color:"primary"})," Long")))}}var V=d.map((function(t){var n=t.wcs,a=t.code,r=t.workOffsets,i=t.labelOrder.map((function(t){return f.a.createElement("div",{key:t,className:m.axis},f.a.createElement("span",{className:m.axisLabel},t)," ",f.a.createElement(Rn.a,{disabled:p,onBlur:e.handleSetG5xWorkOffset(n,t,r[t],v),onKeyPress:e.handleSetG5xWorkOffset(n,t,r[t],v),defaultValue:ea(r[t],v).toFixed(4)}))}));return f.a.createElement(Vn.a,{key:"wcsChangd"+n,className:m.li},f.a.createElement(Un.a,{className:m.liIcon},f.a.createElement(aa,null)),f.a.createElement(Hn.a,null,a," Work Offsets",i))}));return f.a.createElement("div",{className:m.container},f.a.createElement(Bn.a,{dense:!0},y,S,D,_,L,f.a.createElement(Vn.a,{className:m.li},f.a.createElement(Un.a,{className:m.liIcon},f.a.createElement(aa,{fontSize:"inherit",color:"primary"})),f.a.createElement(Hn.a,null,r," lines")),f.a.createElement(Vn.a,{className:m.li},f.a.createElement(Un.a,{className:m.liIcon},f.a.createElement(aa,{fontSize:"inherit",color:"primary"})),f.a.createElement(Hn.a,null,"Approximately ",G.join(" ")," to run.")),b,F,V))}}]),n}(m.Component),sa=Object(nt.a)((function(e){return{axisLabel:{display:"inline-block"},axis:{lineHeight:"32px",verticalAlign:"middle"},container:{height:"100%",overflow:"scroll",marginLeft:10},nested:{paddingLeft:e.spacing(1)},li:{paddingLeft:"8px",paddingRight:"8px"},liIcon:{marginRight:0}}}))(oa),ca=n(51),la=function(e){return e.interpreter.messages},ua=Object(ca.a)([la],(function(e){return e.filter((function(e){return"undefined"!==typeof e.line})).map((function(e){return{row:e.line,column:0,text:e.message,type:e.severity}}))})),da=Object(ca.a)([la],(function(e){var t=e.filter((function(e){return e.type===bt})),n={};t.forEach((function(e){n[e.axis]||(n[e.axis]=[]),n[e.axis].push(e)}));var a={};for(var r in n)a[r]=n[r].reduce((function(e,t){return t.amount>e.amount?t:e}),n[r][0]);return a})),ha=Object(ca.a)([la],(function(e){var t=e.filter((function(e){return e.type===vt})),n={};t.forEach((function(e){n[e.axis]||(n[e.axis]=[]),n[e.axis].push(e)}));var a={};for(var r in n)a[r]=n[r].reduce((function(e,t){return t.amount>e.amount?t:e}),n[r][0]);return a})),pa=Object(ca.a)([la],(function(e){return e.filter((function(e){return e.type===gt}))})),ma=Object(ca.a)([la],(function(e){return e.filter((function(e){return e.severity===pt&&-1===[bt,vt].indexOf(e.type)}))})),fa=Object(ca.a)([la],(function(e){return e.filter((function(e){return e.severity===mt&&-1===[gt].indexOf(e.type)}))})),ga=Object(ca.a)([la],(function(e){return e.filter((function(e){return e.type===yt}))})),va=Object(ca.a)([la],(function(e){var t=e.filter((function(e){return e.type===yt}));if(t.length>0)return t[t.length-1]})),ba=Object(ca.a)([la],(function(e){return e.filter((function(e){return e.type===Ot}))})),Oa=Object(ca.a)([la],(function(e){return e.filter((function(e){return e.type===Ot}))})),xa=Object(ca.a)([la],(function(e){var t=e.filter((function(e){return e.type===St})).map((function(e){return e.wcs})),n={},a=[];return e.filter((function(e){return e.type===xt&&!t.includes(e.wcs)})).forEach((function(e){n[e.wcs]||(a.push(e),n[e.wcs]=!0)})),a})),Sa=p,ya=function(e){return e.alignerState},Ma=function(e){return e.interpreter},ja=function(e){return e.machineState},wa=function(e){return e.interpreter.lines},Ea=function(e){return e.interpreter.linesPerIndex},Ta=function(e){return e.interpreter.times[e.interpreter.times.length-1]},Pa=function(e){return e.interpreter.initialState.units},Aa=Object(ca.a)([Pa,Sa.lastSetUnitsMessage],(function(e,t){return t?"G21"===t.code?Ue:Ve:e})),ka=function(e){var t=e.tool;return t.table[t.loaded]},Ca=Object(b.b)((function(e,t){return{lastSetUnitsMessage:Sa.lastSetUnitsMessage(e),initialUnits:Pa(e),numLines:e.interpreter.lines.length,approximateTime:e.interpreter.times[e.interpreter.times.length-1],maxLimitMessage:Sa.maxLimitMessage(e),minLimitMessage:Sa.minLimitMessage(e),unimplementedMessages:Sa.unimplementedMessages(e),nonSummarizedWarnings:Sa.nonSummarizedWarnings(e),nonSummarizedErrors:Sa.nonSummarizedErrors(e),wcsChangedMessages:Sa.wcsChangedMessages(e),toolLengthOffsetMessages:Sa.setToolLengthOffsetMessages(e),running:e.interpreter.running,toolTable:e.machineState.tool.table}}),(function(e,t){return{onSetTool:function(t){return e(B.machineState.tool.table.setTool(t))},onSetG5xWorkOffset:function(t,n,a){return e(B.machineState.motion.g5x.setG5xWorkOffset({index:t,axis:n,value:a}))}}}))(sa),Ga=ee();var La=Object(nt.a)((function(e){return{summary:{padding:"10px"},hidden:{display:"none"},toolbar:e.mixins.toolbar,tabNoTitleBar:{height:"100%",width:"100%"},tab:{height:"calc(100% - 112px)",width:"100%"},paper:{}}}))((function(e){var t=e.classes,n=e.width,a=e.visible,r=e.currentLine,i=e.annotations,o=e.onScroll,s=e.onTabChange,c=e.onSetCurrentLine,l=e.currentTab,u=e.running,d=e.gcode,h=e.setLines,p=e.hideTitleBar,m=e.fileName,g=e.onSetFileName;return f.a.createElement(Pn.a,{variant:"persistent",open:a,PaperProps:{style:{width:n,height:"100vh"}},classes:{paper:t.paper}},p?null:f.a.createElement("div",{className:t.toolbar}),f.a.createElement(Qt.a,{position:"static",color:"default"},f.a.createElement(An.a,{value:l,onChange:s,indicatorColor:"primary",textColor:"primary"},f.a.createElement(kn.a,{label:"GCode",onClick:function(){return Ga.event("GCodePane","clicked gcode tab").send()}}),f.a.createElement(kn.a,{label:"Summary",onClick:function(){return Ga.event("GCodePane","clicked summary tab").send()}}))),f.a.createElement("div",{className:Gn()(p?t.tabNoTitleBar:t.tab,{[t.hidden]:0!==l})},f.a.createElement(zn,{gcode:d,annotations:i,currentLine:r,onScroll:o,currentTab:l,running:u,setLines:h,fileName:m,onSetCurrentLine:c,onSetFileName:g})),f.a.createElement("div",{className:Gn()(t.tab,{[t.hidden]:1!==l})},f.a.createElement(Ca,null)))})),Ra=Object(b.b)((function(e,t){var n=e.ui.gcodePane,a=e.interpreter.lines;return{width:n.width,visible:n.visible,annotations:Sa.annotations(e),currentLine:e.interpreter.currentLine,gcode:a,currentTab:n.currentTab,running:e.interpreter.running,hideTitleBar:!e.ui.titleBar.visible,fileName:e.interpreter.fileName}}),(function(e,t){return{onScroll:function(t){return e(B.ui.gcodePane.scroll(t))},onTabChange:function(t,n){return e(B.ui.gcodePane.setTab(n))},setLines:function(t){return e(B.interpreter.setLines(t))},onSetCurrentLine:function(t){return e(B.interpreter.setCurrentLine(t))},onSetFileName:function(t){return e(B.interpreter.setFileName(t))}}}))(La),Ia=function(e){Object(H.a)(n,e);var t=Object(X.a)(n);function n(){var e;Object(V.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleMouseUp=function(t){e.dragging=!1},e.handleMouseDown=function(t){t.preventDefault(),e.dragging=!0},e.handleMouseMove=function(t){var n=e.props.onDrag;e.dragging&&n&&(t.preventDefault(),n(Math.min(Math.max(t.pageX,0),window.innerWidth)))},e}return Object(U.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("mousemove",this.handleMouseMove),window.addEventListener("mouseup",this.handleMouseUp)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.left,a=e.width;return f.a.createElement("div",{className:t.divider,style:{left:n-.5*a,width:a},onMouseDown:this.handleMouseDown})}}]),n}(m.Component),Na=Object(nt.a)((function(e){return{divider:{position:"absolute",height:"100%",zIndex:e.zIndex.drawer+1,cursor:"col-resize"}}}))(Ia),_a=Object(b.b)((function(e,t){return{left:e.ui.gcodePane.width}}),(function(e,t){return{onDrag:function(t){return e(_.ui.gcodePane.setWidth(t))}}}))(Na),Da=n(392),Fa=n(758),za=n(240),Za=n(371),Ba=n.n(Za),Va=n(377),Ua=n.n(Va),Ha=n(372),Xa=n.n(Ha),Ya=n(373),Wa=n.n(Ya),Ka=n(376),Ja=n.n(Ka),qa=n(374),$a=n.n(qa),Qa=n(375),er=n.n(Qa),tr=n(378),nr=n.n(tr),ar=function(e,t,n){return n=n||"0",(e+="").length>=t?e:new Array(t-e.length+1).join(n)+e},rr=ee(),ir=500,or=function(e){Object(H.a)(n,e);var t=Object(X.a)(n);function n(){var e;Object(V.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleMouseMove=function(t){var n=e.props,a=n.visible,r=n.onShow,i=n.onHide,o=n.visibleTimeout;t.buttons&&!e.clickedInOverlay||(!a&&r&&r(),i&&!e.over&&(e.timeout&&window.clearTimeout(e.timeout),e.timeout=setTimeout((function(){i()}),o||2e3)))},e.handleMouseOver=function(){e.over=!0,e.timeout&&(window.clearTimeout(e.timeout),e.timeout=null)},e.handleMouseOut=function(){e.over=!1;var t=e.props,n=t.onHide,a=t.visibleTimeout;n&&(e.timeout&&window.clearTimeout(e.timeout),e.timeout=setTimeout((function(){n()}),a||2e3))},e.handleMouseDown=function(){e.clickedInOverlay=!0},e.handleMouseUp=function(){e.clickedInOverlay=!1},e.handlePlay=function(t){var n=e.props.onPlay;rr.event("ControlsOverlay","clicked play").send(),n&&n(t)},e.handlePause=function(t){var n=e.props.onPause;rr.event("ControlsOverlay","clicked pause").send(),n&&n(t)},e.handleRun=function(t){var n=e.props.onRun;rr.event("ControlsOverlay","clicked run").send(),n&&n(t)},e.handlePrevious=function(t){var n=e.props.onPrevious;rr.event("ControlsOverlay","clicked previous").send(),n&&n(t)},e.handleNext=function(t){var n=e.props.onNext;rr.event("ControlsOverlay","clicked next").send(),n&&n(t)},e.handleStop=function(t){var n=e.props.onStop;rr.event("ControlsOverlay","clicked stop").send(),n&&n(t)},e.handleTogglePane=function(t){var n=e.props,a=n.onTogglePane;n.gcodePaneVisible?rr.event("ControlsOverlay","clicked hide gcode pane").send():rr.event("ControlsOverlay","clicked show gcode pane").send(),a&&a(t)},e}return Object(U.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("mousemove",this.handleMouseMove),window.addEventListener("mouseup",this.handleMouseUp)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.visible,a=e.paused,r=e.running,i=e.loadedValue,o=e.value,s=e.timeMultiplierValue,c=e.currentTime,l=e.fadeTime,u=e.onSlider,d=e.onTimeSlider,h=Math.floor(c)%60,p=Math.floor(c/60)%60,m=Math.floor(c/60/60),g=ar(m,2)+":"+ar(p,2)+":"+ar(h,2),v=Math.log(s+1)/Math.log(1001);return f.a.createElement(Da.a,{in:n,timeout:l||500},f.a.createElement("div",{className:t.overlay,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onMouseDown:this.handleMouseDown},f.a.createElement("div",null,f.a.createElement("div",{className:t.left},f.a.createElement(fn.a,{title:"Toggle GCode Pane",enterDelay:ir,placement:"top",disableFocusListener:!0},f.a.createElement(Fa.a,{onClick:this.handleTogglePane},f.a.createElement(Ba.a,{className:t.button})))),f.a.createElement("div",{className:t.center},f.a.createElement(fn.a,{title:"Previous Line",enterDelay:ir,placement:"top",disableFocusListener:!0},f.a.createElement(Fa.a,{onClick:this.handlePrevious},f.a.createElement(Xa.a,{className:t.button}))),r?a?f.a.createElement(fn.a,{title:"Play",enterDelay:ir,placement:"top",disableFocusListener:!0},f.a.createElement(Fa.a,{onClick:this.handlePlay},f.a.createElement(Wa.a,{className:t.button}))):f.a.createElement(fn.a,{title:"Pause",enterDelay:ir,placement:"top",disableFocusListener:!0},f.a.createElement(Fa.a,{onClick:this.handlePause},f.a.createElement($a.a,{className:t.button}))):null,r?f.a.createElement(fn.a,{title:"Stop Program",enterDelay:ir,placement:"top",disableFocusListener:!0},f.a.createElement(Fa.a,{onClick:this.handleStop},f.a.createElement(er.a,{className:t.button}))):f.a.createElement(fn.a,{title:"Run Program",enterDelay:ir,placement:"top",disableFocusListener:!0},f.a.createElement(Fa.a,{onClick:this.handleRun},f.a.createElement(Ja.a,{className:t.button}))),f.a.createElement(fn.a,{title:"Next Line",enterDelay:ir,placement:"top",disableFocusListener:!0},f.a.createElement(Fa.a,{onClick:this.handleNext},f.a.createElement(Ua.a,{className:t.button})))),f.a.createElement("div",{className:t.right},f.a.createElement("div",{className:t.timeSliderContainer},f.a.createElement(za.a,{min:0,max:1,value:v,trackValue:1,onChange:function(e,t){return d(Math.pow(1001,t)-1)}})),f.a.createElement("div",{className:t.timeIconContainer},f.a.createElement(fn.a,{title:"Time Scale",enterDelay:ir,placement:"top",disableFocusListener:!0},f.a.createElement(nr.a,{onClick:function(e){rr.event("ControlsOverlay","clicked reset time scale").send(),d(1)},className:t.timeIcon})),f.a.createElement("span",{className:t.timeMultiplierLabel},s.toFixed(2))))),f.a.createElement("br",{className:t.break}),f.a.createElement("div",{className:t.sliderControls},f.a.createElement("div",{className:t.sliderTime},g),f.a.createElement("div",{className:t.sliderContainer},f.a.createElement(za.a,{value:o,trackValue:i,onChange:function(e,t){return u(t)}})))))}}]),n}(m.Component),sr=Object(nt.a)((function(e){return{toolbar:e.mixins.toolbar,overlay:{zIndex:e.zIndex.drawer+3,position:"absolute",left:0,bottom:20,right:0,marginLeft:"auto",marginRight:"auto",width:"670px",maxWidth:"100%",textAlign:"center",verticalAlign:"middle",backgroundColor:"rgba(100,100,100,.75)",borderRadius:5,color:"white"},button:{color:"#dddddd"},left:{float:"left",width:"33.333%",textAlign:"left"},center:{float:"left",width:"33.333%",textAlign:"center"},right:{float:"left",width:"33.333%",marginBottom:0,textAlign:"right"},break:{lineHeight:0,clear:"both"},sliderTime:{float:"left",width:50,marginLeft:15,fontSize:10,lineHeight:"32px",verticalAlign:"middle"},sliderContainer:{float:"left",width:"calc(100% - 95px)",marginLeft:15,marginRight:15},timeSliderContainer:{width:"calc(100% - 100px)",float:"right",marginRight:15},timeIconContainer:{float:"right",lineHeight:"32px",cursor:"pointer"},timeIcon:{color:"#dddddd",verticalAlign:"middle"},timeMultiplierLabel:{fontSize:"10px",marginRight:5}}}))(or),cr=Object(b.b)((function(e,t){return{visible:e.ui.controlsOverlay.visible,gcodePaneVisible:e.ui.gcodePane.visible,loadedValue:e.interpreter.processingProgress,value:e.interpreter.totalTime>0?e.interpreter.currentTime/e.interpreter.totalTime*100:0,currentTime:e.interpreter.currentTime,paused:e.interpreter.paused,running:e.interpreter.running,timeMultiplierValue:e.interpreter.timeMultiplier}}),(function(e,t){return{onShow:function(){return e(B.ui.controlsOverlay.setVisible(!0))},onHide:function(){return e(B.ui.controlsOverlay.setVisible(!1))},onTogglePane:function(){return e(B.ui.gcodePane.togglePane())},onHome:function(){return e(B.ui.controlsOverlay.home())},onShuffle:function(){return e(B.ui.controlsOverlay.shuffle())},onPrevious:function(){return e(B.interpreter.previousLine())},onPlay:function(){return e(B.interpreter.unpause())},onRun:function(){return e(B.interpreter.run())},onStop:function(){return e(B.interpreter.stop())},onPause:function(){return e(B.interpreter.pause())},onNext:function(){return e(B.interpreter.nextLine())},onSlider:function(t){return e(B.interpreter.setCurrentLineWithPercentage(t))},onTimeSlider:function(t){return e(B.interpreter.setTimeMultiplier(t))}}}))(sr),lr=n(388),ur=n(760),dr=n(761),hr=n(380),pr=n.n(hr),mr=n(379),fr=n.n(mr),gr=n(389),vr=n(762),br=ee(),Or=function(e){Object(H.a)(n,e);var t=Object(X.a)(n);function n(){var e;return Object(V.a)(this,n),(e=t.call(this)).handleClickOutOfMenu=function(){e.setState({parentMenuOpen:!1,perspectiveMenuOpen:!1})},e.handleMouseOver=function(){e.setState({active:!0})},e.handleMouseOut=function(){e.setState({active:!1})},e.toggleParentMenu=function(t){var n;e.setState((n=t.currentTarget,function(e){return{parentMenuOpen:!e.parentMenuOpen,parentAnchorEl:n}}))},e.togglePerspectiveMenu=function(t){var n;e.setState((n=t.currentTarget,function(e){return{perspectiveMenuOpen:!e.perspectiveMenuOpen,perspectiveAnchorEl:n}}))},e.handlePerspective=function(){var t=e.props.setPerspective;e.setState({perspectiveMenuOpen:!1}),br.event("CameraButtons","set perspective").send(),t()},e.handleOrthographic=function(){var t=e.props.setOrthographic;e.setState({perspectiveMenuOpen:!1}),br.event("CameraButtons","set orthographic").send(),t()},e.handleParentCamera=function(t){var n=e.props.parentCamera;br.event("CameraButtons","parent camera to "+t).send(),n(t),e.setState({parentMenuOpen:!1})},e.state={parentMenuOpen:!1,perspectiveMenuOpen:!1,active:!1,parentAnchorEl:null,perspectiveAnchorEl:null},e}return Object(U.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=t.hideTitleBar,r=t.showDentalFixture,i=this.state,o=i.parentMenuOpen,s=i.perspectiveMenuOpen,c=i.active,l=i.parentAnchorEl,u=i.perspectiveAnchorEl;return f.a.createElement("div",{className:a?n.cameraButtonsNoTitleBar:n.cameraButtons},f.a.createElement(dr.a,{className:Gn()(n.button,{[n.active]:c}),onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onClick:this.toggleParentMenu},f.a.createElement(fr.a,null)),f.a.createElement("br",null),f.a.createElement(dr.a,{className:Gn()(n.button,n.marginTop,{[n.active]:c}),onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onClick:this.togglePerspectiveMenu},f.a.createElement(pr.a,null)),f.a.createElement("br",null),f.a.createElement(gr.a,{open:o,anchorEl:l,onClose:this.handleClickOutOfMenu},f.a.createElement(vr.a,{onClick:function(){return e.handleParentCamera(xe)}},"Base"),f.a.createElement(vr.a,{onClick:function(){return e.handleParentCamera(Me)}},"Y"),f.a.createElement(vr.a,{onClick:function(){return e.handleParentCamera(ye)}},"A"),f.a.createElement(vr.a,{onClick:function(){return e.handleParentCamera(Se)}},"B"),f.a.createElement(vr.a,{onClick:function(){return e.handleParentCamera(je)}},"Tool"),r?f.a.createElement(vr.a,{onClick:function(){return e.handleParentCamera(we)}},"Dental Fixture"):null),f.a.createElement(gr.a,{open:s,anchorEl:u,onClose:this.handleClickOutOfMenu},f.a.createElement(vr.a,{onClick:function(){return e.handlePerspective()}},"Perspective"),f.a.createElement(vr.a,{onClick:function(){return e.handleOrthographic()}},"Orthographic")))}}]),n}(m.Component),xr=Object(nt.a)((function(e){return{button:{width:"30px",height:"30px",minHeight:"30px",opacity:.25,transition:"opacity .5s"},extendedButton:{width:"110px",height:"30px",minHeight:"30px",opacity:.25,transition:"opacity .5s",textTransform:"none"},marginLeft:{marginLeft:"10px"},active:{opacity:1},marginTop:{marginTop:"5px"},cameraButtonsNoTitleBar:{position:"absolute",right:"20px",top:"20px",textAlign:"right"},cameraButtons:{position:"absolute",right:"20px",top:"85px",textAlign:"right"}}}))(Or),Sr=Object(b.b)((function(e,t){return{hideTitleBar:!e.ui.titleBar.visible}}),(function(e,t){return{parentCamera:function(t){return e(B.viewer3d.parentCamera(t))},setPerspective:function(){return e(B.viewer3d.setPerspective())},setOrthographic:function(){return e(B.viewer3d.setOrthographic())}}}))(xr),yr=n(381),Mr=n.n(yr),jr=n(382),wr=n.n(jr),Er=Object(nt.a)((function(e){return{droNoTitleBar:{borderRadius:10,padding:"10px",backgroundColor:"rgba(100,100,100,.75)",color:"white",marginTop:10,textAlign:"right"},dro:{borderRadius:10,padding:"10px",backgroundColor:"rgba(100,100,100,.75)",color:"white",marginTop:10,textAlign:"right"},pre:{padding:0,margin:0}}}))((function(e){var t=e.classes,n=e.hideTitleBar,a=e.X,r=e.Y,i=e.Z,o=e.A,s=e.B;return f.a.createElement("div",{className:n?t.droNoTitleBar:t.dro},f.a.createElement("pre",{className:t.pre},"X: ",a,f.a.createElement("br",null),"Y: ",r,f.a.createElement("br",null),"Z: ",i,f.a.createElement("br",null),"A: ",o,f.a.createElement("br",null),"B: ",s))})),Tr=Object(b.b)((function(e,t){var n=e.machineState.motion.position,a=Aa(e);return{hideTitleBar:!e.ui.titleBar.visible,X:ea(n.X,a).toFixed(4).padStart(8," "),Y:ea(n.Y,a).toFixed(4).padStart(8," "),Z:ea(n.Z,a).toFixed(4).padStart(8," "),A:n.A.toFixed(4).padStart(8," "),B:n.B.toFixed(4).padStart(8," ")}}),(function(e,t){return{}}))(Er),Pr=function(e){Object(H.a)(n,e);var t=Object(X.a)(n);function n(){var e;return Object(V.a)(this,n),(e=t.call(this)).handleMouseOver=function(){e.setState({active:!0})},e.handleMouseOut=function(){e.setState({active:!1})},e.handleToggleModel=function(){var t=e.props,n=t.modelShown,a=t.showModel,r=t.hideModel;n?r():a()},e.state={active:!1},e}return Object(U.a)(n,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.hideTitleBar,a=e.modelShown,r=e.modelLoaded,i=this.state.active;return f.a.createElement("div",{className:n?t.otherButtonsNoTitleBar:t.otherButtons},r?f.a.createElement(nn.a,{variant:"extendedFab",className:Gn()(t.extendedButton,t.marginTop,{[t.active]:i}),onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onClick:this.handleToggleModel},"Model ",a?f.a.createElement(Mr.a,{className:t.marginLeft}):f.a.createElement(wr.a,{className:t.marginLeft})):null,f.a.createElement(Tr,null))}}]),n}(m.Component),Ar=Object(nt.a)((function(e){return{button:{width:"30px",height:"30px",minHeight:"30px",opacity:.25,transition:"opacity .5s"},extendedButton:{width:"110px",height:"30px",minHeight:"30px",opacity:.25,transition:"opacity .5s",textTransform:"none"},marginLeft:{marginLeft:"10px"},active:{opacity:1},marginTop:{marginTop:"5px"},otherButtonsNoTitleBar:{position:"absolute",right:"20px",top:"180px",textAlign:"right"},otherButtons:{position:"absolute",right:"20px",top:"160px",textAlign:"right"}}}))(Pr),kr=Object(b.b)((function(e,t){return{hideTitleBar:!e.ui.titleBar.visible,modelShown:e.viewer3d.showModel,modelLoaded:e.viewer3d.modelLoaded}}),(function(e,t){return{showModel:function(){return e(B.viewer3d.showModel())},hideModel:function(){return e(B.viewer3d.hideModel())}}}))(Ar),Cr=Object(lr.a)({typography:{useNextVariants:!0}}),Gr=Object(nt.a)((function(e){return{container:{position:"relative",width:"100vw",height:"100vh",overflow:"hidden"},machinePane:{position:"fixed",right:10,bottom:0},topSpacing:{marginTop:"10px"}}}))((function(e){var t=e.classes,n=e.hideTitleBar,a=e.machine,r=e.onChangeMachine,i=e.running;return f.a.createElement(ur.a,{theme:Cr},f.a.createElement("div",{className:t.container},n?null:f.a.createElement(Tn,null),f.a.createElement(Ra,null),f.a.createElement(Sr,null),f.a.createElement(kr,null),f.a.createElement(_a,{width:5}),f.a.createElement(cr,null),f.a.createElement(qt,null),f.a.createElement("div",{className:t.machinePane},f.a.createElement(Qn.a,{value:"V2-10",name:"V2-10",color:"default",disabled:i,checked:a===be,onClick:function(){return r(be)}})," V2-10",f.a.createElement("br",null),f.a.createElement(Qn.a,{value:"V2-50",name:"V2-50",color:"default",disabled:i,checked:a===Oe,onClick:function(){return r(Oe)}})," V2-50",f.a.createElement("br",null))))})),Lr=Object(b.b)((function(e,t){return{hideTitleBar:!e.ui.titleBar.visible,machine:e.machineState.machine,running:e.interpreter.running}}),(function(e,t){return{onChangeMachine:function(t){e(B.machineState.machine.set(t))}}}))(Gr),Rr=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ir(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var Nr=n(386),_r=n(36),Dr=function(){function e(){Object(V.a)(this,e),this.windows=[]}return Object(U.a)(e,[{key:"addWindow",value:function(e,t){console.log("added window",t),this.windows.push({window:e,origin:t}),e.postMessage({type:"IFRAME/INITIALIZE"},t)}},{key:"sendMessage",value:function(e){this.windows.forEach((function(t){var n=t.window,a=t.origin;console.log("sending message to window with origin",a),n.postMessage(e,a)}))}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),Fr=n(46),zr=n(90),Zr=n(183),Br=n(767),Vr=n(769),Ur="OFF",Hr="RAPID",Xr="LINEAR",Yr="ARC_CW",Wr="ARC_CCW",Kr=function(e,t,n,a,r){r||(r=1);var i,o,s,c,l,u=e.X,d=e.Y,h=e.Z,p=t.I,m=t.J,f=t.K,g=t.X,v=t.Y,b=t.Z;switch(n){case _e:i=u-p,o=d-m,s=g-p,c=v-m,l=b-h;break;case De:i=h-f,o=u-p,s=b-f,c=g-p,l=v-d;break;case Fe:i=-(h-f),o=d-m,s=-(b-f),c=v-m,l=g-u}var O=Math.sqrt(i*i+o*o),x=Math.atan2(o,i);x<0&&(x+=2*Math.PI);var S,y=Math.atan2(c,s);y<0&&(y+=2*Math.PI),a===Yr?(S=y-x)>$e?S=-(2*Math.PI-S):S<$e&&S>-$e&&(S-=2*Math.PI*r):(S=y-x)<-$e?S=2*Math.PI+S:S>-$e&&S<$e&&(S+=2*Math.PI*r);var M=l,j=S*O;return Math.sqrt(M*M+j*j)},Jr=function(e,t,n,a,r,i){switch(e){case Hr:case Xr:return function(e,t,n){return{X:e.X*(1-n)+t.X*n,Y:e.Y*(1-n)+t.Y*n,Z:e.Z*(1-n)+t.Z*n,A:e.A*(1-n)+t.A*n,B:e.B*(1-n)+t.B*n,C:e.C*(1-n)+t.C*n}}(t,n,a);case Ur:return n;case Yr:case Wr:return function(e,t,n,a,r,i){i||(i=1);var o,s,c,l,u=e.X,d=e.Y,h=e.Z,p=t.I,m=t.J,f=t.K,g=t.X,v=t.Y,b=t.Z;switch(a){case _e:o=u-p,s=d-m,c=g-p,l=v-m;break;case De:o=h-f,s=u-p,c=b-f,l=g-p;break;case Fe:o=-(h-f),s=d-m,c=-(b-f),l=v-m}var O=Math.atan2(s,o);O<0&&(O+=2*Math.PI);var x,S=Math.atan2(l,c);S<0&&(S+=2*Math.PI),r===Yr?(x=S-O)>$e?x=-(2*Math.PI-x):x<$e&&x>-$e&&(x-=2*Math.PI*i):(x=S-O)<-$e?x=2*Math.PI+x:x>-$e&&x<$e&&(x+=2*Math.PI*i),x*=n;var y,M,j,w=Math.cos(x),E=Math.sin(x);switch(a){case _e:y=p+(u-p)*w-(d-m)*E,M=m+(u-p)*E+(d-m)*w,j=h*(1-n)+b*n;break;case De:y=p+(u-p)*w+(h-f)*E,M=d*(1-n)+v*n,j=f-(u-p)*E+(h-f)*w;break;case Fe:y=u*(1-n)+g*n,M=m+(d-m)*w-(h-f)*E,j=f+(d-m)*E+(h-f)*w}return{X:y,Y:M,Z:j,A:e.A*(1-n)+t.A*n,B:e.B*(1-n)+t.B*n}}(t,n,a,r,e,i);default:return console.error(e," motion mode not implemented, jumping to final position."),n}},qr=Object(Br.a)({[y.machineState.feedRateMode.setInverseTime]:function(){return Ge},[y.machineState.feedRateMode.setUnitsPerMinute]:function(){return Le},[y.machineState.feedRateMode.setUnitsPerRevolution]:function(){return Re}},Le),$r=Object(Br.a)({[M.machineState.feedRate.set]:function(e,t){return t.payload}},0),Qr=Object(Br.a)({[P.machineState.planeSelect.setXY]:function(){return _e},[P.machineState.planeSelect.setZX]:function(){return De},[P.machineState.planeSelect.setYZ]:function(){return Fe},[P.machineState.planeSelect.setUV]:function(){return ze},[P.machineState.planeSelect.setWU]:function(){return Ze},[P.machineState.planeSelect.setVW]:function(){return Be}},_e),ei=Object(Br.a)({[j.machineState.units.setIn]:function(){return Ve},[j.machineState.units.setMm]:function(){return Ue}},Ve),ti={Z:0,R:0,holder:ve},ni=Object(Br.a)({[C.machineState.tool.set]:function(e,t){return t.payload>=0?Object(O.a)(Object(O.a)({},e),{},{set:t.payload}):e},[C.machineState.tool.change]:function(e,t){return Object(O.a)(Object(O.a)({},e),{},{loaded:e.set})},[C.machineState.tool.setToolLengthOffset]:function(e,t){var n=t.payload.H,a=e.loaded;void 0!==n&&0!==n&&(a=n);var r=e.table[a];return Object(O.a)(Object(O.a)({},e),{},{toolLengthOffset:r})},[C.machineState.tool.clearToolLengthOffset]:function(e,t){return Object(O.a)(Object(O.a)({},e),{},{toolLengthOffset:ti})},[C.machineState.tool.table.setTool]:function(e,t){var n=t.payload,a=n.P,r={X:n.X,Y:n.Y,Z:n.Z,A:n.A,B:n.B,C:n.C,U:n.U,V:n.V,W:n.W,R:n.R,I:n.I,J:n.J,Q:n.Q,holder:n.holder};for(var i in r)void 0===r[i]&&delete r[i];var o=Object(Y.a)(e.table);return a>0&&(o[a]=Object(O.a)(Object(O.a)({},o[a]),r)),Object(O.a)(Object(O.a)({},e),{},{table:o})}},{set:0,loaded:0,toolLengthOffset:ti,table:[{Z:0,R:0,holder:ve},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe},{Z:-3,R:.0625,holder:fe}]}),ai=Object(Br.a)({[w.machineState.kinematicsMode.setFiveAxis]:function(){return Ie},[w.machineState.kinematicsMode.setTrivial]:function(){return Ne}},Ne),ri=Object(Br.a)({[E.machineState.cutterCompensation.off]:void 0},He),ii=Object(Br.a)({[k.machineState.spindleSpeed.set]:function(e,t){return t.payload}},0),oi=Object(Br.a)({[A.machineState.spindleControl.off]:function(){return Jt},[A.machineState.spindleControl.ccw]:function(){return"CCW"},[A.machineState.spindleControl.cw]:function(){return"CW"}},Jt),si=Object(Br.a)({[G.machineState.machine.set]:function(e,t){return t.payload}},be),ci=n(7),li={mode:Ur,distanceMode:Pe,arcDistanceMode:Ce,turns:0,issuedMotionCommand:!1,position:{X:0,Y:1.5,Z:0,A:0,B:0,C:0,I:0,J:0,K:0},g5x:{index:1,offsets:[{X:0,Y:0,Z:0,A:0,B:0,C:0},{X:0,Y:0,Z:0,A:0,B:0,C:0},{X:0,Y:0,Z:0,A:0,B:0,C:0},{X:0,Y:0,Z:0,A:0,B:0,C:0},{X:0,Y:0,Z:0,A:0,B:0,C:0},{X:0,Y:0,Z:0,A:0,B:0,C:0},{X:0,Y:0,Z:0,A:0,B:0,C:0},{X:0,Y:0,Z:0,A:0,B:0,C:0},{X:0,Y:0,Z:0,A:0,B:0,C:0},{X:0,Y:0,Z:0,A:0,B:0,C:0}]}},ui=function(e,t){var n=e.position,a=t.payload,r=a.X,i=a.Y,o=a.Z,s=a.A,c=a.B,l=a.C,u=a.I,d=a.J,h=a.K,p=a.units,m=a.G53,f=e.distanceMode,g=e.arcDistanceMode,v=e.g5x.offsets[e.g5x.index],b={X:r,Y:i,Z:o,A:s,B:c,C:l};for(var x in b)void 0===b[x]?delete b[x]:p!==Ue||"X"!==x&&"Y"!==x&&"Z"!==x||(b[x]=b[x]/25.4);var S={I:u,J:d,K:h};for(var y in S)void 0===S[y]?S[y]=0:p===Ue&&(S[y]=S[y]/25.4);var M=e.position;if(!m)if(f===Pe){var j={};for(var w in b)j[w]=b[w]+v[w];M=Object(O.a)(Object(O.a)({},e.position),j)}else for(var E in M=Object(O.a)({},M),b)M[E]=n[E]+b[E];if(g===ke)M=Object(O.a)(Object(O.a)({},e.position),S);else{var T={I:"X",J:"Y",K:"Z"};for(var P in M=Object(O.a)({},M),S)M[P]=n[T[P]]+S[P]}return M},di=Object(Br.a)({[L.machineState.distanceMode.setAbsolute]:function(e,t){return Object(O.a)(Object(O.a)({},e),{},{distanceMode:Pe})},[L.machineState.distanceMode.setIncremental]:function(e,t){return Object(O.a)(Object(O.a)({},e),{},{distanceMode:Ae})},[L.machineState.motion.nonMotionCommand]:function(e,t){return Object(O.a)(Object(O.a)({},e),{},{issuedMotionCommand:!1})},[L.machineState.motion.off]:function(e,t){return Object(O.a)(Object(O.a)({},e),{},{mode:Ur})},[L.machineState.motion.rapid]:function(e,t){var n=ui(e,t);return Object(O.a)(Object(O.a)({},e),{},{position:n,issuedMotionCommand:!0,mode:Hr})},[L.machineState.motion.linear]:function(e,t){var n=ui(e,t);return Object(O.a)(Object(O.a)({},e),{},{position:n,issuedMotionCommand:!0,mode:Xr})},[L.machineState.motion.arcCW]:function(e,t){var n=t.payload.P,a=ui(e,t);return Object(O.a)(Object(O.a)({},e),{},{position:a,turns:n,issuedMotionCommand:!0,mode:Yr})},[L.machineState.motion.arcCCW]:function(e,t){var n=t.payload.P,a=ui(e,t);return Object(O.a)(Object(O.a)({},e),{},{position:a,turns:n,issuedMotionCommand:!0,mode:Wr})},[L.machineState.motion.setPosition]:function(e,t){var n=ui(e,t);return Object(O.a)(Object(O.a)({},e),{},{position:n,issuedMotionCommand:!0})},[L.machineState.motion.g5x.enableG54]:Object(ci.a)((function(e,t){e.g5x.index=1})),[L.machineState.motion.g5x.enableG55]:Object(ci.a)((function(e,t){e.g5x.index=2})),[L.machineState.motion.g5x.enableG56]:Object(ci.a)((function(e,t){e.g5x.index=3})),[L.machineState.motion.g5x.enableG57]:Object(ci.a)((function(e,t){e.g5x.index=4})),[L.machineState.motion.g5x.enableG58]:Object(ci.a)((function(e,t){e.g5x.index=5})),[L.machineState.motion.g5x.enableG59]:Object(ci.a)((function(e,t){e.g5x.index=6})),[L.machineState.motion.g5x.enableG591]:Object(ci.a)((function(e,t){e.g5x.index=7})),[L.machineState.motion.g5x.enableG592]:Object(ci.a)((function(e,t){e.g5x.index=8})),[L.machineState.motion.g5x.enableG593]:Object(ci.a)((function(e,t){e.g5x.index=9})),[L.machineState.motion.g5x.computeDynamicWorkOffsets]:Object(ci.a)((function(e,t){var n=t.payload,a=n.P,r=n.machineState,i=e.position,o=e.g5x,s=r.machine;e.g5x.offsets[a]=Kt[s].computeDynamicWorkOffsets(o.offsets[o.index],i)})),[L.machineState.motion.g5x.setG5xWorkOffset]:Object(ci.a)((function(e,t){var n=t.payload,a=n.index,r=n.axis,i=n.value;e.g5x.offsets[a][r]=i}))},li),hi=di,pi={G4:0,G10:0,G28:0,G30:0,G53:0,G92:0,"G92.1":0,"G92.2":0,"G92.3":0,G0:1,G1:1,G2:1,G3:1,G33:1,"G38.2":1,G73:1,G76:1,G81:1,G82:1,G83:1,G84:1,G85:1,G86:1,G87:1,G88:1,G89:1,G17:2,G18:2,G19:2,"G17.1":2,"G18.1":2,"G19.1":2,G90:3,G91:3,"G90.1":4,"G91.1":4,G93:5,G94:5,G95:5,G20:6,G21:6,G40:7,G41:7,G42:7,"G41.1":7,"G42.1":7,G43:8,"G43.1":8,G49:8,G98:10,G99:10,G54:12,G55:12,G56:12,G57:12,G58:12,G59:12,"G59.1":12,"G59.2":12,"G59.3":12,G61:13,"G61.1":13,G664:13,G96:14,G97:14,G7:15,G8:15,M0:4,M1:4,M2:4,M30:4,M60:4,M3:7,M4:7,M5:7,M7:8,M8:8,M9:8,M48:9,M49:9},mi={G10:!0,G92:!0,G0:!0,G1:!0,G2:!0,G3:!0,G33:!0,"G38.2":!0,G73:!0,G76:!0,G81:!0,G82:!0,G83:!0,G84:!0,G85:!0,G86:!0,G87:!0,G88:!0,G89:!0,"G43.1":!0},fi=n(383),gi=function e(t){var n=this;Object(V.a)(this,e),this.getState=function(){return n.store.getState()},this.interpret=function(e){n.messages=[];var t,a={},r=[],i=Object(fi.parseLine)(e);for(var o in i.words.forEach((function(e,t){var n=Object($t.a)(e,2),i=n[0]+n[1],o=function(e){return pi[e]}(i);void 0!==o&&(a[o]?a[o].push(i):a[o]=[i]),function(e){return mi[e]}(i)&&r.push(i)})),r.length>1&&n.messages.push({message:"Can't run multiple commands with positional arguments on the same line. Codes "+(t=r).slice(0,t.length-1).join(", ")+" and "+t[t.length-1]+" use positional arguments.",codes:t,type:"MULTIPLE_COMMANDS_WITH_POSITIONAL_ARGS",severity:pt}),a)a[o].length>1&&n.messages.push(jt(a[o],o));var s={},c=[],l=[],u=[],d=!1,h=!1,p=!1;i.words.forEach((function(e,t){var a=function(e){return lt[e]}(e[0]);a&&(c.push([a,e[1]]),"T"===e[0]&&(Math.floor(e[1])!==e[1]&&n.messages.push(Mt(e[1])),e[1]<0&&n.messages.push({message:"Tool number must be greater than or equal to 0. ",type:"TOOL_NUMBER_LESS_THAN_ZERO",severity:pt}),0===e[1]&&n.messages.push({message:"Tool number 0 is not recommended as its length cannot be changed. Tool 0's\ntool length offset is 0, which represents a tool that extends all the way \nto the center of rotation when in the home position and has a diameter of 0.",type:"TOOL_NUMBER_EQUAL_TO_ZERO",severity:mt})));var r=e[0]+e[1];"G43"===r&&(d=!0),"M254"===r&&(h=!0),function(e){return dt[e]}(r)&&(p=!0);var i=function(e){return it[e]}(r),o=function(e){return ct[e]}(r);o&&(n.messages.push(function(e){return{message:"Set units to "+At[e]+".",code:e,severity:ft,type:yt}}(r)),l.push(o()));var m=function(e){return st[e]}(r);m&&u.push(m(s));var f=function(e){return ut[e]}(r);f&&(s[r]=!0),i&&n.messages.push(Et(r)),o||i||f||m||a||(s[e[0]]=e[1],"G"!==e[0]&&"M"!==e[0]||n.messages.push(function(e){return{message:"Unrecognized G or M code: "+e,severity:pt,type:"UNRECOGNIZED",code:e}}(r)))}));var m=a[1];0===r.length&&["X","Y","Z","A","B","C","I","J","K"].reduce((function(e,t){return e||void 0!==s[t]}),!1)&&(u.push(ht(s)),m=!0),m||u.push(T.machineState.motion.nonMotionCommand()),d&&"undefined"!==typeof s.H&&s.H!==Math.floor(s.H)&&(s.H=Math.floor(s.H),n.messages.push(Mt(s.H))),l.forEach((function(e){n.store.dispatch(e)}));var f=n.store.getState(),g=n.store.getState().units;if(s.units=g,s.machineState=f,c.forEach((function(e){var t=Object($t.a)(e,2),a=t[0],r=t[1];n.store.dispatch(a(r))})),u.forEach((function(e){n.store.dispatch(e)})),m){var v=n.store.getState(),b=Kt[v.machine];n.messages=n.messages.concat(b.getLimitErrors(v.joints,b.limits))}var O,x,S=n.store.getState();if(h&&n.messages.push(function(e,t,n,a){var r=Pt[e],i=Pt[t];return{message:"Computed dynamic work offsets for "+r+" (WCS "+e+") from "+i+" (WCS "+t+").\n"+a.map((function(e){return e+": "+n[e].toFixed(4)})).join("\n"),code:r,wcs:e,currentWcs:t,currentCode:i,computedOffsets:n,severity:ft,type:St}}(s.P,S.motion.g5x.index,S.motion.g5x.offsets[s.P],Kt[S.machine].jointLabels)),p&&n.messages.push(function(e,t,n){var a=Pt[e];return{message:"Set work coordinate system to "+a+" (WCS "+e+").\n"+n.map((function(e){return e+": "+t[e].toFixed(4)})).join("\n"),code:a,wcs:e,workOffsets:t,labelOrder:n,severity:ft,type:xt}}(S.motion.g5x.index,S.motion.g5x.offsets[S.motion.g5x.index],Kt[S.machine].jointLabels)),d){var y=S.tool,M=y.loaded,j=M;"undefined"!==typeof s.H&&s.H>0&&(j=s.H),n.messages.push(function(e,t,n,a){return{message:"Set tool length offset to "+t.toFixed(4)+" which is what is stored under tool "+e+".",toolNumber:e,toolLengthOffset:t,toolDiameter:n,toolHolder:a,severity:ft,type:Ot}}(j,y.toolLengthOffset.Z,2*y.toolLengthOffset.R,y.toolLengthOffset.holder)),M!==j&&n.messages.push({message:"Tool specified by G43, T"+(O=j)+", differs from last tool loaded with M6, T"+(x=M)+". The simulator uses the last tool loaded with M6 to determine which tool to show, so your tool path may vary from what you would expect.",g43ToolNum:O,m6ToolNum:x,severity:mt,type:"TOOL_LENGTH_OFFSET_COMMAND_DIFFERS_FROM_LOADED_TOOL"})}return S};var a=t.machineState;this.store=Object(Fr.createStore)(bi,a)},vi=Object(Fr.combineReducers)({machine:si,feedRateMode:qr,feedRate:$r,units:ei,tool:ni,planeSelect:Qr,kinematicsMode:ai,cutterCompensation:ri,spindleSpeed:ii,spindleControl:oi,motion:hi,joints:function(e,t){return e||[0,1.5,0,0,0]}}),bi=Object(Zr.a)(vi,(function(e,t){var n,a=(n=e,Object(Br.a)({[Object(Vr.a)(L.machineState.motion.rapid,L.machineState.motion.linear,L.machineState.motion.arcCW,L.machineState.motion.arcCCW,L.machineState.motion.setPosition)]:function(e,t){var a,r=t.payload,i=r.X,o=r.Y,s=r.Z,c=r.A,l=r.B,u=r.C,d=r.units,h=r.G53,p=Kt[n.machine];if(h){var m=p.kinematics.forwardKinematics(n,h),f={X:i,Y:o,Z:s,A:c,B:l,C:u};for(var g in f)void 0===f[g]?delete f[g]:d!==Ue||"X"!==g&&"Y"!==g&&"Z"!==g||(f[g]=f[g]/25.4);if(n.motion.distanceMode===Pe)m=Object(O.a)(Object(O.a)({},m),f);else for(var v in m=Object(O.a)({},m),f)m[v]=m[v]+f[v];a=p.kinematics.inverseKinematics(Object(O.a)(Object(O.a)({},n),{},{motion:Object(O.a)(Object(O.a)({},n.motion),{},{position:m})}),h)}else a=p.kinematics.inverseKinematics(n);return a}},[0,0,0,0,0]))(e.joints,t);return Object(O.a)(Object(O.a)({},e),{},{joints:a})}),(function(e,t){var n,a=(n=e,Object(Br.a)({[Object(Vr.a)(L.machineState.tool.setToolLengthOffset,L.machineState.tool.clearToolLengthOffset,L.machineState.motion.rapid,L.machineState.motion.linear,L.machineState.motion.arcCW,L.machineState.motion.arcCCW,L.machineState.motion.setPosition,L.machineState.kinematicsMode.setFiveAxis,L.machineState.kinematicsMode.setTrivial)]:function(e,t){var a=Kt[n.machine],r=Object(O.a)(Object(O.a)({},e.position),a.kinematics.forwardKinematics(n));return Object(O.a)(Object(O.a)({},e),{},{position:r})}},li))(e.motion,t);return Object(O.a)(Object(O.a)({},e),{},{motion:a})})),Oi=Object(ci.a)((function(e,t,n){var a=e.times,r=0;if(t>=a[a.length-1])t=a[r=a.length-1];else if(0===t)r=0;else{for(var i=0,o=a.length-1,s=Math.floor(a.length/2);i+1<o;)a[s]>=t?o=s:i=s,s=Math.floor(.5*(i+o));r=t<a[i]?i:o}e.currentLine=r,e.currentTime=t,e.paused=n})),xi=Object(Br.a)({[R.interpreter.startLoading]:Object(ci.a)((function(e,t){e.lines=[],e.loadingProgress=0,e.loading=!0,e.currentLine=0,e.totalTime=0,e.states=[],e.times=[],e.messages=[]})),[R.interpreter.endLoading]:Object(ci.a)((function(e,t){e.loading=!1})),[R.interpreter.setFileName]:Object(ci.a)((function(e,t){e.fileName=t.payload})),[R.interpreter.setLoadingProgress]:Object(ci.a)((function(e,t){e.loadingProgress=t.payload})),[R.interpreter.setLines]:Object(ci.a)((function(e,t){e.lines=Object.freeze(t.payload.lines),e.currentLine=0,e.currentTime=0,e.paused=!0,e.running=!0,e.linesPerIndex=Math.max(Math.min(Math.ceil(t.payload.lines.length/5e4),300),1),e.states=[],e.times=[],e.messages=[]})),[R.interpreter.startProcessing]:Object(ci.a)((function(e,t){e.processingProgress=0,e.processing=!0,e.states=[],e.times=[],e.messages=[]})),[R.interpreter.endProcessing]:Object(ci.a)((function(e,t){e.processing=!1})),[R.interpreter.setProcessingProgress]:Object(ci.a)((function(e,t){e.processingProgress=t.payload})),[R.interpreter.setInitialState]:Object(ci.a)((function(e,t){e.initialState=t.payload})),[R.interpreter.appendIndices]:function(e,t){return Object(ci.a)(e,(function(n){for(var a=[],r=0;r<e.states.length;r++)a.push(e.states[r]);for(var i=0;i<t.payload.length;i++)a.push(t.payload[i]);n.states=Object.freeze(a)}))},[R.interpreter.appendMessages]:function(e,t){return Object(ci.a)(e,(function(n){for(var a=[],r=0;r<e.messages.length;r++)a.push(e.messages[r]);for(var i=0;i<t.payload.length;i++)a.push(t.payload[i]);n.messages=Object.freeze(a)}))},[R.interpreter.appendTimes]:function(e,t){return Object(ci.a)(e,(function(n){for(var a=e.times,r=e.lines.length,i=[],o=0;o<a.length;o++)i.push(a[o]);for(var s=0;s<t.payload.length;s++)i.push(t.payload[s]);n.times=Object.freeze(i),n.totalTime=i[i.length-1]*r/i.length}))},[R.interpreter.pause]:Object(ci.a)((function(e,t){e.paused=!0})),[R.interpreter.stop]:Object(ci.a)((function(e,t){e.running=!1})),[R.interpreter.unpause]:Object(ci.a)((function(e,t){e.currentTime>=e.totalTime-$e&&(e.currentTime=0,e.currentLine=0),e.paused=!1})),[R.interpreter.run]:Object(ci.a)((function(e,t){e.running=!0})),[R.interpreter.setTimeMultiplier]:Object(ci.a)((function(e,t){e.timeMultiplier=t.payload})),[R.interpreter.previousLine]:Object(ci.a)((function(e,t){var n=Math.max(e.currentLine-1,0),a=e.times[n];return Object(O.a)(Object(O.a)({},e),{},{currentLine:n,currentTime:a,paused:!0})})),[R.interpreter.nextLine]:Object(ci.a)((function(e,t){var n=Math.min(e.currentLine+1,e.lines.length-1),a=e.times[n];e.currentLine=n,e.currentTime=a})),[R.interpreter.setCurrentLine]:Object(ci.a)((function(e,t){var n=Math.max(0,Math.min(e.lines.length-1,t.payload)),a=e.times[n];e.currentLine=n,e.currentTime=a})),[R.interpreter.incrementTime]:function(e,t){var n=e.currentTime,a=e.timeMultiplier,r=t.payload*a;return Oi(e,n+r,e.currentTime>=e.totalTime)},[R.interpreter.setCurrentLineWithTime]:function(e,t){return Oi(e,t.payload,e.paused)},[R.interpreter.setCurrentLineWithPercentage]:function(e,t){return Oi(e,e.totalTime*t.payload/100,!0)}},{fileName:"sim.ngc",lines:[],messages:[],states:[],initialState:{},times:[],linesPerIndex:1,loading:!1,loadingProgress:0,processing:!1,processingProgress:0,currentLine:0,totalTime:0,currentTime:0,paused:!0,running:!1,timeMultiplier:1}),Si=Object(Br.a)({[F.viewer3d.parentCamera]:Object(ci.a)((function(e,t){e.cameraParent=t.payload})),[F.viewer3d.setPerspective]:Object(ci.a)((function(e,t){e.cameraMode=Ee})),[F.viewer3d.setOrthographic]:Object(ci.a)((function(e,t){e.cameraMode=Te})),[F.viewer3d.loadModel]:Object(ci.a)((function(e,t){e.modelLoaded=!0})),[F.viewer3d.showModel]:Object(ci.a)((function(e,t){e.showModel=!0})),[F.viewer3d.hideModel]:Object(ci.a)((function(e,t){e.showModel=!1})),[F.viewer3d.setDimensions]:Object(ci.a)((function(e,t){e.width=t.payload.width,e.height=t.payload.height})),[F.viewer3d.cameraSetRadius]:Object(ci.a)((function(e,t){e.radius=t.payload})),[F.viewer3d.cameraSetOrthographicZoom]:Object(ci.a)((function(e,t){e.orthographicZoom=t.payload})),[F.viewer3d.cameraSetPhi]:Object(ci.a)((function(e,t){e.phi=t.payload})),[F.viewer3d.cameraSetTheta]:Object(ci.a)((function(e,t){e.theta=t.payload})),[F.viewer3d.cameraZoom]:Object(ci.a)((function(e,t){var n=e.radius,a=e.orthographicZoom,r=t.payload;r<0?(n*=.95,a/=.95):r>0&&(n/=.95,a*=.95),a=Math.min(50,Math.max(.1,a)),n=Math.min(50,Math.max(.1,n)),e.orthographicZoom=a,e.radius=n})),[F.viewer3d.cameraStartRotating]:Object(ci.a)((function(e,t){e.rotating=!0})),[F.viewer3d.cameraStopRotating]:Object(ci.a)((function(e,t){e.rotating=!1})),[F.viewer3d.cameraSetDirection]:Object(ci.a)((function(e,t){var n=t.payload,a=n.x,r=n.y,i=n.z,o=Math.sqrt(a*a+r*r+i*i),s=0,c=0;0!==o&&(c=Math.atan2(a,i),s=Math.acos(Math.max(Math.min(r/o,1),-1))),(s<=$e||s>=Math.PI-$e)&&(c=e.theta),e.phi=s,e.theta=c})),[F.viewer3d.cameraRotate]:Object(ci.a)((function(e,t){if(e.rotating){var n=e.width,a=e.height,r=t.payload,i=r.dx,o=r.dy,s=e.theta-2*Math.PI*i/n*2,c=Math.max($e,Math.min(Math.PI-$e,e.phi-2*Math.PI*o/a*2));e.theta=s,e.phi=c}}))},{width:500,height:500,showModel:!1,modelLoaded:!1,cameraParent:Me,cameraMode:Ee,rotating:!1,radius:10,orthographicZoom:1,phi:Math.PI/4,theta:-Math.PI/2}),yi=Object(Br.a)({[_.ui.gcodePane.setWidth]:Object(ci.a)((function(e,t){e.width=t.payload})),[_.ui.gcodePane.setSelected]:Object(ci.a)((function(e,t){e.selectedLine=t.payload})),[_.ui.gcodePane.setLineOffset]:Object(ci.a)((function(e,t){e.lineOffset=t.payload})),[_.ui.gcodePane.setShowLines]:Object(ci.a)((function(e,t){e.showLines=t.payload})),[_.ui.gcodePane.scroll]:Object(ci.a)((function(e,t){e.lineOffset+=t.payload})),[_.ui.gcodePane.setTab]:Object(ci.a)((function(e,t){e.currentTab=t.payload})),[_.ui.gcodePane.togglePane]:Object(ci.a)((function(e,t){e.visible=!e.visible}))},{width:320,visible:!0,lineOffset:0,showLines:50,selectedLine:0,currentTab:0}),Mi=Object(Br.a)({[_.ui.controlsOverlay.setVisible]:Object(ci.a)((function(e,t){e.visible=t.payload}))},{visible:!1}),ji=Object(Br.a)({[B.iframe.initialize]:Object(ci.a)((function(e,t){e.visible=!1}))},{visible:!0}),wi=Object(Fr.combineReducers)({gcodePane:yi,controlsOverlay:Mi,titleBar:ji}),Ei=function(e){var t=e.posx,n=e.posy,a=e.posz,r=e.dirx,i=e.diry,o=e.dirz,s=e.toolOffsetZ,c=e.offsetZ,l=e.xform,u=new ie.Vector3(t,n,a),d=new ie.Vector4(r,i,o,0),h=new ie.Matrix4;h.makeRotationFromEuler(new ie.Euler(l.rx/180*Math.PI,l.ry/180*Math.PI,l.rz/180*Math.PI)),h.multiplyScalar(l.s),h.setPosition(new ie.Vector3(l.tx,l.ty,l.tz)),u.applyMatrix4(h),d.applyMatrix4(h);var p=Math.asin(d.y),m=Math.atan2(-d.x,d.z),f=It({A:180*p/Math.PI,B:180*m/Math.PI,X:u.x/25.4,Y:u.y/25.4,Z:u.z/25.4},s);return Object(ci.a)(f,(function(e){e[2]+=c}))},Ti={machine:Oe,width:500,height:500,toolOffsetZ:-3,editingOffsetZ:1.5,previewingOffsetZ:0,gettingStatus:!1,step:Xe,modelFinalized:!1,finalizeModelClicked:!1,modelLoaded:!1,modelUploaded:!1,finishedProcessingModel:!1,scannersDetected:0,xform:{s:1,rx:0,ry:0,rz:0,tx:0,ty:0,tz:0},loading:{},points:[],closePath:!1,pointsNeedSaving:!1,xformNeedsSaving:!1,activePoint:-1,highlightedPoint:-1,showGhostSphere:!1,ghostSpherePosition:{x:0,y:0,z:0},ghostSphereOpacity:.5,scannerKey:"",rfid:"",label:"",joints:[0,(5+qe)/25.4,0,0,0],machineRotating:!1,rotateStartX:0,rotateStartY:0,modelHighlighted:!1,dragModelStartX:0,dragModelStartZ:0,paused:!0,time:0,timeMultiplier:1,times:[0]},Pi=Object(ci.a)(Ti,(function(e){delete e.scannersDetected,delete e.width,delete e.height})),Ai=Object(Br.a)({[B.alignerState.setTimes]:Object(ci.a)((function(e,t){e.times=t.payload})),[B.alignerState.setMachine]:Object(ci.a)((function(e,t){e.machine=t.payload})),[B.alignerState.play]:Object(ci.a)((function(e,t){var n=.5*e.points.length;e.time>=n&&(e.time=0),e.paused=!1})),[B.alignerState.pause]:Object(ci.a)((function(e,t){e.paused=!0})),[B.alignerState.incrementTime]:function(e,t){var n,a,r,i,o,s,c,l,u,d,h,p,m,f,g,v=e.time,b=e.timeMultiplier,O=e.times,x=e.points,S=t.payload*b,y=O.times.length-1,M=Math.min(v+S,y),j=e.closePath,w=0;if(v>=y)w=1;else if(0===v)w=0;else{n=0,a=O.length-1;for(var E=Math.floor(O.length/2);n+1<a;)O[E]>v?a=E:n=E,E=Math.floor(.5*(n+a));w=(n+(v-O[n])/(O[a]-O[n]))/(O.length-1)}j?(o=(r=x.length)*w-(i=Math.floor(r*w)),i>=x.length&&(i=0)):o=(r=x.length-1)*w-(i=Math.floor(r*w)),j?(g=((f=((m=i)+1)%r)+1)%r,p=(m+r-1)%r):((m=i)>=r&&(m=r),(f=m+1)>=r&&(f=r),(g=f+1)>=r&&(g=r),(p=m-1)<0&&(p=0));var T=new ie.Vector3(x[p][0],x[p][1],x[p][2]),P=new ie.Vector3(x[m][0],x[m][1],x[m][2]),A=new ie.Vector3(x[f][0],x[f][1],x[f][2]),k=new ie.Vector3(x[g][0],x[g][1],x[g][2]),C=new ie.Vector3,G=new ie.Vector3,L=new ie.Vector3,R=new ie.Vector3;C.copy(P),G.copy(A);L.copy(A),L.sub(T),L.multiplyScalar(.5),R.copy(k),R.sub(P),R.multiplyScalar(.5);var I=(1+2*o)*(1-o)*(1-o)*C.x+o*(1-o)*(1-o)*L.x+o*o*(3-2*o)*G.x+o*o*(o-1)*R.x,N=(1+2*o)*(1-o)*(1-o)*C.y+o*(1-o)*(1-o)*L.y+o*o*(3-2*o)*G.y+o*o*(o-1)*R.y,_=(1+2*o)*(1-o)*(1-o)*C.z+o*(1-o)*(1-o)*L.z+o*o*(3-2*o)*G.z+o*o*(o-1)*R.z,D=new ie.Vector3(x[m][3],x[m][4],x[m][5]),F=new ie.Vector3(x[f][3],x[f][4],x[f][5]),z=D.angleTo(F),Z=new ie.Vector3;Z.crossVectors(D,F),Z.normalize();var B=new ie.Vector3;B.copy(D),B.applyAxisAngle(Z,z*o),s=I,c=N,l=_,u=B.x,d=B.y,h=B.z;var V=e.xform,U=e.step,H=e.toolOffsetZ,X=U===We?e.editingOffsetZ:e.previewingOffsetZ,Y=Ei({posx:s,posy:c,posz:l,dirx:u,diry:d,dirz:h,toolOffsetZ:H,offsetZ:X,xform:V});return Object(ci.a)(e,(function(e){M>=y&&(e.paused=!0),e.time=M,e.joints=Y,e.activePoint=i}))},[B.alignerState.setTimeWithPercentage]:function(e,t){var n,a,r,i,o,s,c,l,u,d,h,p,m,f,g,v,b=e.points,O=e.times,x=O[O.length-1],S=Math.min(t.payload/100*x,x),y=e.closePath;if(S>=x)n=1;else if(0===S)n=0;else{a=0,r=O.length-1;for(var M=Math.floor(O.length/2);a+1<r;)O[M]>S?r=M:a=M,M=Math.floor(.5*(a+r));n=(a+(S-O[a])/(O[r]-O[a]))/(O.length-1)}y?(s=(i=b.length)*n-(o=Math.floor(i*n)),o>=b.length&&(o=0)):s=(i=b.length-1)*n-(o=Math.floor(i*n)),y?(v=((g=((f=o)+1)%i)+1)%i,m=(f+i-1)%i):((f=o)>=i&&(f=i),(g=f+1)>=i&&(g=i),(v=g+1)>=i&&(v=i),(m=f-1)<0&&(m=0));var j=new ie.Vector3(b[m][0],b[m][1],b[m][2]),w=new ie.Vector3(b[f][0],b[f][1],b[f][2]),E=new ie.Vector3(b[g][0],b[g][1],b[g][2]),T=new ie.Vector3(b[v][0],b[v][1],b[v][2]),P=new ie.Vector3,A=new ie.Vector3,k=new ie.Vector3,C=new ie.Vector3;P.copy(w),A.copy(E);k.copy(E),k.sub(j),k.multiplyScalar(.5),C.copy(T),C.sub(w),C.multiplyScalar(.5);var G=(1+2*s)*(1-s)*(1-s)*P.x+s*(1-s)*(1-s)*k.x+s*s*(3-2*s)*A.x+s*s*(s-1)*C.x,L=(1+2*s)*(1-s)*(1-s)*P.y+s*(1-s)*(1-s)*k.y+s*s*(3-2*s)*A.y+s*s*(s-1)*C.y,R=(1+2*s)*(1-s)*(1-s)*P.z+s*(1-s)*(1-s)*k.z+s*s*(3-2*s)*A.z+s*s*(s-1)*C.z,I=new ie.Vector3(b[f][3],b[f][4],b[f][5]),N=new ie.Vector3(b[g][3],b[g][4],b[g][5]),_=I.angleTo(N),D=new ie.Vector3;D.crossVectors(I,N),D.normalize();var F=new ie.Vector3;F.copy(I),F.applyAxisAngle(D,_*s),c=G,l=L,u=R,d=F.x,h=F.y,p=F.z;var z=e.xform,Z=e.step,B=e.toolOffsetZ,V=Z===We?e.editingOffsetZ:e.previewingOffsetZ,U=Ei({posx:c,posy:l,posz:u,dirx:d,diry:h,dirz:p,toolOffsetZ:B,offsetZ:V,xform:z});return Object(ci.a)(e,(function(e){S>=x&&(e.paused=!0),e.time=S,e.joints=U,e.activePoint=o}))},[B.alignerState.setTimeMultiplier]:Object(ci.a)((function(e,t){e.timeMultiplier=t.payload})),[B.alignerState.closePath]:Object(ci.a)((function(e,t){e.closePath=!0,e.pointsNeedSaving=!0})),[B.alignerState.setDragModelStartPoint]:Object(ci.a)((function(e,t){var n=t.payload,a=n.x,r=n.z;e.dragModelStartX=a,e.dragModelStartZ=r})),[B.alignerState.setModelPosition]:Object(ci.a)((function(e,t){var n=t.payload,a=n.x,r=n.y,i=n.z,o=e.xform;o.tx=a,o.ty=r,o.tz=i,e.xformNeedsSaving=!0})),[B.alignerState.setModelOrientation]:Object(ci.a)((function(e,t){var n=t.payload,a=n.x,r=n.y,i=n.z;e.xform.rx=a,e.xform.ry=r,e.xform.rz=i,e.xformNeedsSaving=!0})),[B.alignerState.dragModel]:Object(ci.a)((function(e,t){var n=t.payload,a=n.x,r=n.z,i=a-e.dragModelStartX,o=r-e.dragModelStartZ,s=e.xform;s.tx+=i,s.tz+=o,e.dragModelStartX=a,e.dragModelStartZ=r,e.xformNeedsSaving=!0})),[B.alignerState.setHighlightModel]:Object(ci.a)((function(e,t){e.highlightModel=!!t.payload})),[B.alignerState.resetState]:function(e,t){return Object(O.a)(Object(O.a)({},e),Pi)},[B.alignerState.setDimensions]:Object(ci.a)((function(e,t){var n=t.payload,a=n.width,r=n.height;e.width=a,e.height=r})),[B.alignerState.startRotatingMachine]:Object(ci.a)((function(e,t){var n=t.payload,a=n.x,r=n.y;e.rotateStartX=a,e.rotateStartY=r,e.machineRotating=!0})),[B.alignerState.stopRotatingMachine]:Object(ci.a)((function(e,t){e.machineRotating=!1})),[B.alignerState.rotateMachine]:function(e,t){var n=t.payload,a=n.x,r=n.y;if(e.machineRotating){var i,o=e.rotateStartX,s=e.rotateStartY,c=e.width,l=e.height,u=a/c*2-1-(o/c*2-1),d=r/l*2-1-(s/l*2-1),h=e.joints[3]+300*d,p=e.joints[4]+300*u,m=e.points,f=m,g=!1;if(m.length>0){var v=e.activePoint,b=m[v],O=e.step,x=e.toolOffsetZ,S=O===We?e.editingOffsetZ:e.previewingOffsetZ,y=e.xform,M=new ie.Vector3(b[0],b[1],b[2]),j=new ie.Matrix4;j.makeRotationFromEuler(new ie.Euler(y.rx/180*Math.PI,y.ry/180*Math.PI,y.rz/180*Math.PI)),j.multiplyScalar(y.s),j.setPosition(new ie.Vector3(y.tx,y.ty,y.tz)),M.applyMatrix4(j),i=It({A:h,B:p,X:M.x/25.4,Y:M.y/25.4,Z:M.z/25.4},x),i=Object(ci.a)(i,(function(e){e[2]+=S}));var w=new ie.Matrix4;w.getInverse(j);var E=new ie.Vector4(-Math.sin(p*Math.PI/180),Math.sin(h*Math.PI/180),Math.cos(p*Math.PI/180),0);E.applyMatrix4(w),E.normalize();var T=Object(ci.a)(b,(function(e){e[3]=E.x,e[4]=E.y,e[5]=E.z}));f=Object(ci.a)(m,(function(e){e[v]=T})),g=!0}else i=Object(ci.a)(e.joints,(function(e){e[3]=h,e[4]=p}));return Object(ci.a)(e,(function(e){e.joints=i,e.rotateStartX=a,e.rotateStartY=r,e.points=f,e.pointsNeedSaving=g}))}return e},[B.alignerState.pointsSaved]:Object(ci.a)((function(e,t){e.pointsNeedSaving=!1})),[B.alignerState.transformSaved]:Object(ci.a)((function(e,t){e.xformNeedsSaving=!1})),[B.alignerState.nextPoint]:Object(ci.a)((function(e,t){var n=e.points,a=e.times,r=(e.activePoint+1)%n.length,i=n[r],o=e.step,s=e.toolOffsetZ,c=o===We?e.editingOffsetZ:e.previewingOffsetZ,l=e.xform,u=Ei({posx:i[0],posy:i[1],posz:i[2],dirx:i[3],diry:i[4],dirz:i[5],toolOffsetZ:s,offsetZ:c,xform:l});e.activePoint=r,e.joints=u,e.time=a[r]})),[B.alignerState.prevPoint]:Object(ci.a)((function(e,t){var n=e.times,a=e.points,r=e.closePath,i=e.time,o=e.activePoint;n[o]===i&&(o=r?(o-1+a.length)%a.length:Math.max(o-1,0));var s=n[o],c=a[o],l=e.step,u=e.toolOffsetZ,d=l===We?e.editingOffsetZ:e.previewingOffsetZ,h=e.xform,p=Ei({posx:c[0],posy:c[1],posz:c[2],dirx:c[3],diry:c[4],dirz:c[5],toolOffsetZ:u,offsetZ:d,xform:h});e.activePoint=o,e.joints=p,e.time=s})),[B.alignerState.setActivePoint]:Object(ci.a)((function(e,t){var n=t.payload,a=e.points,r=.5*a.length,i=a[n],o=e.closePath,s=e.step,c=e.toolOffsetZ,l=s===We?e.editingOffsetZ:e.previewingOffsetZ,u=e.xform,d=Ei({posx:i[0],posy:i[1],posz:i[2],dirx:i[3],diry:i[4],dirz:i[5],toolOffsetZ:c,offsetZ:l,xform:u});e.activePoint=n,e.joints=d,e.time=r*n/(o?a.length:a.length-1)})),[B.alignerState.setHighlightedPoint]:Object(ci.a)((function(e,t){e.highlightedPoint=t.payload})),[B.alignerState.updatePointPosition]:Object(ci.a)((function(e,t){var n=t.payload,a=n.posx,r=n.posy,i=n.posz,o=e.points,s=e.activePoint,c=o[s];c[0]=a,c[1]=r,c[2]=i,o[s]=c,e.pointsNeedSaving=!0})),[B.alignerState.deletePoint]:function(e,t){var n=e.activePoint,a=e.points;if(a.length>0){var r=e.closePath,i=Object(ci.a)(e,(function(e){e.points.splice(n,1),e.activePoint=1===a.length?-1:0===n?r?Math.max(a.length-2,0):0:n-1})),o=i.activePoint;if(o>-1){var s=i.points[o],c=e.step,l=e.toolOffsetZ,u=c===We?e.editingOffsetZ:e.previewingOffsetZ,d=e.xform,h=Ei({posx:s[0],posy:s[1],posz:s[2],dirx:s[3],diry:s[4],dirz:s[5],toolOffsetZ:l,xform:d,offsetZ:u});return Object(ci.a)(i,(function(e){e.joints=h}))}return Object(ci.a)(i,(function(e){e.joints=Ti.joints}))}return e},[B.alignerState.addPoint]:Object(ci.a)((function(e,t){var n=t.payload,a=n.posx,r=n.posy,i=n.posz,o=n.dirx,s=n.diry,c=n.dirz,l=e.step,u=e.toolOffsetZ,d=l===We?e.editingOffsetZ:e.previewingOffsetZ,h=e.xform,p=Ei(Object(O.a)(Object(O.a)({},t.payload),{},{toolOffsetZ:u,offsetZ:d,xform:h})),m=e.activePoint;e.points.splice(m,0,[a,r,i,o,s,c]),e.activePoint=m+1,e.joints=p,e.pointsNeedSaving=!0})),[B.alignerState.showGhostSphere]:Object(ci.a)((function(e,t){e.showGhostSphere=!0})),[B.alignerState.hideGhostSphere]:Object(ci.a)((function(e,t){e.showGhostSphere=!1})),[B.alignerState.setGhostSpherePosition]:Object(ci.a)((function(e,t){e.ghostSpherePosition.x=t.payload.x,e.ghostSpherePosition.y=t.payload.y,e.ghostSpherePosition.z=t.payload.z})),[B.alignerState.setGhostSphereOpacity]:Object(ci.a)((function(e,t){e.ghostSphereOpacity=t.payload})),[B.alignerState.setJoints]:Object(ci.a)((function(e,t){e.joints=t.payload})),[B.alignerState.setRfid]:Object(ci.a)((function(e,t){e.rfid=t.payload})),[B.alignerState.setStep]:Object(ci.a)((function(e,t){var n=t.payload;if(e.step=n,e.points.length>0){var a=e.activePoint,r=e.points[a],i=e.toolOffsetZ,o=n===We?e.editingOffsetZ:e.previewingOffsetZ,s=e.xform,c=Ei({posx:r[0],posy:r[1],posz:r[2],dirx:r[3],diry:r[4],dirz:r[5],xform:s,toolOffsetZ:i,offsetZ:o});e.joints=c}else e.joints=Ti.joints})),[B.alignerState.modelLoaded]:Object(ci.a)((function(e,t){e.modelLoaded=!0})),[B.alignerState.modelUploaded]:Object(ci.a)((function(e,t){e.modelUploaded=!0})),[B.alignerState.finalizeModel]:Object(ci.a)((function(e,t){e.modelFinalized=!0})),[B.alignerState.finalizeModelClick]:Object(ci.a)((function(e,t){e.finalizeModelClicked=!0})),[B.alignerState.clearFinalizeModelClick]:Object(ci.a)((function(e,t){e.finalizeModelClicked=!1})),[B.alignerState.finishedProcessing]:Object(ci.a)((function(e,t){e.finishedProcessingModel=!0})),[B.alignerState.importedTransformAndPoints]:Object(ci.a)((function(e,t){e.points=t.payload.points.points,t.payload.points.points.length>0&&(e.activePoint=0),e.closePath=t.payload.points.closed,e.xform=t.payload.xform})),[B.alignerState.importTransformAndPoints]:Object(ci.a)((function(e,t){e.loading.waitingForScannerToScanRFIDToImport={label:"Please scan RFID to import...",variant:"indeterminate"}})),[B.alignerState.cancelImportTransformAndPoints]:Object(ci.a)((function(e,t){delete e.loading.waitingForScannerToScanRFIDToImport})),[B.alignerState.loading]:Object(ci.a)((function(e,t){var n=t.payload,a=n.id,r=n.label,i=n.variant,o=n.progress;e.loading[a]={label:r,variant:i,progress:o}})),[B.alignerState.loadingProgress]:Object(ci.a)((function(e,t){var n=t.payload,a=n.id,r=n.progress;e.loading[a].progress=r})),[B.alignerState.stopLoading]:Object(ci.a)((function(e,t){var n=t.payload.id;delete e.loading[n]})),[B.alignerState.rotateCW]:Object(ci.a)((function(e,t){var n=e.xform,a=new ie.Matrix4;a.makeRotationFromEuler(new ie.Euler(n.rx/180*Math.PI,n.ry/180*Math.PI,n.rz/180*Math.PI)),a.setPosition(new ie.Vector3(n.tx,n.ty,n.tz));var r=new ie.Matrix4;r.makeRotationY(-Math.PI/2),a.premultiply(r);var i=new ie.Euler;i.setFromRotationMatrix(a);var o=new ie.Vector3;o.setFromMatrixPosition(a),e.xform={s:n.get("s"),rx:180*i.x/Math.PI,ry:180*i.y/Math.PI,rz:180*i.z/Math.PI,tx:o.x,ty:o.y,tz:o.z},e.xformNeedsSaving=!0})),[B.alignerState.rotateCCW]:Object(ci.a)((function(e,t){var n=e.xform,a=new ie.Matrix4;a.makeRotationFromEuler(new ie.Euler(n.rx/180*Math.PI,n.ry/180*Math.PI,n.rz/180*Math.PI)),a.setPosition(new ie.Vector3(n.tx,n.ty,n.tz));var r=new ie.Matrix4;r.makeRotationY(Math.PI/2),a.premultiply(r);var i=new ie.Euler;i.setFromRotationMatrix(a);var o=new ie.Vector3;o.setFromMatrixPosition(a),e.xform={s:n.get("s"),rx:180*i.x/Math.PI,ry:180*i.y/Math.PI,rz:180*i.z/Math.PI,tx:o.x,ty:o.y,tz:o.z},e.xformNeedsSaving=!0})),[B.alignerState.alignerStatusResponse]:Object(ci.a)((function(e,t){var n=t.payload,a=n.model,r=n.xform,i=n.finalized,o=n.processing,s=n.processedModel,c=n.points;if(e.modelFinalized=i,e.finalizeModelClicked=i,e.modelLoaded=!1,e.modelUploaded=!!a,e.processingModel=o,e.finishedProcessingModel=s,e.xform=r||Ti.xform,c){var l=c.points;if(e.closePath=c.closed,e.points=l,l.length>0){e.activePoint=l.length-1;var u=l[0],d=e.toolOffsetZ,h=e.previewingOffsetZ,p=e.xform,m=Ei({posx:u[0],posy:u[1],posz:u[2],dirx:u[3],diry:u[4],dirz:u[5],toolOffsetZ:d,xform:p,offsetZ:h});e.joints=m}else e.activePoint=-1;e.highlightedPoint=-1}else e.points=[],e.activePoint=-1,e.highlightedPoint=-1})),[B.rfid.connectedScanner]:Object(ci.a)((function(e,t){e.scannersDetected+=1})),[B.rfid.disconnectedScanner]:Object(ci.a)((function(e,t){e.scannersDetected-=1})),[B.rfid.receivedRfidScanMessage]:Object(ci.a)((function(e,t){var n=t.payload,a=n.rfid,r=n.label,i=n.scannerKey;e.loading.waitingForScannerToScanRFIDToImport||(e.rfid=a,e.label=r,e.scannerKey=i)}))},Ti),ki=Object(Fr.combineReducers)({machineState:bi,alignerState:Ai,interpreter:xi,ui:wi,viewer3d:Si}),Ci=Object(Zr.a)(ki,(function(e,t){var n,a=(n=e,Object(Br.a)({[Object(Vr.a)(B.interpreter.previousLine,B.interpreter.nextLine,B.interpreter.incrementTime,B.interpreter.setCurrentLineWithPercentage,B.interpreter.setCurrentLineWithTime,B.interpreter.setCurrentLine)]:function(e,t){var a=n.interpreter.currentLine,r=a-1,i=n.interpreter.linesPerIndex,o=n.interpreter.states.length;if(o>0){var s=Math.min(Math.floor(r/i),o-1),c=s<0?n.interpreter.initialState:n.interpreter.states[s],l=Math.max(s*i,-1),u=c,d=n.interpreter.lines,h=null,p=null,m=Math.min(Math.floor(a/i),o-1);if(r>l||m*i!==a){h=new gi({machineState:u});for(var f=l;f<=r;)u=h.interpret(d[f]),f++}p=m*i===a?n.interpreter.states[m]:h.interpret(d[a]);var g=Kt[p.machine],v=u.joints,b=g.kinematics.forwardKinematics(Object(O.a)(Object(O.a)({},p),{},{joints:v})),x=p.motion.position,S=n.interpreter.times,y=r<0?0:S[r],M=S[a],j=n.interpreter.currentTime,w=1;M-y>0&&(w=(j-y)/(M-y));var E=p.motion.mode,T=p.motion.turns,P=p.planeSelect,A=Jr(E,b,x,w,P,T),k=Object(O.a)(Object(O.a)({},p),{},{motion:Object(O.a)(Object(O.a)({},p.motion),{},{position:A})}),C=g.kinematics.inverseKinematics(k);return Object(O.a)(Object(O.a)({},k),{},{joints:C})}return e}},n.machineState))(e.machineState,t);return Object(ci.a)(e,(function(e){e.machineState=a}))})),Gi=n(16),Li=n.n(Gi),Ri=n(4),Ii=Li.a.mark(Fi),Ni=Li.a.mark(zi),_i=ee();function Di(e,t,n,a,r,i){return new Promise((function(o){return setTimeout((function(){for(var s,c=[],l=[],u=[],d=[],h=e.getState(),p=0;p<a&&n<t.length;p++){s=e.interpret(t[n]),e.messages.length>0&&e.messages.forEach(function(e){return function(t){d.push(kt(t,e))}}(n));var m=Kt[s.machine],f=h.joints,g=s.joints,v=h.motion.position,b=s.motion.position;if(s.motion.issuedMotionCommand){var x=s.motion.turns,S=s.motion.mode,y=s.planeSelect,M=s.units,j=0,w=s.feedRate,E=s.feedRateMode;if(E!==Ge&&M===Ue&&(w/=25.4),S!==Hr)if(E===Ge)w<$e?d.push(kt(Tt(),n)):j=1/w*60;else if(E===Le)if(S===Xr)if(w<$e)d.push(kt(Tt(),n));else{for(var T=0,P=0;P<3;P++){var A=Math.abs(g[P]-f[P]);T=Math.max(T,A),j=Math.max(j,A/w*60)}if(T>-$e&&T<$e)for(var k=3;k<f.length;k++){var C=Math.abs(g[k]-f[k]);j=Math.max(j,C/w*60)}}else if(S===Yr||S===Wr){if(w<$e)d.push(kt(Tt(),n));else j=Kr(v,b,y,S,x)/w*60}else j=0;else j=3;for(var G=m.limits.velocities,L=m.limits.accelerations,R=0,I=3;I<f.length;I++){var N=Math.abs(g[I]-f[I]);R=Math.max(N,R)}for(var _=0;_<f.length;_++){var D=G[_]*G[_]/(.5*L[_]),F=Math.abs(g[_]-f[_]),z=0;z=R<$e&&R>-$e?F/G[_]:F>=D?Math.max(F-D)/G[_]+2*G[_]/(.5*L[_]):2*Math.sqrt(F/L[_]),j=Math.max(j,z)}i+=j;var Z=f,B=g,V=s,U=m.kinematics.forwardKinematics(Object(O.a)(Object(O.a)({},V),{},{joints:Z})),H=V.motion.position,X=V.kinematicsMode,Y=Math.abs(B[3]-Z[3]),W=Math.abs(B[4]-Z[4]);if((Y>$e||W>$e)&&X!==Ie||S!==Hr&&S!==Xr){var K=.1,J=40,q=!0,$=[];if(S!==Hr&&S!==Xr||!(W>-$e||Y>-$e)){if(S===Yr||S===Wr){var Q=Kr(v,b,y,S,x);J=Math.max(Math.ceil(Q/K),5)}}else{var ee=Math.max(B[0],Z[0]),te=Math.max(B[1],Z[1]),ne=Math.max(6-B[2],6-Z[2]),ae=Math.sqrt(ee*ee+ne*ne),re=Math.sqrt(te*te+ne*ne),ie=Y*Math.PI/180*re,ce=W*Math.PI/180*ae;J=Math.max(Math.ceil(ce/K),Math.ceil(ie/K),5)}for(;q;){for(var le=0,ue=void 0,de=0;de<J;de++){var he=de/(J-1),pe=i-j+he*j,me=void 0;me=0===he?.01/j:-.01/j;var fe=s.motion.turns,ge=Jr(S,U,H,he,y,fe),ve=Jr(S,U,H,he+me,y,fe),be=m.kinematics.inverseKinematics(Object(O.a)(Object(O.a)({},V),{},{motion:Object(O.a)(Object(O.a)({},V.motion),{},{position:ge})})),Oe=m.kinematics.inverseKinematics(Object(O.a)(Object(O.a)({},V),{},{motion:Object(O.a)(Object(O.a)({},V.motion),{},{position:ve})})),xe=m.workPieceSpace(be,ka(V).Z),Se=m.toolOrientation(be),ye=m.workPieceSpace(Oe,ka(V).Z),Me=[xe.X,xe.Y,xe.Z],je=[ye.X,ye.Y,ye.Z],we=[Se.X,Se.Y,Se.Z],Ee=void 0;if(me>0){var Te=je[0]-Me[0],Pe=je[1]-Me[1],Ae=je[2]-Me[2];Ee=Math.sqrt(Te*Te+Pe*Pe+Ae*Ae)/.01}else{var ke=Me[0]-je[0],Ce=Me[1]-je[1],Re=Me[2]-je[2];Ee=Math.sqrt(ke*ke+Ce*Ce+Re*Re)/.01}if(S===Hr?$.push({position:Me,color:oe,speed:Ee,time:pe,line:n,normal:we}):$.push({position:Me,color:se,speed:Ee,time:pe,line:n,normal:we}),de>0){var Ne=Me[0]-ue[0],_e=Me[1]-ue[1],De=Me[2]-ue[2],Fe=Math.sqrt(Ne*Ne+_e*_e+De*De);le=Math.max(le,Fe)}ue=Me}le>.15000000000000002?(J=Math.ceil(J*le/K),$=[]):q=!1}for(var ze=0;ze<$.length;ze++)u.push($[ze])}else{var Ze=ka(h).Z,Be=ka(s).Z,Ve=m.workPieceSpace(f,Ze),He=m.workPieceSpace(g,Be),Xe=m.toolOrientation(f),Ye=m.toolOrientation(g),We=Xe.X,Ke=Xe.Y,Je=Xe.Z,qe=Ye.X,Qe=Ye.Y,et=Ye.Z,tt=Ve.X,nt=Ve.Y,at=Ve.Z,rt=He.X,it=He.Y,ot=He.Z,st=rt-tt,ct=it-nt,lt=ot-at,ut=Math.sqrt(st*st+ct*ct+lt*lt)/j;switch(S){case Hr:u.push({position:[tt,nt,at],color:oe,speed:ut,time:i-j,line:n,normal:[We,Ke,Je]}),u.push({position:[rt,it,ot],color:oe,speed:ut,time:i,line:n,normal:[qe,Qe,et]});break;case Xr:u.push({position:[tt,nt,at],color:se,speed:ut,time:i-j,line:n,normal:[We,Ke,Je]}),u.push({position:[rt,it,ot],color:se,speed:ut,time:i,line:n,normal:[qe,Qe,et]});break;default:console.error("shouldn't get here")}}}l.push(i),n%r===0&&c.push(s),h=s,n++}o({line:n,states:c,times:l,points:u,messages:d})}))}))}function Fi(e){var t,n,a,r,i,o,s,c,l,u,d,h,p,m,f,g,v,b,O,x,S,y,M;return Li.a.wrap((function(j){for(;;)switch(j.prev=j.next){case 0:return t=K()(),j.next=3,Object(Ri.e)(B.interpreter.startProcessing());case 3:return j.next=5,Object(Ri.f)(ja);case 5:return n=j.sent,j.next=8,Object(Ri.f)(wa);case 8:return a=j.sent,j.next=11,Object(Ri.f)(Ea);case 11:return r=j.sent,i=new gi({machineState:n}),j.next=15,Object(Ri.e)(B.interpreter.setInitialState(n));case 15:o=le.getInstance(),s=10,c=12,l=240,u=10,d=200,o.clear(),h=0,p=0,m=[],f=[],g=[];case 27:if(!(p<a.length)){j.next=54;break}return x=K()(),j.next=31,Object(Ri.b)(Di,i,a,p,s,r,h);case 31:if(S=j.sent,y=K()(),s=document.hasFocus()?Math.max(Math.floor(s*c/(y-x)),u):Math.max(Math.floor(s*l/(y-x)),u),(v=f).push.apply(v,Object(Y.a)(S.times)),(b=g).push.apply(b,Object(Y.a)(S.states)),(O=m).push.apply(O,Object(Y.a)(S.messages)),h=S.times[S.times.length-1],p=S.line,o.addPoints(S.points),!(f.length>=d||p>=a.length)){j.next=52;break}return j.next=43,Object(Ri.e)(B.interpreter.appendIndices(g));case 43:return j.next=45,Object(Ri.e)(B.interpreter.appendTimes(f));case 45:return j.next=47,Object(Ri.e)(B.interpreter.appendMessages(m));case 47:return j.next=49,Object(Ri.e)(B.interpreter.setProcessingProgress(p/a.length*100));case 49:g=[],f=[],m=[];case 52:j.next=27;break;case 54:return j.next=56,Object(Ri.e)(B.interpreter.endProcessing());case 56:if(e.preview){j.next=67;break}return _i.timing("interpreter","parsed gcode",Math.round(K()()-t)),j.next=60,Object(Ri.f)(Ta);case 60:return M=j.sent,_i.event("interpreter","calculated approximate run time","calculated approximate run time",Math.round(1e3*M)),j.next=64,Object(Ri.f)(pa);case 64:j.sent.forEach((function(e){_i.event("interpreter","unimplemented code "+e.code)})),_i.send();case 67:case"end":return j.stop()}}),Ii)}function zi(){return Li.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Ri.i)(B.interpreter.setLines,Fi);case 2:case"end":return e.stop()}}),Ni)}var Zi=Li.a.mark(Ui),Bi=Li.a.mark(Hi);function Vi(){return new Promise((function(e){return window.requestAnimationFrame((function(){e()}))}))}function Ui(e){var t,n,a,r,i,o;return Li.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=.016;case 1:return e.next=4,Object(Ri.f)(Ma);case 4:if(n=e.sent,a=n.running,r=n.paused,!a||r){e.next=17;break}return i=performance.now(),e.next=11,Object(Ri.b)(Vi);case 11:return e.next=13,Object(Ri.e)(B.interpreter.incrementTime(t));case 13:o=performance.now(),t=(o-i)/1e3,e.next=18;break;case 17:return e.abrupt("break",20);case 18:e.next=1;break;case 20:case"end":return e.stop()}}),Zi)}function Hi(){return Li.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Ri.i)([B.interpreter.setLines,B.interpreter.pause,B.interpreter.unpause,B.interpreter.run,B.interpreter.nextLine,B.interpreter.previousLine,B.interpreter.setCurrentLineWithPercentage],Ui);case 2:case"end":return e.stop()}}),Bi)}var Xi=Li.a.mark(Yi);function Yi(){return Li.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Ri.e)(B.interpreter.setLines("%\nG20\nG90 G94 G40 G17\nG53 G0 Z0\nG0 A0 B0\nG0 X0\nM5\nM0\nT4 M6\nG43\nS8500 M3\nF20\n\nG0 A90\nG0 X1 Y1\nG1 Z0\nG1 X-1\nG1 y-1\nG1 X1\nG1 Y1\n\nG49\nG53 G0 Z0\n\nM5\nM30\n%\n".split("\n")));case 2:case"end":return e.stop()}}),Xi)}var Wi=Li.a.mark(Ji),Ki=Li.a.mark(qi);function Ji(e){var t;return Li.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log(e),t=Dr.getInstance(),console.log(t.windows),t.sendMessage(e),void(n.next=6);case 6:case"end":return n.stop()}}),Wi)}function qi(){return Li.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Ri.h)(B.iframe.toRockhopper,Ji);case 2:case"end":return e.stop()}}),Ki)}var $i=Li.a.mark(no),Qi=Li.a.mark(ao),eo=function(e){return e.open().then((function(){return e.selectConfiguration(1)})).then((function(){return e.claimInterface(2)})).then((function(){return e.selectAlternateInterface(2,0)})).then((function(){return e.controlTransferOut({requestType:"class",recipient:"interface",request:34,value:1,index:2})})).then((function(){return{device:e}})).catch((function(e){return{error:e}}))},to=function(e){return e.transferIn(5,64).then((function(e){return{data:(new TextDecoder).decode(e.data)}})).catch((function(e){return{error:e}}))};function no(e,t){var n,a,r,i,o,s,c,l,u,d;return Li.a.wrap((function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,Object(Ri.b)(eo,e);case 2:if(n=h.sent,!(a=n.device)){h.next=49;break}return h.next=7,Object(Ri.e)(B.rfid.connectedScanner());case 7:r="",i=!0;case 9:if(!i){h.next=47;break}return h.next=12,Object(Ri.b)(to,a);case 12:if(o=h.sent,s=o.data,c=o.error,!s){h.next=40;break}if(!((l=(r+=s).indexOf("\r\n"))>-1)){h.next=38;break}if(u=r.slice(0,l),h.prev=20,!(d=JSON.parse(u)).error){h.next=27;break}return h.next=25,Object(Ri.e)(B.rfid.receivedErrorMessage(d));case 25:h.next=30;break;case 27:if(!d.rfid){h.next=30;break}return h.next=30,Object(Ri.e)(B.rfid.receivedRfidScanMessage(d));case 30:h.next=37;break;case 32:return h.prev=32,h.t0=h.catch(20),console.error(h.t0),h.next=37,Object(Ri.e)(B.rfid.receivedIncompleteMessage());case 37:r=r.slice(l+2);case 38:h.next=45;break;case 40:if(!c){h.next=45;break}return h.next=43,Object(Ri.e)(B.rfid.disconnectedScanner());case 43:t(a),i=!1;case 45:h.next=9;break;case 47:h.next=50;break;case 49:t(a);case 50:case"end":return h.stop()}}),$i,null,[[20,32]])}function ao(){var e;return Li.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=!1;try{e=window.self!==window.top}catch(n){e=!0}if(e||!navigator.usb){t.next=6;break}return t.delegateYield(Li.a.mark((function e(){var t,n,a;return Li.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=function(e){var n=t.indexOf(e);n>-1&&t.splice(n,1)},a=Li.a.mark((function e(){var a,r;return Li.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.usb.getDevices();case 2:return a=e.sent,r=[],a.forEach((function(e){t.includes(e)||(t.push(e),r.push(e))})),e.next=7,Object(Ri.a)(r.map((function(e){return Object(Ri.d)(no,e,n)})));case 7:return e.next=9,Object(Ri.c)(1e3);case 9:case"end":return e.stop()}}),e)}));case 3:return e.delegateYield(a(),"t0",5);case 5:e.next=3;break;case 7:case"end":return e.stop()}}),e)}))(),"t0",4);case 4:t.next=9;break;case 6:return console.log("blah2"),t.next=9,Object(Ri.c)(1e3);case 9:case"end":return t.stop()}}),Qi)}var ro=n(384),io=n.n(ro),oo=n(151),so=n.n(oo),co=n(241),lo=function(e,t,n){var a=new te.Vector3(e[0],e[1],e[2]),r=new te.Vector3(t[0],t[1],t[2]);a.multiplyScalar(.03937007874015748);var i=Math.asin(r.y),o=Math.atan2(-r.x,r.z),s=Math.cos(i),c=Math.sin(i),l=Math.cos(o),u=Math.sin(o),d=new te.Vector3;return n?(d.x=a.x*l+a.z*u,d.y=a.x*u*c+a.y*s-a.z*l*c,d.z=-a.x*u*s+a.y*c+a.z*l*s):(d.x=a.x,d.y=a.y,d.z=a.z),{X:d.x,Y:d.y,Z:d.z,A:180*i/Math.PI,B:180*o/Math.PI}};function uo(e){for(var t=e.map((function(e){return[[e[0],e[1],e[2]],[e[3],e[4],e[5]]]})),n=[],a=new te.Vector3,r=new te.Vector3,i=new te.Vector3,o=new te.Vector3,s=new te.Vector3,c=new te.Vector3,l=new te.Vector3(1,0,0),u=0;u<t.length;u++){i.set(t[u][0][0],t[u][0][1],t[u][0][2]),s.set(t[u][1][0],t[u][1][1],t[u][1][2]),u===t.length-1?(o.set(t[0][0][0],t[0][0][1],t[0][0][2]),c.set(t[0][1][0],t[0][1][1],t[0][1][2])):(o.set(t[u+1][0][0],t[u+1][0][1],t[u+1][0][2]),c.set(t[u+1][1][0],t[u+1][1][1],t[u+1][1][2])),s.normalize(),c.normalize();var d=s.angleTo(c);d>1e-5&&(l.crossVectors(s,c),l.normalize());var h=lo([i.x,i.y,i.z],[s.x,s.y,s.z],!0),p=lo([o.x,o.y,o.z],[c.x,c.y,c.z],!0),m=Math.abs(h.A-p.A),f=Math.abs(h.B-p.B);m>180&&(m=360-m),f>180&&(f=360-f);for(var g=Math.PI/180,v=Math.max(Math.ceil(d/g),2,Math.ceil(m),Math.ceil(f)),b=0;b<v;b++){var O=b/(v-1);a.lerpVectors(i,o,O),r.copy(s),r.applyAxisAngle(l,d*O),n.push([[a.x,a.y,a.z],[r.x,r.y,r.z]])}}var x=0,S=lo(n[0][0],n[0][1],!0),y=[],M=S;return n.forEach((function(e){var t=Object($t.a)(e,2),n=t[0],a=t[1],r=lo(n,a,!0);r.Z<x&&(x=r.Z);var i=r.X-M.X,o=r.Y-M.Y,s=r.Z-M.Z,c=r.A-M.A,l=r.B-M.B;l>180?l-=360:l<-180&&(l+=360);var u={};Math.abs(i)>1e-5&&(u.X=i),Math.abs(o)>1e-5&&(u.Y=o),Math.abs(s)>1e-5&&(u.Z=s),Math.abs(c)>1e-5&&(u.A=c),Math.abs(l)>1e-5&&(u.B=l),Object.keys(u).length>0&&y.push(u),M=r})),y}var ho=function(e){var t=e.rfid,n=e.size,a=e.apiKey;return fetch("/"+t+"/getUploadModelPost?size="+n,{headers:{"x-api-key":a}}).then((function(e){return e.json()})).then((function(e){return{data:e}})).catch((function(e){return{error:e}}))},po=function(e){var t=e.rfid,n=e.apiKey;return fetch("/"+t+"/submitProcessModelJob",{method:"POST",headers:{"x-api-key":n}}).then((function(e){return e.json()})).then((function(e){return{data:e}})).catch((function(e){return{error:e}}))},mo=function(e){var t=e.rfid,n=e.apiKey;return fetch("/"+t+"/getDownloadProcessedModelUrl",{method:"GET",headers:{"x-api-key":n}}).then((function(e){return e.json()})).then((function(e){return{data:e}})).catch((function(e){return{error:e}}))},fo=function(e){var t=e.rfid,n=e.apiKey;return fetch("/"+t+"/getGCode",{method:"GET",headers:{"x-api-key":n}}).then((function(e){return e.json()})).then((function(e){return{data:e}})).catch((function(e){return{error:e}}))},go=function(e){var t=e.rfid,n=e.apiKey;return fetch("/"+t+"/processedModelExists",{method:"GET",headers:{"x-api-key":n}}).then((function(e){return e.json()})).then((function(e){return{data:e}})).catch((function(e){return{error:e}}))},vo=function(e){var t=e.rfid,n=e.apiKey;return fetch("/"+t+"/getStatus",{method:"GET",headers:{"x-api-key":n}}).then((function(e){return e.json()})).then((function(e){return{data:e}})).catch((function(e){return{error:e}}))},bo=function(e){var t=e.rfid,n=e.apiKey;return fetch("/"+t+"/finalize",{method:"PUT",headers:{"x-api-key":n}}).then((function(e){return e.json()})).then((function(e){return{data:e}})).catch((function(e){return{error:e}}))},Oo=function(e){var t=e.rfid,n=e.apiKey,a=e.points;return fetch("/"+t+"/savePoints",{method:"PUT",headers:{"x-api-key":n},body:JSON.stringify(a)}).then((function(e){return e.json()})).then((function(e){return{data:e}})).catch((function(e){return{error:e}}))},xo=function(e){var t=e.rfid,n=e.apiKey,a=e.rfidImport;return fetch("/"+t+"/importTransformAndPoints?rfidImport="+a,{method:"PUT",headers:{"x-api-key":n}}).then((function(e){return e.json()})).then((function(e){return{data:e}})).catch((function(e){return{error:e}}))},So=function(e){var t=e.rfid,n=e.apiKey,a=e.xform;return fetch("/"+t+"/saveTransform",{method:"PUT",headers:{"x-api-key":n},body:JSON.stringify(a)}).then((function(e){return e.json()})).then((function(e){return{data:e}})).catch((function(e){return{error:e}}))},yo=function(e){var t=e.rfid,n=e.apiKey,a=e.label;return fetch("/"+t+"/createLabel?label="+a,{method:"PUT",headers:{"x-api-key":n}}).then((function(e){return e.json()})).then((function(e){return{data:e}})).catch((function(e){return{error:e}}))},Mo=function(e){var t=e.rfid;return fetch("/"+t+"/getDemoKey",{headers:{}}).then((function(e){return e.json()})).then((function(e){return{data:e}})).catch((function(e){return{error:e}}))},jo=Li.a.mark(Fo),wo=Li.a.mark(zo),Eo=Li.a.mark(Zo),To=Li.a.mark(Bo),Po=Li.a.mark(Vo),Ao=Li.a.mark(Uo),ko=Li.a.mark(Ho),Co=Li.a.mark(Xo),Go=Li.a.mark(Yo),Lo=Li.a.mark(Wo),Ro=Li.a.mark(Ko),Io=Li.a.mark(qo),No=Li.a.mark($o),_o=Li.a.mark(Qo),Do=Li.a.mark(es);function Fo(e,t,n){var a,r,i,o;return Li.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:for(r in a=new FormData,e.fields)a.append(r,e.fields[r]);a.append("file",new File([new Blob([t])],"filename")),i=Object(zr.c)((function(t){var r;return so()({url:e.url,method:"POST",data:a,cancelToken:new so.a.CancelToken((function(e){return r=e})),onUploadProgress:function(e){t(n(e.loaded/e.total*100))}}).then((function(){t(zr.a)})).catch((function(e){console.error("upload error",e),t(zr.a)})),function(){return r()}})),s.prev=4;case 5:return s.next=8,Object(Ri.g)(i);case 8:return o=s.sent,s.next=11,Object(Ri.e)(o);case 11:s.next=5;break;case 13:return s.prev=13,s.finish(13);case 15:case"end":return s.stop()}}),jo,null,[[4,,13,15]])}function zo(e,t){var n,a,r,i=arguments;return Li.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:n=i.length>2&&void 0!==i[2]?i[2]:"arraybuffer",a=Object(zr.c)((function(a){var r;return so()({url:e,method:"GET",responseType:n,cancelToken:new so.a.CancelToken((function(e){return r=e})),onDownloadProgress:function(e){a(t(e.loaded/e.total*100))}}).then((function(e){a(e.data),a(zr.a)})).catch((function(e){console.error("download error",e),a(zr.a)})),function(){return r()}})),o.prev=2;case 3:return o.next=6,Object(Ri.g)(a);case 6:if((r=o.sent).type!==t(0).type){o.next=12;break}return o.next=10,Object(Ri.e)(r);case 10:o.next=13;break;case 12:return o.abrupt("return",r);case 13:o.next=3;break;case 15:return o.prev=15,o.finish(15);case 17:case"end":return o.stop()}}),wo,null,[[2,,15,17]])}function Zo(e){var t,n,a,r;return Li.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:t=e.rfid,n=e.apiKey;case 1:return i.next=4,Object(Ri.b)(go,{rfid:t,apiKey:n});case 4:if(a=i.sent,r=a.data,a.error,!r.exists){i.next=12;break}return i.abrupt("break",16);case 12:return i.next=14,Object(Ri.c)(5e3);case 14:i.next=1;break;case 16:return i.next=18,Object(Ri.e)(B.alignerState.finishedProcessing());case 18:case"end":return i.stop()}}),Eo)}function Bo(e){var t,n,a,r,i,o,s,c;return Li.a.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return t=new Uint8Array(e.payload),l.next=3,Object(Ri.f)(ya);case 3:if(n=l.sent,a=n.rfid,r=t.byteLength,i=n.scannerKey,!a||!i){l.next=29;break}return l.next=10,Object(Ri.e)(B.alignerState.loading("preparingToUploadModel","Preparing to upload model...","indeterminate"));case 10:return l.next=12,Object(Ri.b)(ho,{rfid:a,size:r,apiKey:i});case 12:return o=l.sent,s=o.data,c=o.error,l.next=17,Object(Ri.e)(B.alignerState.stopLoading("preparingToUploadModel"));case 17:if(!c){l.next=21;break}console.error(c),l.next=29;break;case 21:return l.next=23,Object(Ri.e)(B.alignerState.loading("uploadModel","Uploading model...","determinate",0));case 23:return l.next=25,Object(Ri.b)(Fo,s.post,t,(function(e){return B.alignerState.loadingProgress("uploadModel",e)}));case 25:return l.next=27,Object(Ri.e)(B.alignerState.stopLoading("uploadModel"));case 27:return l.next=29,Object(Ri.e)(B.alignerState.modelUploaded());case 29:case"end":return l.stop()}}),To)}function Vo(e){var t,n,a,r,i,o;return Li.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Ri.f)(ya);case 2:if(t=e.sent,n=t.rfid,a=t.scannerKey,!n||!a){e.next=45;break}case 6:return e.next=9,Object(Ri.f)(ya);case 9:if(!e.sent.modelUploaded){e.next=12;break}return e.abrupt("break",16);case 12:return e.next=14,Object(Ri.c)(1e3);case 14:e.next=6;break;case 16:return e.next=18,Object(Ri.e)(B.alignerState.loading("finalizing","Finalizing model...","indeterminate"));case 18:return e.next=20,Object(Ri.b)(bo,{rfid:n,apiKey:a});case 20:return r=e.sent,e.next=23,Object(Ri.e)(B.alignerState.stopLoading("finalizing"));case 23:if(!r.error){e.next=30;break}return console.error("Error finalizing model",r.error),e.next=27,Object(Ri.e)(B.alignerState.clearFinalizeModelClick());case 27:return e.abrupt("return");case 30:return e.next=32,Object(Ri.e)(B.alignerState.finalizeModel());case 32:return e.next=34,Object(Ri.e)(B.alignerState.loading("processingModel","Processing model...","indeterminate"));case 34:return e.next=36,Object(Ri.b)(po,{rfid:n,apiKey:a});case 36:if(i=e.sent,o=i.data,i.error,!o.success){e.next=43;break}return e.next=43,Object(Ri.b)(Zo,{rfid:n,apiKey:a});case 43:return e.next=45,Object(Ri.e)(B.alignerState.stopLoading("processingModel"));case 45:case"end":return e.stop()}}),Po)}function Uo(e){var t,n,a,r,i,o,s,c,l,u,d,h,p,m;return Li.a.wrap((function(f){for(;;)switch(f.prev=f.next){case 0:return t=e.payload,n=t.rfid,a=t.label,r=t.scannerKey,i=r,f.next=4,Object(Ri.f)(ya);case 4:if(!(o=f.sent).loading.waitingForScannerToScanRFIDToImport){f.next=22;break}return f.next=8,Object(Ri.e)(B.alignerState.stopLoading("waitingForScannerToScanRFIDToImport"));case 8:return f.next=10,Object(Ri.e)(B.alignerState.loading("importingTransformAndPoints","Importing model position and points...","indeterminate"));case 10:return f.next=12,xo({rfid:o.rfid,apiKey:i,rfidImport:n});case 12:return s=f.sent,c=s.data,(l=s.error)&&console.error(l),f.next=18,Object(Ri.e)(B.alignerState.stopLoading("importingTransformAndPoints"));case 18:return f.next=20,Object(Ri.e)(B.alignerState.importedTransformAndPoints(c));case 20:f.next=99;break;case 22:return f.next=24,Object(Ri.e)(B.alignerState.loading("getStatus","Verifying scanned ID...","indeterminate"));case 24:return f.next=26,vo({rfid:n,apiKey:i});case 26:return u=f.sent,d=u.data,h=u.error,f.next=31,Object(Ri.e)(B.alignerState.stopLoading("getStatus"));case 31:if(!h){f.next=36;break}return console.error("Error fetching status",h),f.next=35,Object(Ri.e)(B.alignerState.resetState());case 35:return f.abrupt("return");case 36:return f.next=38,Object(Ri.e)(B.alignerState.alignerStatusResponse(d));case 38:if(!d.aligner){f.next=97;break}if(d.label){f.next=44;break}return f.next=42,Object(Ri.b)(yo,{rfid:n,apiKey:i,label:a});case 42:f.sent.success;case 44:if(p=tt.getInstance(),!d.model){f.next=91;break}if(!(d.points&&d.points.length>0)){f.next=53;break}return f.next=49,Object(Ri.e)(B.viewer3d.parentCamera(je));case 49:return f.next=51,Object(Ri.e)(B.alignerState.setStep(Ke));case 51:f.next=55;break;case 53:return f.next=55,Object(Ri.e)(B.alignerState.setStep(We));case 55:return f.next=57,Object(Ri.e)(B.alignerState.loading("downloadModel","Downloading model...","determinate",0));case 57:return f.next=59,Object(Ri.b)(zo,d.model,(function(e){return B.alignerState.loadingProgress("downloadModel",e)}),"arraybuffer");case 59:return m=f.sent,p.loadSTLModel(m),f.next=63,Object(Ri.e)(B.viewer3d.loadModel());case 63:return f.next=65,Object(Ri.e)(B.viewer3d.showModel());case 65:return f.next=67,Object(Ri.e)(B.alignerState.modelLoaded());case 67:return f.next=69,Object(Ri.e)(B.alignerState.stopLoading("downloadModel"));case 69:if(!d.finalized){f.next=87;break}if(!d.processing){f.next=79;break}return f.next=73,Object(Ri.e)(B.alignerState.loading("processingModel","Processing model...","indeterminate"));case 73:return f.next=75,Object(Ri.b)(Zo,{rfid:n,apiKey:i});case 75:return f.next=77,Object(Ri.e)(B.alignerState.stopLoading("processingModel"));case 77:f.next=85;break;case 79:if(d.processedModel||console.error("model and transform are finalized, but don't have a processed model or a processing job"),!d.points||!d.points.closed){f.next=85;break}return f.next=83,Object(Ri.e)(B.viewer3d.parentCamera(je));case 83:return f.next=85,Object(Ri.e)(B.alignerState.setStep(Ke));case 85:f.next=89;break;case 87:return f.next=89,Object(Ri.e)(B.alignerState.setStep(Ye));case 89:f.next=95;break;case 91:return f.next=93,Object(Ri.e)(B.viewer3d.parentCamera(we));case 93:return f.next=95,Object(Ri.e)(B.alignerState.setStep(Xe));case 95:f.next=99;break;case 97:return f.next=99,Object(Ri.e)(B.alignerState.resetState());case 99:case"end":return f.stop()}}),Ao)}function Ho(e){var t,n,a,r,i,o,s;return Li.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Ri.f)(ya);case 2:return t=e.sent,n=t.rfid,a=t.label,r=t.scannerKey,e.next=8,Object(Ri.e)(B.alignerState.loading("preparingToDownloadProcessedModel","Preparing to download processed model...","indeterminate"));case 8:return e.next=10,Object(Ri.b)(mo,{rfid:n,apiKey:r});case 10:return i=e.sent,o=i.data,i.error,e.next=16,Object(Ri.e)(B.alignerState.stopLoading("preparingToDownloadProcessedModel"));case 16:return e.next=18,Object(Ri.e)(B.alignerState.loading("downloadProcessedModel","Downloading processed model...","determinate",0));case 18:return e.next=20,Object(Ri.b)(zo,o.url,(function(e){return B.alignerState.loadingProgress("downloadProcessedModel",e)}),"arraybuffer");case 20:return s=e.sent,e.next=23,Object(Ri.e)(B.alignerState.stopLoading("downloadProcessedModel"));case 23:return e.next=25,Object(Ri.b)(co.saveAs,new Blob([new Uint8Array(s)]),a+".stl");case 25:case"end":return e.stop()}}),ko)}function Xo(e){var t,n,a,r,i,o,s;return Li.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Ri.f)(ya);case 2:return t=e.sent,n=t.rfid,a=t.label,r=t.scannerKey,e.next=8,Object(Ri.e)(B.alignerState.loading("downloadGCode","Downloading G code...","indeterminate"));case 8:return e.next=10,Object(Ri.b)(fo,{rfid:n,apiKey:r});case 10:return i=e.sent,o=i.data,s=i.error,e.next=15,Object(Ri.e)(B.alignerState.stopLoading("downloadGCode"));case 15:if(!o.error&&!s){e.next=18;break}return console.error(o.error,s),e.abrupt("return");case 18:return e.next=20,Object(Ri.b)(co.saveAs,new Blob([o.gcode]),a+".ngc");case 20:case"end":return e.stop()}}),Co)}function Yo(e){var t,n,a,r,i,o,s;return Li.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Ri.f)(ya);case 2:if(t=e.sent,n=t.rfid,a=t.scannerKey,!n||!a){e.next=24;break}if(!t.pointsNeedSaving){e.next=24;break}return r={points:t.points,closed:t.closePath},e.next=11,Object(Ri.e)(B.alignerState.loading("savingPoints","Saving points...","indeterminate"));case 11:return e.next=13,Object(Ri.b)(Oo,{rfid:n,apiKey:a,points:r});case 13:return i=e.sent,o=i.data,s=i.error,e.next=18,Object(Ri.e)(B.alignerState.stopLoading("savingPoints"));case 18:if(!s&&o.success){e.next=22;break}console.error("error saving points",s),e.next=24;break;case 22:return e.next=24,Object(Ri.e)(B.alignerState.pointsSaved());case 24:case"end":return e.stop()}}),Go)}function Wo(e){var t,n,a,r,i,o,s;return Li.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Ri.f)(ya);case 2:if(t=e.sent,n=t.rfid,a=t.scannerKey,!n||!a){e.next=24;break}if(!t.xformNeedsSaving){e.next=24;break}return r={xform:t.xform},e.next=11,Object(Ri.e)(B.alignerState.loading("savingTransform","Saving model position...","indeterminate"));case 11:return e.next=13,Object(Ri.b)(So,{rfid:n,apiKey:a,xform:r});case 13:return i=e.sent,o=i.data,s=i.error,e.next=18,Object(Ri.e)(B.alignerState.stopLoading("savingTransform"));case 18:if(!s&&o.success){e.next=22;break}console.error("error saving transform",s),e.next=24;break;case 22:return e.next=24,Object(Ri.e)(B.alignerState.transformSaved());case 24:case"end":return e.stop()}}),Lo)}function Ko(e){var t,n,a,r,i,o,s,c,l;return Li.a.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:if(t=de.getInstance(),n=le.getInstance(),t.clear(),n.clear(),a=K()(),e.type!==B.alignerState.alignerStatusResponse().type){u.next=10;break}return u.next=8,Object(Ri.g)(B.alignerState.modelLoaded);case 8:return u.next=10,Object(Ri.c)(1e3);case 10:return u.next=12,Object(Ri.f)(ya);case 12:if(r=u.sent,!(i=tt.getInstance()).parts.model){u.next=22;break}if(o=new ie.Vector3,s=new ie.Vector4,c=r.points,l=c.length,300,!(l>0)){u.next=22;break}return u.delegateYield(Li.a.mark((function e(){var n,u,d,h,p,m,f,g,v,b,O,x,S,y,M,j,w,E,T,P,A,k,C,G,L,R,I,N,_,D,F,z,Z,V,U,H,X,Y,W,J,q,$,Q,ee,te,ne,ae,re,oe,se,ce,le,ue,de,he,pe,me,fe,ge,ve,be,Oe;return Li.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=-.002,u=new ie.Vector3,d=new ie.Vector3,h=new ie.Vector3,p=new ie.Vector3,m=new ie.Vector3,f=new ie.Vector3,g=new ie.Vector3,v=new ie.Vector3,b=new ie.Vector3,O=new ie.Vector3,x=new ie.Vector3,S=new ie.Vector4,y=new ie.Vector3,M=new ie.Vector3,j=new ie.Vector3,w=new ie.Vector3,E=[],T=[],(P=new ie.Matrix4).getInverse(i.parts.bAxis.object.matrixWorld),A=0;case 22:if(!(A<300)){e.next=76;break}if(k=A/299,C=void 0,G=void 0,L=void 0,R=void 0,I=void 0,r.closePath?(C=l*k-Math.floor(l*k),L=Math.floor(l*k)%l,I=((R=(L+1)%l)+1)%l,G=(L+l-1)%l):(C=(l-1)*k-Math.floor((l-1)*k),(L=Math.floor((l-1)*k))>=l&&(L=l-1),(R=L+1)>=l&&(R=l-1),(I=R+1)>=l&&(I=l-1),(G=L-1)<0&&(G=0)),u.set(c[G][0],c[G][1],c[G][2]),d.set(c[L][0],c[L][1],c[L][2]),h.set(c[R][0],c[R][1],c[R][2]),p.set(c[I][0],c[I][1],c[I][2]),g.copy(d),v.copy(h),.5,m.copy(h),m.sub(u),m.multiplyScalar(.5),f.copy(p),f.sub(d),f.multiplyScalar(.5),N=(1+2*C)*(1-C)*(1-C)*g.x+C*(1-C)*(1-C)*m.x+C*C*(3-2*C)*v.x+C*C*(C-1)*f.x,_=(1+2*C)*(1-C)*(1-C)*g.y+C*(1-C)*(1-C)*m.y+C*C*(3-2*C)*v.y+C*C*(C-1)*f.y,D=(1+2*C)*(1-C)*(1-C)*g.z+C*(1-C)*(1-C)*m.z+C*C*(3-2*C)*v.z+C*C*(C-1)*f.z,b.set(c[L][3],c[L][4],c[L][5]),O.set(c[R][3],c[R][4],c[R][5]),F=b.angleTo(O),y.crossVectors(b,O),y.normalize(),M.copy(b),M.applyAxisAngle(y,F*C),o.set(N,_,D),s.set(M.x,M.y,M.z,0),o.applyMatrix4(i.parts.model.object.matrixWorld),s.applyMatrix4(i.parts.model.object.matrixWorld),s.normalize(),j.set(o.x+5*s.x/25.4,o.y+5*s.y/25.4,o.z+5*s.z/25.4),w.set(-s.x,-s.y,-s.z),i.raycaster.set(j,w),T.length=0,T.length>0?(x.x=T[0].point.x-s.x*n,x.y=T[0].point.y-s.y*n,x.z=T[0].point.z-s.z*n):(x.x=o.x-s.x*n,x.y=o.y-s.y*n,x.z=o.z-s.z*n),S.set(s.x,s.y,s.z,0),S.applyMatrix4(P),x.applyMatrix4(P),E.push([x.x,x.y,x.z,S.x,S.y,S.z,L,C]),!(K()()-a>6)){e.next=73;break}return e.next=71,Object(Ri.c)(0);case 71:a=K()(),P.getInverse(i.parts.bAxis.object.matrixWorld);case 73:A++,e.next=22;break;case 76:for(z=r.closePath,Z=z?l:l-1,V=[0],U=Kt.V2.limits.velocities,H=Kt.V2.limits.accelerations,X=0;X<Z;X++){for(Y=void 0,void 0,J=void 0,q=void 0,W=X,z?(Y=(W-1+l)%l,q=((J=(W+1)%l)+1)%l):(Y=Math.max(W-1,0),J=W+1,q=Math.min(J+1,l-1)),u.set(c[Y][0],c[Y][1],c[Y][2]),d.set(c[W][0],c[W][1],c[W][2]),h.set(c[J][0],c[J][1],c[J][2]),p.set(c[q][0],c[q][1],c[q][2]),g.copy(d),v.copy(h),.5,m.copy(h),m.sub(u),m.multiplyScalar(.5),f.copy(p),f.sub(d),f.multiplyScalar(.5),b.set(c[W][3],c[W][4],c[W][5]),O.set(c[J][3],c[J][4],c[J][5]),$=b.angleTo(O),y.crossVectors(b,O),y.normalize(),5,Q=[],ee=0;ee<5;ee++)ne=(1+2*(te=ee/4))*(1-te)*(1-te)*g.x+te*(1-te)*(1-te)*m.x+te*te*(3-2*te)*v.x+te*te*(te-1)*f.x,ae=(1+2*te)*(1-te)*(1-te)*g.y+te*(1-te)*(1-te)*m.y+te*te*(3-2*te)*v.y+te*te*(te-1)*f.y,re=(1+2*te)*(1-te)*(1-te)*g.z+te*(1-te)*(1-te)*m.z+te*te*(3-2*te)*v.z+te*te*(te-1)*f.z,M.copy(b),M.applyAxisAngle(y,$*te),o.set(ne,ae,re),s.set(M.x,M.y,M.z,0),o.applyMatrix4(i.parts.model.object.matrixWorld),s.applyMatrix4(i.parts.model.object.matrixWorld),s.normalize(),Q.push([25.4*o.x,25.4*o.y,25.4*o.z,s.x,s.y,s.z]);oe=uo(Q),se=0,oe.forEach((function(e){var t={X:0,Y:1,Z:2,A:3,B:4},n={X:0,Y:1,Z:2},a=0;for(var r in{A:3,B:4})"undefined"!==typeof e[r]&&(a=Math.max(a,Math.abs(e[r])));var i=0;if(a<$e)for(var o in n)"undefined"!==typeof e[o]&&(i=Math.max(i,Math.abs(e[o])/U[n[o]]));else for(var s in t)"undefined"!==typeof e[s]&&(i=Math.max(i,.7*Math.sqrt(Math.abs(e[s])/H[t[s]])));se+=i})),ce=V[V.length-1],V.push(ce+se)}return e.next=84,Object(Ri.e)(B.alignerState.setTimes(V));case 84:le=new ie.Vector3,ue=new ie.Vector3,de=1/25.4,he=new ie.Vector3,(pe=new ie.Vector4).w=0,me=new ie.Vector3(1,0,0),fe=new ie.Vector3(0,1,0),ge=0;case 93:if(!(ge<E.length)){e.next=117;break}if(ve=E[ge],he.x=ve[0],he.y=ve[1],he.z=ve[2],pe.x=ve[3],pe.y=ve[4],pe.z=ve[5],le.x=pe.x,le.y=pe.y,le.z=pe.z,be=Math.asin(pe.y),Oe=Math.atan2(-pe.x,pe.z),ue.set(0,1,0),ue.applyAxisAngle(me,-be).applyAxisAngle(fe,-Oe),t.addPoints([{position:[he.x+.5*ue.x*de,he.y+.5*ue.y*de,he.z+.5*ue.z*de],color:[1,1,1],normal:[le.x,le.y,le.z],line:0,time:0},{position:[he.x-.5*ue.x*de,he.y-.5*ue.y*de,he.z-.5*ue.z*de],color:[1,1,1],normal:[le.x,le.y,le.z],line:0,time:0}]),!(K()()-a>6)){e.next=114;break}return e.next=113,Object(Ri.c)(0);case 113:a=K()();case 114:ge++,e.next=93;break;case 117:case"end":return e.stop()}}),e)}))(),"t0",22);case 22:case"end":return u.stop()}}),Ro)}function Jo(){return new Promise((function(e){return window.requestAnimationFrame((function(){e()}))}))}function qo(e){var t,n,a,r;return Li.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=.016;case 1:return e.next=4,Object(Ri.f)(ya);case 4:if(n=e.sent,!n.paused){e.next=10;break}return e.abrupt("break",19);case 10:return a=performance.now(),e.next=13,Object(Ri.b)(Jo);case 13:return e.next=15,Object(Ri.e)(B.alignerState.incrementTime(t));case 15:r=performance.now(),t=(r-a)/1e3;case 17:e.next=1;break;case 19:case"end":return e.stop()}}),Io)}function $o(){return Li.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Ri.i)([B.alignerState.play,B.alignerState.pause,B.alignerState.setActivePoint,B.alignerState.nextPoint,B.alignerState.prevPoint],qo);case 2:case"end":return e.stop()}}),No)}function Qo(){var e,t,n,a,r;return Li.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(e=io.a.parse(document.location.search),!(t=e.demoKey)){i.next=15;break}return i.next=5,Object(Ri.e)(B.alignerState.loading("verifyingDemoKey","Verifying demo key...","indeterminate"));case 5:return i.next=7,Object(Ri.b)(Mo,{rfid:t});case 7:return n=i.sent,a=n.data,r=n.error,i.next=12,Object(Ri.e)(B.alignerState.stopLoading("verifyingDemoKey"));case 12:return r&&console.error("Error fetching demo key",r),i.next=15,Object(Ri.e)(B.rfid.receivedRfidScanMessage(a));case 15:case"end":return i.stop()}}),_o)}function es(){return Li.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Ri.a)([$o(),Qo(),Object(Ri.i)(B.rfid.receivedRfidScanMessage,Uo),Object(Ri.i)(B.alignerState.uploadModel,Bo),Object(Ri.i)(B.alignerState.finalizeModelClick,Vo),Object(Ri.i)(B.alignerState.downloadProcessedModel,Ho),Object(Ri.i)(B.alignerState.downloadGCode,Xo),Object(Ri.i)(B.alignerState.savePoints,Yo),Object(Ri.i)(B.alignerState.saveTransform,Wo),Object(Ri.i)([B.alignerState.addPoint,B.alignerState.rotateMachine,B.alignerState.updatePointPosition,B.alignerState.deletePoint,B.alignerState.closePath,B.alignerState.alignerStatusResponse,B.alignerState.importedTransformAndPoints],Ko)]);case 2:case"end":return e.stop()}}),Do)}var ts=Li.a.mark(ns);function ns(){return Li.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Ri.a)([zi(),Hi(),Yi(),qi(),ao(),es()]);case 2:case"end":return e.stop()}}),ts)}var as=n(385),rs=Object(zr.b)(),is=Object(Fr.createStore)(Ci,{},Object(as.composeWithDevTools)(Object(Fr.applyMiddleware)(rs)));rs.run(ns),ee().pageview("/",document.location.href,document.title).send(),console.log("Pocket NC Simulator v0.6.0"),console.log("Commit","411e8d01c475064f7bc358065db79e0185318c8f"),window.addEventListener("message",(function(e){if(e.origin!==document.location.origin){var t=B.iframe.initialize().type,n=B.iframe.rockhopper({}).type,a=B.iframe.embedGcode().type,r=Dr.getInstance();switch(e.data.type){case t:is.dispatch(B.iframe.initialize(e.data.payload)),r.addWindow(e.source,e.origin);break;case n:if("file_content"===e.data.payload.id){var i=e.data.payload.data.split("\n").map((function(e){return e.replace("\r","")}));is.dispatch(B.interpreter.setLines(i))}else if(e.data.payload.id.startsWith("tool_table")){var o=e.data.payload.id.split(":")[1],s=e.data.payload.data[3],c=e.data.payload.data[10];is.dispatch(B.machineState.tool.table.setTool({P:o,Z:s,R:c}))}break;case a:var l=e.data.payload.split("\n").map((function(e){return e.trim()}));is.dispatch(B.interpreter.setLines(l))}}})),window.focus(),v.a.render(f.a.createElement(b.a,{store:is},f.a.createElement(Nr.a,{hashType:"noslash"},f.a.createElement(_r.a,{path:"/",exact:!0,component:Lr}))),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL(".",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat(".","/service-worker.js");Rr?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Ir(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):Ir(e)}))}}()}},[[713,1,2]]]);
//# sourceMappingURL=main.f4044c06.chunk.js.map